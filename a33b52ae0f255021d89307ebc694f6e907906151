{
  "comments": [
    {
      "key": {
        "uuid": "10fd144d_3ac30213",
        "filename": "resources/libraries/python/PapiExecutor.py",
        "patchSetId": 48
      },
      "lineNbr": 245,
      "author": {
        "id": 1496
      },
      "writtenOn": "2020-12-30T04:42:04Z",
      "side": 1,
      "message": "Can you explain this further?",
      "range": {
        "startLine": 243,
        "startChar": 0,
        "endLine": 245,
        "endChar": 59
      },
      "revId": "a33b52ae0f255021d89307ebc694f6e907906151",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "92cb1bf4_e29f3449",
        "filename": "resources/libraries/python/PapiExecutor.py",
        "patchSetId": 48
      },
      "lineNbr": 245,
      "author": {
        "id": 1263
      },
      "writtenOn": "2021-01-11T09:40:31Z",
      "side": 1,
      "message": "Yeah, I do not remember what exactly I had in mind when writing this.\nThe comment will be simplified in https://gerrit.fd.io/r/c/csit/+/26019/139/resources/libraries/python/PapiSocketExecutor.py#282",
      "parentUuid": "10fd144d_3ac30213",
      "range": {
        "startLine": 243,
        "startChar": 0,
        "endLine": 245,
        "endChar": 59
      },
      "revId": "a33b52ae0f255021d89307ebc694f6e907906151",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "15343087_5f841e96",
        "filename": "resources/libraries/python/PapiExecutor.py",
        "patchSetId": 48
      },
      "lineNbr": 262,
      "author": {
        "id": 1496
      },
      "writtenOn": "2020-12-30T04:42:04Z",
      "side": 1,
      "message": "Why do you manipulate the sys.path?",
      "range": {
        "startLine": 261,
        "startChar": 11,
        "endLine": 262,
        "endChar": 30
      },
      "revId": "a33b52ae0f255021d89307ebc694f6e907906151",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3852fad5_9f03697a",
        "filename": "resources/libraries/python/PapiExecutor.py",
        "patchSetId": 48
      },
      "lineNbr": 262,
      "author": {
        "id": 1263
      },
      "writtenOn": "2021-01-11T09:40:31Z",
      "side": 1,
      "message": "The instance creation (line 254) was failing, I think because of this [1] import. Not sure how it behaves after [2].\nBasically, the issue is in CSIT we set PYTHONPATH to top of the cloned CSIT repo, but PAPI files are in some temporary directory elsewhere. Manipulation of sys.path (lines 247 and 262) was a workaround for that, and I did not touch it once it started working.\n\n[1] https://github.com/FDio/vpp/blob/9c5dd2591c1d35b793f5fda8f6be622bb1026e51/src/vpp-api/python/vpp_papi/vpp_papi.py#L431\n[2] https://gerrit.fd.io/r/c/vpp/+/30491",
      "parentUuid": "15343087_5f841e96",
      "range": {
        "startLine": 261,
        "startChar": 11,
        "endLine": 262,
        "endChar": 30
      },
      "revId": "a33b52ae0f255021d89307ebc694f6e907906151",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e4ce83ba_107f331e",
        "filename": "resources/libraries/python/PapiExecutor.py",
        "patchSetId": 48
      },
      "lineNbr": 262,
      "author": {
        "id": 1496
      },
      "writtenOn": "2021-01-11T15:21:02Z",
      "side": 1,
      "message": "I provide a non-dynamic import code path in https://gerrit.fd.io/r/c/vpp/+/30361\n\nDo you have any plans to install papi via pip?",
      "parentUuid": "3852fad5_9f03697a",
      "range": {
        "startLine": 261,
        "startChar": 11,
        "endLine": 262,
        "endChar": 30
      },
      "revId": "a33b52ae0f255021d89307ebc694f6e907906151",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9fa88c68_ae2651a3",
        "filename": "resources/libraries/python/PapiExecutor.py",
        "patchSetId": 48
      },
      "lineNbr": 262,
      "author": {
        "id": 1263
      },
      "writtenOn": "2021-01-13T12:48:45Z",
      "side": 1,
      "message": "\u003e a non-dynamic import code path\n\nCreating two instances (first VppTransport then VPPApiClient) looks fine, we can start doing that (one release after 30361 is merged).\n\n\u003e Do you have any plans to install papi via pip?\n\nUsually we avoid touching the active virtualenv during tests. But if it is clear only one package is installed (no dependencies, and the test will attempt to uninstall it at the end) we can make an exception.\nWhat is the recommended way to install PAPI via pip?\nThere is python3-vpp-api_{version}.deb, but we do not want to mess with system packages on the robot machine (as it may be CSIT developer\u0027s carefully tweaked installation).",
      "parentUuid": "e4ce83ba_107f331e",
      "range": {
        "startLine": 261,
        "startChar": 11,
        "endLine": 262,
        "endChar": 30
      },
      "revId": "a33b52ae0f255021d89307ebc694f6e907906151",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4d004270_98e0e167",
        "filename": "resources/libraries/python/PapiExecutor.py",
        "patchSetId": 48
      },
      "lineNbr": 262,
      "author": {
        "id": 1496
      },
      "writtenOn": "2021-01-13T14:26:12Z",
      "side": 1,
      "message": "For test, we do it like this:\n$(PAPI_INSTALL_DONE): $(PIP_PATCH_DONE)\n\t@bash -c \"source $(VENV_PATH)/bin/activate \u0026\u0026 $(PYTHON_INTERP) -m pip install -e $(PAPI_PYTHON_SRC_DIR)\"\n\t@touch $@\nhttps://github.com/FDio/vpp/blob/master/test/Makefile#L152\n\nThe shm transport requires cffi, but we could make that optional if it helps.  It would mean that shm users install as pip install vpp_papi[shm]\n\nYou should be able to install it with --user, but I have not tried.  We don\u0027t need to because we run it in a venv.\n\nI would not touch the .deb/.rpm\u0027s. From my perspective, they are/have been broken and are only there for someone\u0027s checkmark on a list.  Until recently, they depended on aenum, which does not have a package, so you have to install the dependencies via pip by hand.  The fixes for updating them are in gerrit.",
      "parentUuid": "9fa88c68_ae2651a3",
      "range": {
        "startLine": 261,
        "startChar": 11,
        "endLine": 262,
        "endChar": 30
      },
      "revId": "a33b52ae0f255021d89307ebc694f6e907906151",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5a7fe7cf_f30d9219",
        "filename": "resources/libraries/python/PapiExecutor.py",
        "patchSetId": 48
      },
      "lineNbr": 262,
      "author": {
        "id": 76
      },
      "writtenOn": "2021-01-13T14:41:48Z",
      "side": 1,
      "message": "There is no PAPI package exported on packagecloud as a part of CI/CD. Also no exceptions for DEB on executor. From CI/CD that is not clean enough (virtualenv vs systemenv).",
      "parentUuid": "9fa88c68_ae2651a3",
      "range": {
        "startLine": 261,
        "startChar": 11,
        "endLine": 262,
        "endChar": 30
      },
      "revId": "a33b52ae0f255021d89307ebc694f6e907906151",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    }
  ]
}