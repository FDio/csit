The New PAL
===========

Hardware
--------

Three servers in a cluster. HW Specification:

..
    TODO:

- Processor:
- RAM:
- Disc:
- Connectivity:

Architecture
------------

The system consists of two parts:

- Processing of the results of tests generated by LF Jenkins (Data source).
  It includes these sub-systems:

    - Data store
    - Data search
    - Data processing
    - Data visualisation

- Monitoring of the system. The system itself is monitored to prevent and/or
  detect critical situations and watch how it is used. It includes these
  sub-systems (separate production and monitoring clusters):

   - Data store
   - Data search
   - Data visualisation

Data
````

This part stores the results of tests together with all information generated
by RF tests (NDRPDR, MRR, FUNC). It provides access to data and visualises it.
The presentation part generates graphs and tables, e.g.:

- Trending, see an example [ExampleTrending]_
- Packet throughput, see an example [ExamplePacketThroughput]_
- Packet latency, see an example [ExamplePacketLatency]_
- Speedup multi-core, see an example [ExampleSpeedup]_
- Other views on the data, specified in [gitGraphs]_

.. figure:: pic/new_pal_data_processing.svg
    :width: 800 px
    :scale: 100 %
    :align: center
    :alt: The picture "new_pal_data_processing.svg" not found.

    *Fig 1: Proposed structure of the Data Processing and Visualization system.*

- Data source: Jenkins executor (output.xml)
- Data store: Logstash [Logstash]_
    - Input plugin: File [File]_
    - Filter plugin: XML [XML]_
    - Output plugin: Elasticsearch [Elasticsearch_Plugin]_
- Data search: Elasticsearch [Elasticsearch]_
- Data processing and visualisation: Plotly Dash [Dash]_

Data store
''''''''''

..
    TODO:

- [Logstash_Installation]_


Data search
'''''''''''

..
    TODO:

- [Elasticsearch_Installation]_

Data processing and visualisation
'''''''''''''''''''''''''''''''''

- Homemade python code
- Plotly Dash

..
    TODO:


Monitoring and Alerting
```````````````````````

.. figure:: pic/new_pal_monitoring.svg
    :width: 800 px
    :scale: 100 %
    :align: center
    :alt: The picture "new_pal_monitoring.svg" not found.

    *Fig 2: Proposed structure of the Monitoring and Alerting system.*

Parts of monitoring and alerting:

..
    TODO:

- Elastic Monitoring [Monitoring]_
- Alerting feature of Elastic Monitoring [Alerting]_
- Elastic X-Pack must be installed on all monitored parts of Elastic Stack
  [XPack]_, [XPack_Installation]_


Links
-----

.. [ExampleTrending] `Trending <https://docs.fd.io/csit/master/trending/trending/l2-3n-hsw-x520-64b-base-scale.html#t1c>`_
.. [ExamplePacketThroughput] `Packet Throughput <https://docs.fd.io/csit/rls1810/report/vpp_performance_tests/packet_throughput_graphs/srv6-3n-hsw-x520.html#b-1t1c-features>`_
.. [ExamplePacketLatency] `Packet Latency <https://docs.fd.io/csit/rls1810/report/vpp_performance_tests/packet_latency_graphs/srv6-3n-hsw-x520.html#b-1t1c-features>`_
.. [ExampleSpeedup] `Speedup multi-core <https://docs.fd.io/csit/rls1810/report/vpp_performance_tests/throughput_speedup_multi_core/srv6-3n-hsw-x520.html#b-features>`_
.. [gitGraphs] `Graphs Improvements <https://github.com/FDio/csit/blob/master/resources/tools/presentation/doc/graphs_improvements.rst>`_
.. [Logstash] `Elastic Logstash <https://www.elastic.co/products/logstash>`_
.. [Logstash_Installation] `Logstash Installation <https://www.elastic.co/guide/en/logstash/current/installing-logstash.html>`_
.. [File] `File Input Plugin <https://www.elastic.co/guide/en/logstash/current/plugins-inputs-file.html>`_
.. [XML] `XML Filter Plugin <https://www.elastic.co/guide/en/logstash/current/plugins-filters-xml.html>`_
.. [Elasticsearch_Plugin] `Elasticsearch Output Plugin <https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html>`_
.. [Elasticsearch] `Elastic Elasticsearch <https://www.elastic.co/products/elasticsearch>`_
.. [Elasticsearch_Installation] `Elasticsearch Installation <https://www.elastic.co/guide/en/elasticsearch/reference/current/_installation.html>`_
.. [Monitoring] `Elastic Monitoring <https://www.elastic.co/products/stack/monitoring>`_
.. [Alerting] `Elastic Aletring <https://www.elastic.co/products/stack/alerting>`_
.. [XPack] `X-Pack <https://www.elastic.co/guide/en/x-pack/current/index.html>`_
.. [XPack_Installation] `X-Pack Installation <https://www.elastic.co/guide/en/x-pack/current/installing-xpack.html>`_
.. [Dash] `Plotly Dash <https://plot.ly/products/dash/>`_
