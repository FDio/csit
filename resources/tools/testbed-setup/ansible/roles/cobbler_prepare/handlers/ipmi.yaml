---
# file: roles/common/handlers/ipmi.yaml

- name: IPMI Power up server
  ipmi_boot:
    name: '{{ inventory_ipmi_hostname }}'
    user: '{{ inventory_ipmi_username }}'
    password: '{{ inventory_ipmi_password }}'
    state: on
  delegate_to: localhost
  tags: ipmi-power-up

- name: IPMI Power down server
  ipmi_boot:
    name: '{{ inventory_ipmi_hostname }}'
    user: '{{ inventory_ipmi_username }}'
    password: '{{ inventory_ipmi_password }}'
    state: off
  delegate_to: localhost
  tags: ipmi-power-down

- name: IPMI Power cycle server
  ipmi_boot:
    name: '{{ inventory_ipmi_hostname }}'
    user: '{{ inventory_ipmi_username }}'
    password: '{{ inventory_ipmi_password }}'
    state: boot
  delegate_to: localhost
  tags: ipmi-power-cycle

- name: IPMI Boot from network
  ipmi_boot:
    name: '{{ inventory_ipmi_hostname }}'
    user: '{{ inventory_ipmi_username }}'
    password: '{{ inventory_ipmi_password }}'
    bootdev: network
  delegate_to: localhost
  tags: ipmi-boot-network

- name: IPMI Boot from storage
  ipmi_boot:
    name: '{{ inventory_ipmi_hostname }}'
    user: '{{ inventory_ipmi_username }}'
    password: '{{ inventory_ipmi_password }}'
    bootdev: hd
  delegate_to: localhost
  tags: ipmi-boot-storage
