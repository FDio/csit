---
# file: roles/common/tasks/main.yaml

- name: Ubuntu specific
  import_tasks: ubuntu_x86_64.yaml
  when: ansible_distribution|lower == 'ubuntu'

- name: Set hostname
  hostname:
      name: '{{ hostname }}'
  tags: hostname

- name: Ensure hostname is in /etc/hosts
  lineinfile:
    path: /etc/hosts
    regexp: '^{{ ansible_default_ipv4.address }}.+$'
    line: '{{ ansible_default_ipv4.address }} {{ hostname }}.linuxfoundation.org'
  tags: hostname

- name: Set sudoers
  lineinfile:
    path: /etc/sudoers
    state: present
    regexp: '^%ADMIN ALL='
    line: '%ADMIN ALL=(root) NOPASSWD: ALL'
    validate: '/usr/sbin/visudo -cf %s'
  tags: sudoers

- name: Copy grub file
  template:
   src: 'files/grub dest=/etc/default/grub owner=root group=root mode=644'
  notify: ['Update GRUB']
  tags: grub
