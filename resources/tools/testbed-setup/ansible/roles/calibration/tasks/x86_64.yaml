---
# file: roles/calibration/tasks/x86_64.yaml

- name: Calibration - Clone PMA Tool
  git:
    repo: "https://gerrit.fd.io/r/pma_tools"
    dest: "{{ pma_directory }}"
  tags:
    - check-jitter-tool

- name: Calibration - Compile PMA Tool
  raw: "cd {{ pma_directory }}/jitter && make"
  tags:
    - check-jitter-tool

- name: Calibration - Run Jitter Tool
  raw: "{{ pma_directory }}/jitter/jitter -c {{ jitter_core }} -i {{ jitter_iterations }} -f"
  become: yes
  async: 60
  poll: 5
  ignore_errors: yes
  register: __jitter_output
  tags:
    - check-jitter-tool

- debug: var=__jitter_output.stdout_lines
  tags:
    - check-jitter-tool
