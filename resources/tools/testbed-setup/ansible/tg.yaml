---
# file: tg.yaml

- hosts: tg
  remote_user: testuser
  become: yes
  become_user: root
  gather_facts: false
  pre_tasks:
    - name: Gathering Facts
      gather_facts:
      tags:
        - always
  roles:
    - role: baremetal
      tags: baremetal
    - role: common
      tags: common
    - role: kernel
      tags: kernel
    - role: mellanox
      tags: mellanox
    - role: docker
      tags: docker
    - role: tg
      tags: tg
    - role: iperf
      tags: iperf
    - role: trex
      tags: trex
    - role: ab
      tags: ab
    - role: performance_tuning
      tags: performance_tuning
    - role: cleanup
      tags: cleanup
    - role: calibration
      tags: calibration

- hosts: tg_aws
  remote_user: testuser
  become: yes
  become_user: root
  gather_facts: false
  pre_tasks:
    - name: Gathering Facts
      gather_facts:
      tags:
        - always
  roles:
    - role: user_add
      tags: user_add
    - role: common
      tags: common
    - role: dpdk
      tags: dpdk
    - role: aws
      tags: aws
    - role: docker
      tags: docker
    - role: tg
      tags: tg
    - role: iperf
      tags: iperf
    - role: trex
      tags: trex
    - role: ab
      tags: ab
    - role: cleanup
      tags: cleanup
    # TODO: 'Check Kernel Parameters' failing in
    # resources/tools/testbed-setup/ansible/roles/calibration/tasks/main.yaml
    # - role: calibration
    #   tags: calibration

- hosts: tg_azure
  become: yes
  become_user: root
  gather_facts: false
  pre_tasks:
    - name: Gathering Facts
      gather_facts:
      tags:
        - always
  roles:
    - role: user_add
      tags: user_add
    - role: common
      tags: common
    - role: azure
      tags: azure
    - role: docker
      tags: docker
    - role: tg
      tags: tg
    - role: iperf
      tags: iperf
    - role: trex
      tags: trex
    - role: ab
      tags: ab
    - role: cleanup
      tags: cleanup
    # TODO: 'Check Kernel Parameters' failing in
    # resources/tools/testbed-setup/ansible/roles/calibration/tasks/main.yaml
    # - role: calibration
    #   tags: calibration