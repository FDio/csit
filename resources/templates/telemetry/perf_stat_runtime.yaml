---
logging:
  version: 1
  formatters:
    console_stdout:
      format: '%(asctime)s - %(name)s - %(message)s'
    console_stderr:
      format: '%(message)s'
    prom:
      format: '%(message)s'
  handlers:
    console_stdout:
      class: logging.StreamHandler
      level: INFO
      formatter: console_stdout
      stream: ext://sys.stdout
    console_stderr:
      class: logging.StreamHandler
      level: ERROR
      formatter: console_stderr
      stream: ext://sys.stderr
    prom:
      class: logging.handlers.RotatingFileHandler
      level: INFO
      formatter: prom
      filename: /tmp/metric.prom
      mode: w
  loggers:
    prom:
      handlers: [prom]
      level: INFO
      propagate: False
  root:
    level: INFO
    handlers: [console_stdout, console_stderr]
scheduler:
  duration: 1
programs:
  - name: bundle_perf_stat
    metrics:
      gauge:
        - name: cpu-cycles
          documentation: Cycles processed by CPUs
          labelnames:
            - name
            - thread
            - pid
    events:
      - name: cpu-cycles # 0x3C umask: 0x00
        EventCode: 0x3C
        UMask: 0x00
  - name: bundle_perf_stat
    metrics:
      gauge:
        - name: instructions
          documentation: Instructions retired by CPUs
          labelnames:
            - name
            - thread
            - pid
    events:
      - name: instructions # 0xC0 umask: 0x00
        EventCode: 0xC0
        UMask: 0x00
  - name: bundle_perf_stat
    metrics:
      gauge:
        - name: MEM_LOAD_UOPS_RETIRED.L1_HIT
          documentation: L1 Hit
          labelnames:
            - name
            - thread
            - pid
    events:
      - name: MEM_LOAD_UOPS_RETIRED.L1_HIT # 0xD1 umask: 0x01
        EventCode: 0xD1
        UMask: 0x01
  - name: bundle_perf_stat
    metrics:
      gauge:
        - name: MEM_LOAD_UOPS_RETIRED.L2_HIT
          documentation: L2 Hit
          labelnames:
            - name
            - thread
            - pid
    events:
      - name: MEM_LOAD_UOPS_RETIRED.L2_HIT # 0xd1 umask: 0x02
        EventCode: 0xD1
        UMask: 0x02
  - name: bundle_perf_stat
    metrics:
      gauge:
        - name: MEM_LOAD_UOPS_RETIRED.L3_HIT
          documentation: L3 Hit
          labelnames:
            - name
            - thread
            - pid
    events:
      - name: MEM_LOAD_UOPS_RETIRED.L3_HIT # 0xd1 umask: 0x04
        EventCode: 0xD1
        UMask: 0x04
  - name: bundle_perf_stat
    metrics:
      gauge:
        - name: MEM_LOAD_UOPS_RETIRED.L1_MISS
          documentation: L1 Miss
          labelnames:
            - name
            - thread
            - pid
    events:
      - name: MEM_LOAD_UOPS_RETIRED.L1_MISS # 0xd1 umask: 0x08
        EventCode: 0xD1
        UMask: 0x08
  - name: bundle_perf_stat
    metrics:
      gauge:
        - name: MEM_LOAD_UOPS_RETIRED.L2_MISS
          documentation: L2 Miss
          labelnames:
            - name
            - thread
            - pid
    events:
      - name: MEM_LOAD_UOPS_RETIRED.L2_MISS # 0xd1 umask: 0x10
        EventCode: 0xD1
        UMask: 0x10
  - name: bundle_perf_stat
    metrics:
      gauge:
        - name: MEM_LOAD_UOPS_RETIRED.L3_MISS
          documentation: L3 Miss
          labelnames:
            - name
            - thread
            - pid
    events:
      - name: MEM_LOAD_UOPS_RETIRED.L3_MISS # 0xd1 umask: 0x020
        EventCode: 0xD1
        UMask: 0x20
