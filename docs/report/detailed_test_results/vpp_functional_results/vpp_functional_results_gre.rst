
.. |br| raw:: html

    <br />

GRE Overlay Tunnels
-------------------

eth2p-ethip4gre-ip4base-func
''''''''''''''''''''''''''''

**GREoIPv4 test cases**   

 - **[Top] Network Topologies:** TG=DUT1 2-node topology with two links between nodes; TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-GRE-IPv4-ICMPv4 on DUT1-DUT2, Eth-IPv4-ICMPv4 on TG-DUTn for routing over GRE tunnel; Eth-IPv4-ICMPv4 on TG_if1-DUT, Eth-IPv4-GRE-IPv4-ICMPv4 on TG_if2_DUT for GREoIPv4 encapsulation and decapsulation verification.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with IPv4 routing and static routes. GREoIPv4 tunnel is configured between DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv4 (or ICMPv6) Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; GREoIPv4 encapsulation and decapsulation are verified separately by TG; on receive TG verifies packets for correctness and their IPv4 (IPv6) src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC2784.

+---------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
| Name                                                                                  | Documentation                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Status |
+=======================================================================================+========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+========+
| TC01: DUT1 and DUT2 route over GREoIPv4 tunnel between two TG links                   | [Top] TG-DUT1-DUT2-TG.  |br| [Enc] Eth-IPv4-GRE-IPv4-ICMPv4 on  DUT1-DUT2, Eth-IPv4-ICMPv4 on TG-DUTn.  |br| [Cfg] On DUT1 and DUT2 configure GREoIPv4 tunnel with IPv4 routes towards each other.  |br| [Ver] Make TG send ICMPv4 Echo Req between its interfaces across both DUTs and GRE tunnel between them; verify IPv4 headers on received packets are correct.  |br| [Ref] RFC2784.                                                                                                                                                                                                                             | PASS   |
+---------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
| TC02: DUT encapsulates IPv4 into GREoIPv4 tunnel - GRE header verification            | [Top] TG=DUT1.  |br| [Enc] Eth-IPv4-ICMPv4 on TG_if1-DUT,  Eth-IPv4-GRE-IPv4-ICMPv4 on TG_if2_DUT.  |br| [Cfg] On DUT1 configure GREoIPv4 tunnel with IPv4 route towards TG.  |br| [Ver] Make TG send non-encapsulated ICMPv4 Echo Req to DUT; verify TG received GREoIPv4 encapsulated packet is correct.  |br| [Ref] RFC2784.                                                                                                                                                                                                                                                                                        | PASS   |
+---------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
| TC03: DUT decapsulates IPv4 from GREoIPv4 tunnel - IPv4 header verification           | [Top] TG=DUT1.  |br| [Enc] Eth-IPv4-ICMPv4 on TG_if1-DUT,  Eth-IPv4-GRE-IPv4-ICMPv4 on TG_if2_DUT.  |br| [Cfg] On DUT1 configure GREoIPv4 tunnel towards TG.  |br| [Ver] Make TG send ICMPv4 Echo Req encapsulated into GREoIPv4 towards VPP; verify TG received IPv4 de-encapsulated packet is correct.  |br| [Ref] RFC2784.                                                                                                                                                                                                                                                                                          | PASS   |
+---------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
| TC04: DUT encapsulates IPv4 into GREoIPv4 different tunnels - GRE header verification | [Top] TG=DUT1.  |br| [Enc] Eth-IPv4-ICMPv4 on TG_if1-DUT,  Eth-IPv4-GRE-IPv4-ICMPv4 on TG_if2_DUT.  |br| [Cfg] On DUT1 configure two GRE tunnels with loopback's source address. Destination address of tunnels are routed via next hop address of DUT's to TG if2, where should be only GRE encapsulated packets. Each tunnel has IPv4 address and configured prefix routed through the tunnel.  |br| [Ver] Make TG send non-encapsulated ICMPv4 Echo Req to DUT; verify TG received GREoIPv4 encapsulated packet is correct for each tunnel.  |br| [Ref] RFC2784.                                                    | PASS   |
+---------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
| TC05: DUT re-encapsulates IPv4 GRE into other GRE tunnel - GRE header verification    | [Top] TG=DUT1.  |br| [Enc] Eth-IPv4-ICMPv4 on TG_if1-DUT,  Eth-IPv4-GRE-IPv4-ICMPv4 on TG_if2_DUT.  |br| [Cfg] On DUT1 configure two GRE tunnels with loopback's source address. Destination address of tunnels are routed via next hop address of DUT's to TG if2, where should be only GRE encapsulated packets. Each tunnel has IPv4 address and configured prefix routed through the tunnel.  |br| [Ver] Make TG send encapsulated IPv4 UDP to DUT; Encapsulated IP source is behind configured tunnel same as destination; verify TG received GREoIPv4 encapsulated packet is correct.  |br| [Ref] RFC2784.       | PASS   |
+---------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
| TC06: DUT do not process GRE with wrong tunnel destination IP                         | [Top] TG=DUT1.  |br| [Enc] Eth-IPv4-ICMPv4 on TG_if1-DUT,  Eth-IPv4-GRE-IPv4-ICMPv4 on TG_if2_DUT.  |br| [Cfg] On DUT1 configure two GRE tunnels with loopback's source address. Destination address of tunnels are routed via next hop address of DUT's to TG if2, where should be only GRE encapsulated packets. On DUT's to TG if1 interface is configured test destination host MAC address.  |br| [Ver] Make TG send GRE encapsulated ICMPv4 Echo Req to DUT; verify TG received de-capsulated packet is correct, then send packet with wrong tunnel destination address.  |br| [Ref] RFC2784.                    | PASS   |
+---------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+

