
.. |br| raw:: html

    <br />


.. |prein| raw:: html

    <pre>


.. |preout| raw:: html

    </pre>

crypto
``````



eth2p-ethip4ipsectnl-ip4base-func
'''''''''''''''''''''''''''''''''

**IPv4 IPsec tunnel mode test suite.**   

 - **[Top] Network topologies:** TG-DUT1 2-node topology with one link between nodes.  

 - **[Cfg] DUT configuration:** On DUT1 create loopback interface, configure loopback an physical interface IPv4 addresses, static ARP record, route and IPsec manual keyed connection in tunnel mode.  

 - **[Ver] TG verification:** ESP packet is sent from TG to DUT1. ESP packet is received on TG from DUT1.  

 - **[Ref] Applicable standard specifications:** RFC4303.

+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                                                                                   | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
+========================================================================================================================================================================+==========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: VPP process ESP packet in Tunnel Mode with AES-CBC-128 encryption and SHA1-96 integrity                                                                          |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 6748736d6572474268664f72696a7136 integ_alg sha1-96 integ_key 58553351447959334575423571316d713139397a tunnel_src 192.168.100.3 tunnel_dst 192.168.100.2 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 6748736d6572474268664f72696a7136 integ_alg sha1-96 integ_key 58553351447959334575423571316d713139397a tunnel_src 192.168.100.2 tunnel_dst 192.168.100.3 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                              |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC05: VPP process ESP packet in Tunnel Mode with AES-CBC-192 encryption and SHA-256-128 integrity                                                                      |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-192 crypto_key 4c376952323677304362324f3432445068516b7a65334a51 integ_alg sha-256-128 integ_key 79794e66443863556a4e57367049427156714c4c7a466643653474626e773868 tunnel_src 192.168.100.3 tunnel_dst 192.168.100.2 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-192 crypto_key 4c376952323677304362324f3432445068516b7a65334a51 integ_alg sha-256-128 integ_key 79794e66443863556a4e57367049427156714c4c7a466643653474626e773868 tunnel_src 192.168.100.2 tunnel_dst 192.168.100.3 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC09: VPP process ESP packet in Tunnel Mode with AES-CBC-256 encryption and SHA-384-192 integrity                                                                      |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-256 crypto_key 5336467352697647585853356337757958686e4d506f5736696f74714f75334f integ_alg sha-384-192 integ_key 696a7555714176356b716f7a496c53775a627a57666254706d41617747743554425a6b46367441436179795471774133 tunnel_src 192.168.100.3 tunnel_dst 192.168.100.2 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-256 crypto_key 5336467352697647585853356337757958686e4d506f5736696f74714f75334f integ_alg sha-384-192 integ_key 696a7555714176356b716f7a496c53775a627a57666254706d41617747743554425a6b46367441436179795471774133 tunnel_src 192.168.100.2 tunnel_dst 192.168.100.3 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC12: VPP process ESP packet in Tunnel Mode with AES-CBC-256 encryption and SHA-512-256 integrity                                                                      |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-256 crypto_key 726f497335465a77304f71727967644c7a3075736f6974365646746e366e7274 integ_alg sha-512-256 integ_key 48327267434b6a703665537050555159667a666d4953446e443967534e616565497654534b6b5a4a396741776c674e524d50586e635a6b4f4c3242524b366769 tunnel_src 192.168.100.3 tunnel_dst 192.168.100.2 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-256 crypto_key 726f497335465a77304f71727967644c7a3075736f6974365646746e366e7274 integ_alg sha-512-256 integ_key 48327267434b6a703665537050555159667a666d4953446e443967534e616565497654534b6b5a4a396741776c674e524d50586e635a6b4f4c3242524b366769 tunnel_src 192.168.100.2 tunnel_dst 192.168.100.3 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC13: VPP process ESP packet in Tunnel Mode with AES-CBC-128 encryption and SHA1-96 integrity - different encryption alogrithms used                                   |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 79576d6e4e784973324d583066475558 integ_alg sha1-96 integ_key 423231554941444e72413939474e41627437376d tunnel_src 192.168.100.3 tunnel_dst 192.168.100.2 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 79576d6e4e784973324d583066475558 integ_alg sha1-96 integ_key 423231554941444e72413939474e41627437376d tunnel_src 192.168.100.2 tunnel_dst 192.168.100.3 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                              |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC14: VPP process ESP packet in Tunnel Mode with AES-CBC-128 encryption and SHA1-96 integrity - different integrity alogrithms used                                    |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 6c634e6c30707049435a684d6f614874 integ_alg sha1-96 integ_key 34755861675a37676e6361326630504444446f79 tunnel_src 192.168.100.3 tunnel_dst 192.168.100.2 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 6c634e6c30707049435a684d6f614874 integ_alg sha1-96 integ_key 34755861675a37676e6361326630504444446f79 tunnel_src 192.168.100.2 tunnel_dst 192.168.100.3 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                              |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC15: VPP process ESP packet in Tunnel Mode with AES-CBC-128 encryption and SHA1-96 integrity - different encryption and integrity alogrithms used                     |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 687a5363757936784e31683474597a6d integ_alg sha1-96 integ_key 31466d343649334a50426344454c6253544e374c tunnel_src 192.168.100.3 tunnel_dst 192.168.100.2 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 687a5363757936784e31683474597a6d integ_alg sha1-96 integ_key 31466d343649334a50426344454c6253544e374c tunnel_src 192.168.100.2 tunnel_dst 192.168.100.3 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                              |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC16: VPP process ESP packet in Tunnel Mode with AES-CBC-128 encryption and SHA1-96 integrity with update SA keys                                                      |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 485a724335456b6c773279374d5a4752 integ_alg sha1-96 integ_key 4233386a5a657039624234654946415335344b65 tunnel_src 192.168.100.3 tunnel_dst 192.168.100.2 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 485a724335456b6c773279374d5a4752 integ_alg sha1-96 integ_key 4233386a5a657039624234654946415335344b65 tunnel_src 192.168.100.2 tunnel_dst 192.168.100.3 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br| ipsec_sa_set_key sa_id 10 crypto_key 6f526f47316f6141566c545155326179 integ_key 48426331764d5779413639456f32584c74465236 |br| ipsec_sa_set_key sa_id 20 crypto_key 6f526f47316f6141566c545155326179 integ_key 48426331764d5779413639456f32584c74465236 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC17: VPP process ESP packet in Tunnel Mode with AES-CBC-128 encryption and SHA1-96 integrity with update SA keys - different encryption alogrithms used               |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 55495237696f50445064474b39324134 integ_alg sha1-96 integ_key 6d41636b624975735541593133586e4d43756355 tunnel_src 192.168.100.3 tunnel_dst 192.168.100.2 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 55495237696f50445064474b39324134 integ_alg sha1-96 integ_key 6d41636b624975735541593133586e4d43756355 tunnel_src 192.168.100.2 tunnel_dst 192.168.100.3 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br| ipsec_sa_set_key sa_id 10 crypto_key 6b7a37414b75433579626d704c577977 integ_key 317155617444523143586c5057345a6747763648 |br| ipsec_sa_set_key sa_id 20 crypto_key 6b7a37414b75433579626d704c577977 integ_key 317155617444523143586c5057345a6747763648 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC18: VPP process ESP packet in Tunnel Mode with AES-CBC-128 encryption and SHA1-96 integrity with update SA keys - different integrity alogrithms used                |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 4a376e62444b3043425a496a4f634b55 integ_alg sha1-96 integ_key 4e79613836485a54754c5378685a4a4669333739 tunnel_src 192.168.100.3 tunnel_dst 192.168.100.2 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 4a376e62444b3043425a496a4f634b55 integ_alg sha1-96 integ_key 4e79613836485a54754c5378685a4a4669333739 tunnel_src 192.168.100.2 tunnel_dst 192.168.100.3 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br| ipsec_sa_set_key sa_id 10 crypto_key 797171696e3661547767675532366835 integ_key 36556a5872494d48746c49787a7534426e6a3578 |br| ipsec_sa_set_key sa_id 20 crypto_key 797171696e3661547767675532366835 integ_key 36556a5872494d48746c49787a7534426e6a3578 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC19: VPP process ESP packet in Tunnel Mode with AES-CBC-128 encryption and SHA1-96 integrity with update SA keys - different encryption and integrity alogrithms used |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 35705342733342345a3662736631716c integ_alg sha1-96 integ_key 657456586b674e7951564e464e73624f396e454f tunnel_src 192.168.100.3 tunnel_dst 192.168.100.2 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 35705342733342345a3662736631716c integ_alg sha1-96 integ_key 657456586b674e7951564e464e73624f396e454f tunnel_src 192.168.100.2 tunnel_dst 192.168.100.3 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.4.4 laddr_stop 192.168.4.4 raddr_start 192.168.3.3 raddr_stop 192.168.3.3  |br| ipsec_sa_set_key sa_id 10 crypto_key 5655416a52594736487134754d6e476b integ_key 766d476b356d55566864794677676869386a7346 |br| ipsec_sa_set_key sa_id 20 crypto_key 5655416a52594736487134754d6e476b integ_key 766d476b356d55566864794677676869386a7346 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4ipsectpt-ip4base-func
'''''''''''''''''''''''''''''''''

**IPv4 IPsec transport mode test suite.**   

 - **[Top] Network topologies:** TG-DUT1 2-node topology with one link between nodes.  

 - **[Cfg] DUT configuration:** On DUT1 create loopback interface, configure loopback an physical interface IPv4 addresses, static ARP record, route and IPsec manual keyed connection in transport mode.  

 - **[Ver] TG verification:** ESP packet is sent from TG to DUT1. ESP packet is received on TG from DUT1.  

 - **[Ref] Applicable standard specifications:** RFC4303.

+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                                                                                      | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
+===========================================================================================================================================================================+========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: VPP process ESP packet in Transport Mode with AES-CBC-128 encryption and SHA1-96 integrity                                                                          |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 634e4d6a4d6534766b4574444c756b66 integ_alg sha1-96 integ_key 546438504674457a6135535136316965777a6e32  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 634e4d6a4d6534766b4574444c756b66 integ_alg sha1-96 integ_key 546438504674457a6135535136316965777a6e32  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                              |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC05: VPP process ESP packet in Transport Mode with AES-CBC-192 encryption and SHA-256-128 integrity                                                                      |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-192 crypto_key 6d795842567a556e783147336858626d743434724f306d4e integ_alg sha-256-128 integ_key 5777464d4a79634474566258335a34636443517549434e454e627258436b3765  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-192 crypto_key 6d795842567a556e783147336858626d743434724f306d4e integ_alg sha-256-128 integ_key 5777464d4a79634474566258335a34636443517549434e454e627258436b3765  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                      |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC09: VPP process ESP packet in Transport Mode with AES-CBC-256 encryption and SHA-384-192 integrity                                                                      |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-256 crypto_key 32514e5453377977326d5330644c4255375930766d6468694b30625467717537 integ_alg sha-384-192 integ_key 6532534c62706e6f63547743533542534e6f4c57386c6378493866344b5a62775473566e32547172634f646c6f774a32  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-256 crypto_key 32514e5453377977326d5330644c4255375930766d6468694b30625467717537 integ_alg sha-384-192 integ_key 6532534c62706e6f63547743533542534e6f4c57386c6378493866344b5a62775473566e32547172634f646c6f774a32  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                      |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC12: VPP process ESP packet in Transport Mode with AES-CBC-256 encryption and SHA-512-256 integrity                                                                      |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-256 crypto_key 724f68686c6956694e457a4650587345684e45445848376648724f6766707357 integ_alg sha-512-256 integ_key 736d75784d50777a635139504153325a3130645131387a327669586277396f7038633747515a496c44625752674964744b4e6d3472736c4459484f5131735235  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-256 crypto_key 724f68686c6956694e457a4650587345684e45445848376648724f6766707357 integ_alg sha-512-256 integ_key 736d75784d50777a635139504153325a3130645131387a327669586277396f7038633747515a496c44625752674964744b4e6d3472736c4459484f5131735235  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|      |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC13: VPP process ESP packet in Transport Mode with AES-CBC-128 encryption and SHA1-96 integrity - different encryption alogrithms used                                   |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 69374c573951784f7631347861795156 integ_alg sha1-96 integ_key 684b6971574e733745746d62736e5a7731634756  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 69374c573951784f7631347861795156 integ_alg sha1-96 integ_key 684b6971574e733745746d62736e5a7731634756  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                              |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC14: VPP process ESP packet in Transport Mode with AES-CBC-128 encryption and SHA1-96 integrity - different integrity alogrithms used                                    |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 5a325a486742663332325038684c7971 integ_alg sha1-96 integ_key 597a374b637236764246426f74624855625a734b  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 5a325a486742663332325038684c7971 integ_alg sha1-96 integ_key 597a374b637236764246426f74624855625a734b  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                              |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC15: VPP process ESP packet in Transport Mode with AES-CBC-128 encryption and SHA1-96 integrity - different encryption and integrity alogrithms used                     |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 4537773277697366794c3261676a7136 integ_alg sha1-96 integ_key 55544433315138494152596230584f5977566e50  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 4537773277697366794c3261676a7136 integ_alg sha1-96 integ_key 55544433315138494152596230584f5977566e50  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                              |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC16: VPP process ESP packet in Transport Mode with AES-CBC-128 encryption and SHA1-96 integrity with update SA keys                                                      |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 644246625937696c4f4e56714157524b integ_alg sha1-96 integ_key 554f486f4a79686a6654755377776250736b6762  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 644246625937696c4f4e56714157524b integ_alg sha1-96 integ_key 554f486f4a79686a6654755377776250736b6762  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br| ipsec_sa_set_key sa_id 10 crypto_key 513357547267616d4d4f425976585266 integ_key 77616c477961343161424a656c6366354c445a73 |br| ipsec_sa_set_key sa_id 20 crypto_key 513357547267616d4d4f425976585266 integ_key 77616c477961343161424a656c6366354c445a73 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC17: VPP process ESP packet in Transport Mode with AES-CBC-128 encryption and SHA1-96 integrity with update SA keys - different encryption alogrithms used               |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 7654536d376d4c497368584d34685967 integ_alg sha1-96 integ_key 367649473930514f5770726c4e786f384e515643  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 7654536d376d4c497368584d34685967 integ_alg sha1-96 integ_key 367649473930514f5770726c4e786f384e515643  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br| ipsec_sa_set_key sa_id 10 crypto_key 36426f3278544d6262727a7941564252 integ_key 457656544635774e5948444f6f61624542384178 |br| ipsec_sa_set_key sa_id 20 crypto_key 36426f3278544d6262727a7941564252 integ_key 457656544635774e5948444f6f61624542384178 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC18: VPP process ESP packet in Transport Mode with AES-CBC-128 encryption and SHA1-96 integrity with update SA keys - different integrity alogrithms used                |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 6243384232344144564d6c684168664b integ_alg sha1-96 integ_key 376f447071557863373030454e3761744635796e  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 6243384232344144564d6c684168664b integ_alg sha1-96 integ_key 376f447071557863373030454e3761744635796e  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br| ipsec_sa_set_key sa_id 10 crypto_key 7a5242316a307a585a6754726c4d3447 integ_key 556a34746331726c7347704c466d3247396c4b36 |br| ipsec_sa_set_key sa_id 20 crypto_key 7a5242316a307a585a6754726c4d3447 integ_key 556a34746331726c7347704c466d3247396c4b36 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC19: VPP process ESP packet in Transport Mode with AES-CBC-128 encryption and SHA1-96 integrity with update SA keys - different encryption and integrity alogrithms used |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.100.3/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.4.4/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.100.2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 192.168.3.3/24 via 192.168.100.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 6b414b4264313674653148516f396569 integ_alg sha1-96 integ_key 69476250476d6d6f43334e327448635a74777361  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 6b414b4264313674653148516f396569 integ_alg sha1-96 integ_key 69476250476d6d6f43334e327448635a74777361  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 192.168.100.3 laddr_stop 192.168.100.3 raddr_start 192.168.100.2 raddr_stop 192.168.100.2  |br| ipsec_sa_set_key sa_id 10 crypto_key 736a617a69336a6e6849684171337951 integ_key 524461623971567776774577625468536c306c61 |br| ipsec_sa_set_key sa_id 20 crypto_key 736a617a69336a6e6849684171337951 integ_key 524461623971567776774577625468536c306c61 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4ipsectptlispgpe-ip4base-func
''''''''''''''''''''''''''''''''''''''''

**IPv4-ip4-ipsec-lispgpe-ip4 - main fib, vrf (gpe_vni-to-vrf)**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** ICMPv4-IPv4-IPSec-LISPGPE-IPv4-ICMPv4.  

 - **[Cfg] DUT configuration:** Each DUT is configured with LISP and IPsec. IPsec is in transport mode. Tests cases are for IPsec configured both on RLOC interface or lisp_gpe0 interface.  

 - **[Ver] TG verification:** Packet is send from TG(if1) across the DUT1 to DUT2 where it is forwarded to TG(if2).  

 - **[Ref] Applicable standard specifications:** RFC6830, RFC4303.

+------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                                               | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+====================================================================================================================================+====================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv4 bidirectionally over LISP GPE tunnel using IPsec (transport) on RLOC Int.                           |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 0  |br| sw_interface_add_del_address sw_if_index 3 6.6.3.1/24 |br| sw_interface_add_del_address sw_if_index 1 6.6.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 6.6.1.2 mac fa:16:3e:4f:67:30 |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.2 mac fa:16:3e:74:cf:d6 |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6.6.1.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 6.6.2.0/24 seid 6.6.1.0/24 rloc 6.6.3.2 |br| lisp_add_del_adjacency add vni 0 reid 6.6.2.0/24 leid 6.6.1.0/24 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 4c4a6738596538595843777347367855 integ_alg sha1-96 integ_key 443977365645706d63586e427156567a46484d56  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 4c4a6738596538595843777347367855 integ_alg sha1-96 integ_key 443977365645706d63586e427156567a46484d56  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 3 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.3.1 laddr_stop 6.6.3.1 raddr_start 6.6.3.2 raddr_stop 6.6.3.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.3.1 laddr_stop 6.6.3.1 raddr_start 6.6.3.2 raddr_stop 6.6.3.2  |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 0  |br| sw_interface_add_del_address sw_if_index 3 6.6.3.2/24 |br| sw_interface_add_del_address sw_if_index 1 6.6.2.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 6.6.2.2 mac fa:16:3e:61:8c:24 |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.1 mac fa:16:3e:71:45:bf |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6.6.2.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 6.6.1.0/24 seid 6.6.2.0/24 rloc 6.6.3.1 |br| lisp_add_del_adjacency add vni 0 reid 6.6.1.0/24 leid 6.6.2.0/24 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1000 crypto_alg aes-cbc-128 crypto_key 4c4a6738596538595843777347367855 integ_alg sha1-96 integ_key 443977365645706d63586e427156567a46484d56  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1001 crypto_alg aes-cbc-128 crypto_key 4c4a6738596538595843777347367855 integ_alg sha1-96 integ_key 443977365645706d63586e427156567a46484d56  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 3 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.3.2 laddr_stop 6.6.3.2 raddr_start 6.6.3.1 raddr_stop 6.6.3.1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.3.2 laddr_stop 6.6.3.2 raddr_start 6.6.3.1 raddr_stop 6.6.3.1  |br|  |preout|                         |
+------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT1 and DUT2 route IPv4 bidirectionally over LISP GPE tunnel using IPsec (transport) lisp_gpe0 Int.                         |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 0  |br| sw_interface_add_del_address sw_if_index 3 6.6.3.1/24 |br| sw_interface_add_del_address sw_if_index 1 6.6.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 6.6.1.2 mac fa:16:3e:4f:67:30 |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.2 mac fa:16:3e:74:cf:d6 |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6.6.1.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 6.6.2.0/24 seid 6.6.1.0/24 rloc 6.6.3.2 |br| lisp_add_del_adjacency add vni 0 reid 6.6.2.0/24 leid 6.6.1.0/24 |br| sw_interface_dump |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 327969305843313959584b306d625442 integ_alg sha1-96 integ_key 654d5972466252736c3375746e6569354c574d4e  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 327969305843313959584b306d625442 integ_alg sha1-96 integ_key 654d5972466252736c3375746e6569354c574d4e  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 5 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.1.2 laddr_stop 6.6.1.2 raddr_start 6.6.2.2 raddr_stop 6.6.2.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.1.2 laddr_stop 6.6.1.2 raddr_start 6.6.2.2 raddr_stop 6.6.2.2  |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 0  |br| sw_interface_add_del_address sw_if_index 3 6.6.3.2/24 |br| sw_interface_add_del_address sw_if_index 1 6.6.2.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 6.6.2.2 mac fa:16:3e:61:8c:24 |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.1 mac fa:16:3e:71:45:bf |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6.6.2.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 6.6.1.0/24 seid 6.6.2.0/24 rloc 6.6.3.1 |br| lisp_add_del_adjacency add vni 0 reid 6.6.1.0/24 leid 6.6.2.0/24 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1000 crypto_alg aes-cbc-128 crypto_key 327969305843313959584b306d625442 integ_alg sha1-96 integ_key 654d5972466252736c3375746e6569354c574d4e  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1001 crypto_alg aes-cbc-128 crypto_key 327969305843313959584b306d625442 integ_alg sha1-96 integ_key 654d5972466252736c3375746e6569354c574d4e  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 5 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.2.2 laddr_stop 6.6.2.2 raddr_start 6.6.1.2 raddr_stop 6.6.1.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.2.2 laddr_stop 6.6.2.2 raddr_start 6.6.1.2 raddr_stop 6.6.1.2  |br|  |preout|  |
+------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: DUT1 and DUT2 route IPv4 bidirectionally over LISP GPE tunnel using IPsec (transport) on RLOC Int and VRF on EID is enabled. |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 1  |br| sw_interface_add_del_address sw_if_index 3 6.6.3.1/24 |br| sw_interface_add_del_address sw_if_index 1 6.6.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 6.6.1.2 mac fa:16:3e:4f:67:30 |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.2 mac fa:16:3e:74:cf:d6 |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 1 vrf 1 |br| lisp_add_del_local_eid vni 1 eid 6.6.1.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 1 eid 6.6.2.0/24 seid 6.6.1.0/24 rloc 6.6.3.2 |br| lisp_add_del_adjacency add vni 1 reid 6.6.2.0/24 leid 6.6.1.0/24 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 334464546a5453384b425a5945616e72 integ_alg sha1-96 integ_key 65305747795668344c326a6b5256787664703061  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 334464546a5453384b425a5945616e72 integ_alg sha1-96 integ_key 65305747795668344c326a6b5256787664703061  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 3 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.3.1 laddr_stop 6.6.3.1 raddr_start 6.6.3.2 raddr_stop 6.6.3.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.3.1 laddr_stop 6.6.3.1 raddr_start 6.6.3.2 raddr_stop 6.6.3.2  |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 1  |br| sw_interface_add_del_address sw_if_index 3 6.6.3.2/24 |br| sw_interface_add_del_address sw_if_index 1 6.6.2.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 6.6.2.2 mac fa:16:3e:61:8c:24 |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.1 mac fa:16:3e:71:45:bf |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 1 vrf 1 |br| lisp_add_del_local_eid vni 1 eid 6.6.2.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 1 eid 6.6.1.0/24 seid 6.6.2.0/24 rloc 6.6.3.1 |br| lisp_add_del_adjacency add vni 1 reid 6.6.1.0/24 leid 6.6.2.0/24 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1000 crypto_alg aes-cbc-128 crypto_key 334464546a5453384b425a5945616e72 integ_alg sha1-96 integ_key 65305747795668344c326a6b5256787664703061  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1001 crypto_alg aes-cbc-128 crypto_key 334464546a5453384b425a5945616e72 integ_alg sha1-96 integ_key 65305747795668344c326a6b5256787664703061  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 3 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.3.2 laddr_stop 6.6.3.2 raddr_start 6.6.3.1 raddr_stop 6.6.3.1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.3.2 laddr_stop 6.6.3.2 raddr_start 6.6.3.1 raddr_stop 6.6.3.1  |br|  |preout|                         |
+------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC04: DUT1 and DUT2 route IPv4 bidirectionally over LISP GPE tunnel using IPsec (transport) on lisp_gpe0 Int and VRF is enabled.   |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 1  |br| sw_interface_add_del_address sw_if_index 3 6.6.3.1/24 |br| sw_interface_add_del_address sw_if_index 1 6.6.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 6.6.1.2 mac fa:16:3e:4f:67:30 |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.2 mac fa:16:3e:74:cf:d6 |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 1 vrf 1 |br| lisp_add_del_local_eid vni 1 eid 6.6.1.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 1 eid 6.6.2.0/24 seid 6.6.1.0/24 rloc 6.6.3.2 |br| lisp_add_del_adjacency add vni 1 reid 6.6.2.0/24 leid 6.6.1.0/24 |br| sw_interface_dump |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 57484d326a5967673858675261394359 integ_alg sha1-96 integ_key 4a7177784c654e336b504e626a37626b4e6b4971  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 57484d326a5967673858675261394359 integ_alg sha1-96 integ_key 4a7177784c654e336b504e626a37626b4e6b4971  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 5 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.1.2 laddr_stop 6.6.1.2 raddr_start 6.6.2.2 raddr_stop 6.6.2.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.1.2 laddr_stop 6.6.1.2 raddr_start 6.6.2.2 raddr_stop 6.6.2.2  |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 1  |br| sw_interface_add_del_address sw_if_index 3 6.6.3.2/24 |br| sw_interface_add_del_address sw_if_index 1 6.6.2.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 6.6.2.2 mac fa:16:3e:61:8c:24 |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.1 mac fa:16:3e:71:45:bf |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 1 vrf 1 |br| lisp_add_del_local_eid vni 1 eid 6.6.2.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 1 eid 6.6.1.0/24 seid 6.6.2.0/24 rloc 6.6.3.1 |br| lisp_add_del_adjacency add vni 1 reid 6.6.1.0/24 leid 6.6.2.0/24 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1000 crypto_alg aes-cbc-128 crypto_key 57484d326a5967673858675261394359 integ_alg sha1-96 integ_key 4a7177784c654e336b504e626a37626b4e6b4971  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1001 crypto_alg aes-cbc-128 crypto_key 57484d326a5967673858675261394359 integ_alg sha1-96 integ_key 4a7177784c654e336b504e626a37626b4e6b4971  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 5 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.2.2 laddr_stop 6.6.2.2 raddr_start 6.6.1.2 raddr_stop 6.6.1.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.2.2 laddr_stop 6.6.2.2 raddr_start 6.6.1.2 raddr_stop 6.6.1.2  |br|  |preout|  |
+------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4ipsectptlispgpe-ip6base-func
''''''''''''''''''''''''''''''''''''''''

**IPv6 - ip4-ipsec-lispgpe-ip6 - main fib, vrf, virt2lisp, phy2lisp**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-LISPGPE-IPSec-IPv6-ICMP, Eth-IPv4-IPSec-LISPGPE-IPv6-ICMP  

 - **[Cfg] DUT configuration:** Each DUT is configured with LISP and IPsec. IPsec is in transport mode. Tests cases are for IPsec configured both on RLOC interface or lisp_gpe0 interface.  

 - **[Ver] TG verification:** Packet is send from TG(if1) across the DUT1 to DUT2 where it is forwarded to TG(if2).  

 - **[Ref] Applicable standard specifications:** RFC6830, RFC4303.

+---------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                          | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
+===============================================================================================================+========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv4 bidirectionally over LISP GPE tunnel using IPsec (transport) on RLOC Int.      |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6.6.3.1/24 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:1::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.2 mac fa:16:3e:74:cf:d6 |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:1::2 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 2001:cdba:1::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 2001:cdba:2::0/64 seid 2001:cdba:1::0/64 rloc 6.6.3.2 |br| lisp_add_del_adjacency add vni 0 reid 2001:cdba:2::0/64 leid 2001:cdba:1::0/64 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 67723641654a745a4a37366554654d47 integ_alg sha1-96 integ_key 78556f5a645066637a7979396e5a753962676550  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 67723641654a745a4a37366554654d47 integ_alg sha1-96 integ_key 78556f5a645066637a7979396e5a753962676550  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 3 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.3.1 laddr_stop 6.6.3.1 raddr_start 6.6.3.2 raddr_stop 6.6.3.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.3.1 laddr_stop 6.6.3.1 raddr_start 6.6.3.2 raddr_stop 6.6.3.2  |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6.6.3.2/24 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:2::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:2::2 mac fa:16:3e:61:8c:24 |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.1 mac fa:16:3e:71:45:bf |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 2001:cdba:2::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 2001:cdba:1::0/64 seid 2001:cdba:2::0/64 rloc 6.6.3.1 |br| lisp_add_del_adjacency add vni 0 reid 2001:cdba:1::0/64 leid 2001:cdba:2::0/64 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1000 crypto_alg aes-cbc-128 crypto_key 67723641654a745a4a37366554654d47 integ_alg sha1-96 integ_key 78556f5a645066637a7979396e5a753962676550  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1001 crypto_alg aes-cbc-128 crypto_key 67723641654a745a4a37366554654d47 integ_alg sha1-96 integ_key 78556f5a645066637a7979396e5a753962676550  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 3 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.3.2 laddr_stop 6.6.3.2 raddr_start 6.6.3.1 raddr_stop 6.6.3.1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.3.2 laddr_stop 6.6.3.2 raddr_start 6.6.3.1 raddr_stop 6.6.3.1  |br|  |preout|                         |
+---------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT1 and DUT2 route IPv4 bidirectionally over LISP GPE tunnel using IPsec (transport) on lisp_gpe0 Int. |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6.6.3.1/24 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:1::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.2 mac fa:16:3e:74:cf:d6 |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:1::2 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 2001:cdba:1::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 2001:cdba:2::0/64 seid 2001:cdba:1::0/64 rloc 6.6.3.2 |br| lisp_add_del_adjacency add vni 0 reid 2001:cdba:2::0/64 leid 2001:cdba:1::0/64 |br| sw_interface_dump |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 435a3162753576767468366156435648 integ_alg sha1-96 integ_key 4374414369384864355a7964574a4b66686d4a52  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 435a3162753576767468366156435648 integ_alg sha1-96 integ_key 4374414369384864355a7964574a4b66686d4a52  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 5 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.3.1 laddr_stop 6.6.3.1 raddr_start 6.6.3.2 raddr_stop 6.6.3.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.3.1 laddr_stop 6.6.3.1 raddr_start 6.6.3.2 raddr_stop 6.6.3.2  |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6.6.3.2/24 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:2::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:2::2 mac fa:16:3e:61:8c:24 |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.1 mac fa:16:3e:71:45:bf |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 2001:cdba:2::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 2001:cdba:1::0/64 seid 2001:cdba:2::0/64 rloc 6.6.3.1 |br| lisp_add_del_adjacency add vni 0 reid 2001:cdba:1::0/64 leid 2001:cdba:2::0/64 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1000 crypto_alg aes-cbc-128 crypto_key 435a3162753576767468366156435648 integ_alg sha1-96 integ_key 4374414369384864355a7964574a4b66686d4a52  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1001 crypto_alg aes-cbc-128 crypto_key 435a3162753576767468366156435648 integ_alg sha1-96 integ_key 4374414369384864355a7964574a4b66686d4a52  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 5 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.3.2 laddr_stop 6.6.3.2 raddr_start 6.6.3.1 raddr_stop 6.6.3.1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.3.2 laddr_stop 6.6.3.2 raddr_start 6.6.3.1 raddr_stop 6.6.3.1  |br|  |preout|  |
+---------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4ipsectptlispgpe-ip6basevrf-func
'''''''''''''''''''''''''''''''''''''''''''

**IPv6 - ip4-ipsec-lispgpe-ip6 - main fib, vrf, virt2lisp, phy2lisp**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-LISPGPE-IPSec-IPv6-ICMP, Eth-IPv4-IPSec-LISPGPE-IPv6-ICMP  

 - **[Cfg] DUT configuration:** Each DUT is configured with LISP and IPsec. IPsec is in transport mode. Tests cases are for IPsec configured both on RLOC interface or lisp_gpe0 interface.  

 - **[Ver] TG verification:** Packet is send from TG(if1) across the DUT1 to DUT2 where it is forwarded to TG(if2).  

 - **[Ref] Applicable standard specifications:** RFC6830, RFC4303.

+------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                             | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+==================================================================================================================+=====================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv6 bidirectionally over LISP GPE tunnel using physical interfaces and VRF is enabled |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 1 ipv6 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 39557349624c5554754b596972776535 integ_alg sha1-96 integ_key 767a6a45626470617267584e72704a336c675646  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 39557349624c5554754b596972776535 integ_alg sha1-96 integ_key 767a6a45626470617267584e72704a336c675646  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 3 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.3.1 laddr_stop 6.6.3.1 raddr_start 6.6.3.2 raddr_stop 6.6.3.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.3.1 laddr_stop 6.6.3.1 raddr_start 6.6.3.2 raddr_stop 6.6.3.2  |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6.6.3.1/24 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:1::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.2 mac fa:16:3e:74:cf:d6 |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:1::2 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 1 vrf 1 |br| lisp_add_del_local_eid vni 1 eid 2001:cdba:1::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 1 eid 2001:cdba:2::0/64 seid 2001:cdba:1::0/64 rloc 6.6.3.2 |br| lisp_add_del_adjacency add vni 1 reid 2001:cdba:2::0/64 leid 2001:cdba:1::0/64 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 1 ipv6 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1000 crypto_alg aes-cbc-128 crypto_key 39557349624c5554754b596972776535 integ_alg sha1-96 integ_key 767a6a45626470617267584e72704a336c675646  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1001 crypto_alg aes-cbc-128 crypto_key 39557349624c5554754b596972776535 integ_alg sha1-96 integ_key 767a6a45626470617267584e72704a336c675646  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 3 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.3.2 laddr_stop 6.6.3.2 raddr_start 6.6.3.1 raddr_stop 6.6.3.1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.3.2 laddr_stop 6.6.3.2 raddr_start 6.6.3.1 raddr_stop 6.6.3.1  |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6.6.3.2/24 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:2::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:2::2 mac fa:16:3e:61:8c:24 |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.1 mac fa:16:3e:71:45:bf |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 1 vrf 1 |br| lisp_add_del_local_eid vni 1 eid 2001:cdba:2::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 1 eid 2001:cdba:1::0/64 seid 2001:cdba:2::0/64 rloc 6.6.3.1 |br| lisp_add_del_adjacency add vni 1 reid 2001:cdba:1::0/64 leid 2001:cdba:2::0/64 |br|  |preout|  |
+------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6ipsectnl-ip6base-func
'''''''''''''''''''''''''''''''''

**IPv6 IPsec tunnel mode test suite.**   

 - **[Top] Network topologies:** TG-DUT1 2-node topology with one link between nodes.  

 - **[Cfg] DUT configuration:** On DUT1 create loopback interface, configure loopback an physical interface IPv6 addresses, static ARP record, route and IPsec manual keyed connection in tunnel mode.  

 - **[Ver] TG verification:** ESP packet is sent from TG to DUT1. ESP packet is received on TG from DUT1.  

 - **[Ref] Applicable standard specifications:** RFC4303.

+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                                                                                   | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
+========================================================================================================================================================================+=============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: VPP process ESP packet in Tunnel Mode with AES-CBC-128 encryption and SHA1-96 integrity                                                                          |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 6655456850525970344c72517a693055 integ_alg sha1-96 integ_key 6169433161414c465773315a334257773338664d tunnel_src 3ffe:5f::2 tunnel_dst 3ffe:5f::1 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 6655456850525970344c72517a693055 integ_alg sha1-96 integ_key 6169433161414c465773315a334257773338664d tunnel_src 3ffe:5f::1 tunnel_dst 3ffe:5f::2 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                                                                                                                                                                                                              |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC05: VPP process ESP packet in Tunnel Mode with AES-CBC-192 encryption and SHA-256-128 integrity                                                                      |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-192 crypto_key 69694f764f5a67305044664555696a3848754d6b4e364c6b integ_alg sha-256-128 integ_key 6675576e6568375938477967456b6d48506f547173687069725a774e74686533 tunnel_src 3ffe:5f::2 tunnel_dst 3ffe:5f::1 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-192 crypto_key 69694f764f5a67305044664555696a3848754d6b4e364c6b integ_alg sha-256-128 integ_key 6675576e6568375938477967456b6d48506f547173687069725a774e74686533 tunnel_src 3ffe:5f::1 tunnel_dst 3ffe:5f::2 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                                                                                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC09: VPP process ESP packet in Tunnel Mode with AES-CBC-256 encryption and SHA-384-192 integrity                                                                      |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-256 crypto_key 496d6d5774694c64715a64685137723069316f5946676e64525657496c526336 integ_alg sha-384-192 integ_key 5830644655764f543638314e6352674c31564862636f6430374673444e637477744339735a7275555569774352376451 tunnel_src 3ffe:5f::2 tunnel_dst 3ffe:5f::1 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-256 crypto_key 496d6d5774694c64715a64685137723069316f5946676e64525657496c526336 integ_alg sha-384-192 integ_key 5830644655764f543638314e6352674c31564862636f6430374673444e637477744339735a7275555569774352376451 tunnel_src 3ffe:5f::1 tunnel_dst 3ffe:5f::2 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC12: VPP process ESP packet in Tunnel Mode with AES-CBC-256 encryption and SHA-512-256 integrity                                                                      |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-256 crypto_key 3667766267317048376a455379466c37754b35486334624b7948663965787031 integ_alg sha-512-256 integ_key 5372414d7656434b7161456c365244453671645a675156745265705143427637433276547251434649564c42463543616a6737474d506e707a63373157434d6c tunnel_src 3ffe:5f::2 tunnel_dst 3ffe:5f::1 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-256 crypto_key 3667766267317048376a455379466c37754b35486334624b7948663965787031 integ_alg sha-512-256 integ_key 5372414d7656434b7161456c365244453671645a675156745265705143427637433276547251434649564c42463543616a6737474d506e707a63373157434d6c tunnel_src 3ffe:5f::1 tunnel_dst 3ffe:5f::2 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC13: VPP process ESP packet in Tunnel Mode with AES-CBC-128 encryption and SHA1-96 integrity - different encryption alogrithms used                                   |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 616c32666b374a716253744238614b6e integ_alg sha1-96 integ_key 54674d62614361596b553162774c6a695a764773 tunnel_src 3ffe:5f::2 tunnel_dst 3ffe:5f::1 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 616c32666b374a716253744238614b6e integ_alg sha1-96 integ_key 54674d62614361596b553162774c6a695a764773 tunnel_src 3ffe:5f::1 tunnel_dst 3ffe:5f::2 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                                                                                                                                                                                                              |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC14: VPP process ESP packet in Tunnel Mode with AES-CBC-128 encryption and SHA1-96 integrity - different integrity alogrithms used                                    |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 6b306530704c66516c64596d794d3537 integ_alg sha1-96 integ_key 4e7962574d48626d476e4464666c57704d376f6a tunnel_src 3ffe:5f::2 tunnel_dst 3ffe:5f::1 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 6b306530704c66516c64596d794d3537 integ_alg sha1-96 integ_key 4e7962574d48626d476e4464666c57704d376f6a tunnel_src 3ffe:5f::1 tunnel_dst 3ffe:5f::2 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                                                                                                                                                                                                              |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC15: VPP process ESP packet in Tunnel Mode with AES-CBC-128 encryption and SHA1-96 integrity - different encryption and integrity alogrithms used                     |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 356662356978793471584c576d424864 integ_alg sha1-96 integ_key 70667750774b61743945616b714655524e497971 tunnel_src 3ffe:5f::2 tunnel_dst 3ffe:5f::1 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 356662356978793471584c576d424864 integ_alg sha1-96 integ_key 70667750774b61743945616b714655524e497971 tunnel_src 3ffe:5f::1 tunnel_dst 3ffe:5f::2 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                                                                                                                                                                                                              |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC16: VPP process ESP packet in Tunnel Mode with AES-CBC-128 encryption and SHA1-96 integrity with update SA keys                                                      |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 487665444a314564386a4a6e7672376a integ_alg sha1-96 integ_key 736e7258613157647163554d6669316f374f686f tunnel_src 3ffe:5f::2 tunnel_dst 3ffe:5f::1 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 487665444a314564386a4a6e7672376a integ_alg sha1-96 integ_key 736e7258613157647163554d6669316f374f686f tunnel_src 3ffe:5f::1 tunnel_dst 3ffe:5f::2 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br| ipsec_sa_set_key sa_id 10 crypto_key 30646632547179747836567178335443 integ_key 5a426c66716473344f4251413047395372583877 |br| ipsec_sa_set_key sa_id 20 crypto_key 30646632547179747836567178335443 integ_key 5a426c66716473344f4251413047395372583877 |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|  |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC17: VPP process ESP packet in Tunnel Mode with AES-CBC-128 encryption and SHA1-96 integrity with update SA keys - different encryption alogrithms used               |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 79307335517a4e395169515853647641 integ_alg sha1-96 integ_key 4d704c526c67497543473750737339424977526e tunnel_src 3ffe:5f::2 tunnel_dst 3ffe:5f::1 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 79307335517a4e395169515853647641 integ_alg sha1-96 integ_key 4d704c526c67497543473750737339424977526e tunnel_src 3ffe:5f::1 tunnel_dst 3ffe:5f::2 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br| ipsec_sa_set_key sa_id 10 crypto_key 4b59566a685134664a535235576c5362 integ_key 32373051594c31625a7166366167786c3733787a |br| ipsec_sa_set_key sa_id 20 crypto_key 4b59566a685134664a535235576c5362 integ_key 32373051594c31625a7166366167786c3733787a |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|  |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC18: VPP process ESP packet in Tunnel Mode with AES-CBC-128 encryption and SHA1-96 integrity with update SA keys - different integrity alogrithms used                |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 56705a74504a587147786c4848376b74 integ_alg sha1-96 integ_key 556e6e613352385843634b454c41456b4a734934 tunnel_src 3ffe:5f::2 tunnel_dst 3ffe:5f::1 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 56705a74504a587147786c4848376b74 integ_alg sha1-96 integ_key 556e6e613352385843634b454c41456b4a734934 tunnel_src 3ffe:5f::1 tunnel_dst 3ffe:5f::2 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br| ipsec_sa_set_key sa_id 10 crypto_key 614e386f6e634a4f47696a4c77485539 integ_key 39635379366f31336d4842525832465041577075 |br| ipsec_sa_set_key sa_id 20 crypto_key 614e386f6e634a4f47696a4c77485539 integ_key 39635379366f31336d4842525832465041577075 |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|  |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC19: VPP process ESP packet in Tunnel Mode with AES-CBC-128 encryption and SHA1-96 integrity with update SA keys - different encryption and integrity alogrithms used |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 715a4a5054373452736f7465705a5835 integ_alg sha1-96 integ_key 5a57744f7869463072324b6d79674b526d486c59 tunnel_src 3ffe:5f::2 tunnel_dst 3ffe:5f::1 |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 715a4a5054373452736f7465705a5835 integ_alg sha1-96 integ_key 5a57744f7869463072324b6d79674b526d486c59 tunnel_src 3ffe:5f::1 tunnel_dst 3ffe:5f::2 |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:60::4 laddr_stop 3ffe:60::4 raddr_start 3ffe:60::3 raddr_stop 3ffe:60::3  |br| ipsec_sa_set_key sa_id 10 crypto_key 4b4136644e7752366b423464795a4755 integ_key 5a356b496f67723977697a73345255524b4f656c |br| ipsec_sa_set_key sa_id 20 crypto_key 4b4136644e7752366b423464795a4755 integ_key 5a356b496f67723977697a73345255524b4f656c |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|  |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6ipsectpt-ip6base-func
'''''''''''''''''''''''''''''''''

**IPv6 IPsec transport mode test suite.**   

 - **[Top] Network topologies:** TG-DUT1 2-node topology with one link between nodes.  

 - **[Cfg] DUT configuration:** On DUT1 create loopback interface, configure loopback an physical interface IPv6 addresses, static ARP record, route and IPsec manual keyed connection in transport mode.  

 - **[Ver] TG verification:** ESP packet is sent from TG to DUT1. ESP packet is received on TG from DUT1.  

 - **[Ref] Applicable standard specifications:** RFC4303.

+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                                                                                      | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+===========================================================================================================================================================================+=======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: VPP process ESP packet in Transport Mode with AES-CBC-128 encryption and SHA1-96 integrity                                                                          |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 527936464530314a5937726e437a7178 integ_alg sha1-96 integ_key 304b4f77325275305171634a577272347968396b  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 527936464530314a5937726e437a7178 integ_alg sha1-96 integ_key 304b4f77325275305171634a577272347968396b  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                                                                                                                                                                                                              |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC05: VPP process ESP packet in Transport Mode with AES-CBC-192 encryption and SHA-256-128 integrity                                                                      |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-192 crypto_key 777437526b6a77766f41724559685a59317752655a713866 integ_alg sha-256-128 integ_key 6b6157685855395067695339646f7a4d4b51744862566d475968304f4f545671  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-192 crypto_key 777437526b6a77766f41724559685a59317752655a713866 integ_alg sha-256-128 integ_key 6b6157685855395067695339646f7a4d4b51744862566d475968304f4f545671  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                                                                                                                      |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC09: VPP process ESP packet in Transport Mode with AES-CBC-256 encryption and SHA-384-192 integrity                                                                      |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-256 crypto_key 596c6a62347330593536633777723972317058774d4851757537384548644f77 integ_alg sha-384-192 integ_key 6154396f764233443130646432704d5752474e646561474a676c3931756b686845387a546d34744a704e4c644d6b7667  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-256 crypto_key 596c6a62347330593536633777723972317058774d4851757537384548644f77 integ_alg sha-384-192 integ_key 6154396f764233443130646432704d5752474e646561474a676c3931756b686845387a546d34744a704e4c644d6b7667  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                      |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC12: VPP process ESP packet in Transport Mode with AES-CBC-256 encryption and SHA-512-256 integrity                                                                      |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-256 crypto_key 387432444f5178746c6f716d45666b387730394631527074746e58466c705639 integ_alg sha-512-256 integ_key 6d4a5469375763766371516a533055367a724f61513046424c58504b6e5547644c494666706a704855496f70384662494e664677726e6e415176414b7772734a  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-256 crypto_key 387432444f5178746c6f716d45666b387730394631527074746e58466c705639 integ_alg sha-512-256 integ_key 6d4a5469375763766371516a533055367a724f61513046424c58504b6e5547644c494666706a704855496f70384662494e664677726e6e415176414b7772734a  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|      |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC13: VPP process ESP packet in Transport Mode with AES-CBC-128 encryption and SHA1-96 integrity - different encryption alogrithms used                                   |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 584b583148384b615164333054324b70 integ_alg sha1-96 integ_key 5245484c57425447384f6a4467766e5a71326d4e  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 584b583148384b615164333054324b70 integ_alg sha1-96 integ_key 5245484c57425447384f6a4467766e5a71326d4e  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                                                                                                                                                                                                              |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC14: VPP process ESP packet in Transport Mode with AES-CBC-128 encryption and SHA1-96 integrity - different integrity alogrithms used                                    |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 6b567838443657727a473178456a4c32 integ_alg sha1-96 integ_key 6e7838593364784c4f306c757953574441573278  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 6b567838443657727a473178456a4c32 integ_alg sha1-96 integ_key 6e7838593364784c4f306c757953574441573278  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                                                                                                                                                                                                              |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC15: VPP process ESP packet in Transport Mode with AES-CBC-128 encryption and SHA1-96 integrity - different encryption and integrity alogrithms used                     |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 5a7669767a31643444307951746e4446 integ_alg sha1-96 integ_key 486539366a48396a6b463065627931394a4e504f  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 5a7669767a31643444307951746e4446 integ_alg sha1-96 integ_key 486539366a48396a6b463065627931394a4e504f  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                                                                                                                                                                                                              |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC16: VPP process ESP packet in Transport Mode with AES-CBC-128 encryption and SHA1-96 integrity with update SA keys                                                      |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 396c3743696265536f6f6547796f6b4d integ_alg sha1-96 integ_key 617a484b533862574e4e33564465344658757133  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 396c3743696265536f6f6547796f6b4d integ_alg sha1-96 integ_key 617a484b533862574e4e33564465344658757133  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br| ipsec_sa_set_key sa_id 10 crypto_key 466a7473724f723872725759475a5253 integ_key 6e504864495a4d496857484157344f364d436b72 |br| ipsec_sa_set_key sa_id 20 crypto_key 466a7473724f723872725759475a5253 integ_key 6e504864495a4d496857484157344f364d436b72 |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|  |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC17: VPP process ESP packet in Transport Mode with AES-CBC-128 encryption and SHA1-96 integrity with update SA keys - different encryption alogrithms used               |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 6c63686d6d69754b4d444d346c545062 integ_alg sha1-96 integ_key 77587442465633394d456b38724456376c437164  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 6c63686d6d69754b4d444d346c545062 integ_alg sha1-96 integ_key 77587442465633394d456b38724456376c437164  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br| ipsec_sa_set_key sa_id 10 crypto_key 38686446424b5354726854634e4e6c54 integ_key 67555a576a544f4f4d6c6b30636749624c326b50 |br| ipsec_sa_set_key sa_id 20 crypto_key 38686446424b5354726854634e4e6c54 integ_key 67555a576a544f4f4d6c6b30636749624c326b50 |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|  |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC18: VPP process ESP packet in Transport Mode with AES-CBC-128 encryption and SHA1-96 integrity with update SA keys - different integrity alogrithms used                |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 4b53446b544a4b6c5864517574534a33 integ_alg sha1-96 integ_key 70677970644d6649327774306673616d4946344f  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 4b53446b544a4b6c5864517574534a33 integ_alg sha1-96 integ_key 70677970644d6649327774306673616d4946344f  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br| ipsec_sa_set_key sa_id 10 crypto_key 515031634571473932617a7a49516f55 integ_key 685638586e5a496c334e59537a6f68697867674d |br| ipsec_sa_set_key sa_id 20 crypto_key 515031634571473932617a7a49516f55 integ_key 685638586e5a496c334e59537a6f68697867674d |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|  |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC19: VPP process ESP packet in Transport Mode with AES-CBC-128 encryption and SHA1-96 integrity with update SA keys - different encryption and integrity alogrithms used |  |prein| **DUT1:** |br| create_loopback |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:5f::2/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 5 3ffe:60::4/64 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:5f::1 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:60::3/128 via 3ffe:5f::1  sw_if_index 1 resolve-attempts 10 count 1    |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 3674326b55446f636b46737755627257 integ_alg sha1-96 integ_key 77723057364a476c316770436e71737672597876  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 3674326b55446f636b46737755627257 integ_alg sha1-96 integ_key 77723057364a476c316770436e71737672597876  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 1 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 3ffe:5f::2 laddr_stop 3ffe:5f::2 raddr_start 3ffe:5f::1 raddr_stop 3ffe:5f::1  |br| ipsec_sa_set_key sa_id 10 crypto_key 42375466316d6d3233645a5439727332 integ_key 3739644d616c5a46537055343533355748315563 |br| ipsec_sa_set_key sa_id 20 crypto_key 42375466316d6d3233645a5439727332 integ_key 3739644d616c5a46537055343533355748315563 |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|  |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6ipsectptlispgpe-ip4base-func
''''''''''''''''''''''''''''''''''''''''

**IPv6 - ip4-ipsec-lispgpe-ip6 - main fib, virt2lisp, phy2lisp**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv6-LISPGPE-IPSec-IPv4-ICMP, Eth-IPv6-IPSec-LISPGPE-IPv4-ICMP  

 - **[Cfg] DUT configuration:** Each DUT is configured with LISP and IPsec. IPsec is in transport mode. Tests cases are for IPsec configured both on RLOC interface or lisp_gpe0 interface.  

 - **[Ver] TG verification:** Packet is send from TG(if1) across the DUT1 to DUT2 where it is forwarded to TG(if2).  

 - **[Ref] Applicable standard specifications:** RFC6830, RFC4303.

+---------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                          | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+===============================================================================================================+=====================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv4 bidirectionally over LISP GPE tunnel using IPsec (transport) on RLOC Int.      |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 6.0.1.1/24 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::2 mac fa:16:3e:74:cf:d6 |br| ip_neighbor_add_del sw_if_index 1 dst 6.0.1.2 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6.0.1.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 6.0.2.0/24 seid 6.0.1.0/24 rloc 2001:cdba:3::2 |br| lisp_add_del_adjacency add vni 0 reid 6.0.2.0/24 leid 6.0.1.0/24 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 334c755675556377527144744f463055 integ_alg sha1-96 integ_key 774435394451687764676e367a4b6b34427a3635  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 334c755675556377527144744f463055 integ_alg sha1-96 integ_key 774435394451687764676e367a4b6b34427a3635  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 3 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 2001:cdba:3::1 laddr_stop 2001:cdba:3::1 raddr_start 2001:cdba:3::2 raddr_stop 2001:cdba:3::2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 2001:cdba:3::1 laddr_stop 2001:cdba:3::1 raddr_start 2001:cdba:3::2 raddr_stop 2001:cdba:3::2  |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::2/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 6.0.2.1/24 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 6.0.2.2 mac fa:16:3e:61:8c:24 |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::1 mac fa:16:3e:71:45:bf |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6.0.2.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 6.0.1.0/24 seid 6.0.2.0/24 rloc 2001:cdba:3::1 |br| lisp_add_del_adjacency add vni 0 reid 6.0.1.0/24 leid 6.0.2.0/24 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1000 crypto_alg aes-cbc-128 crypto_key 334c755675556377527144744f463055 integ_alg sha1-96 integ_key 774435394451687764676e367a4b6b34427a3635  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1001 crypto_alg aes-cbc-128 crypto_key 334c755675556377527144744f463055 integ_alg sha1-96 integ_key 774435394451687764676e367a4b6b34427a3635  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 3 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 2001:cdba:3::2 laddr_stop 2001:cdba:3::2 raddr_start 2001:cdba:3::1 raddr_stop 2001:cdba:3::1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 2001:cdba:3::2 laddr_stop 2001:cdba:3::2 raddr_start 2001:cdba:3::1 raddr_stop 2001:cdba:3::1  |br|  |preout|                         |
+---------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT1 and DUT2 route IPv4 bidirectionally over LISP GPE tunnel using IPsec (transport) on lisp_gpe0 Int. |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 6.0.1.1/24 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::2 mac fa:16:3e:74:cf:d6 |br| ip_neighbor_add_del sw_if_index 1 dst 6.0.1.2 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6.0.1.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 6.0.2.0/24 seid 6.0.1.0/24 rloc 2001:cdba:3::2 |br| lisp_add_del_adjacency add vni 0 reid 6.0.2.0/24 leid 6.0.1.0/24 |br| sw_interface_dump |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 5154416d36415657303463723174697a integ_alg sha1-96 integ_key 43306856544c78337076306d456a373476346679  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 5154416d36415657303463723174697a integ_alg sha1-96 integ_key 43306856544c78337076306d456a373476346679  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 5 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 2001:cdba:3::1 laddr_stop 2001:cdba:3::1 raddr_start 2001:cdba:3::2 raddr_stop 2001:cdba:3::2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 2001:cdba:3::1 laddr_stop 2001:cdba:3::1 raddr_start 2001:cdba:3::2 raddr_stop 2001:cdba:3::2  |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::2/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 6.0.2.1/24 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 6.0.2.2 mac fa:16:3e:61:8c:24 |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::1 mac fa:16:3e:71:45:bf |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6.0.2.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 6.0.1.0/24 seid 6.0.2.0/24 rloc 2001:cdba:3::1 |br| lisp_add_del_adjacency add vni 0 reid 6.0.1.0/24 leid 6.0.2.0/24 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1000 crypto_alg aes-cbc-128 crypto_key 5154416d36415657303463723174697a integ_alg sha1-96 integ_key 43306856544c78337076306d456a373476346679  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1001 crypto_alg aes-cbc-128 crypto_key 5154416d36415657303463723174697a integ_alg sha1-96 integ_key 43306856544c78337076306d456a373476346679  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 5 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 2001:cdba:3::2 laddr_stop 2001:cdba:3::2 raddr_start 2001:cdba:3::1 raddr_stop 2001:cdba:3::1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 2001:cdba:3::2 laddr_stop 2001:cdba:3::2 raddr_start 2001:cdba:3::1 raddr_stop 2001:cdba:3::1  |br|  |preout|  |
+---------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6ipsectptlispgpe-ip6base-func
''''''''''''''''''''''''''''''''''''''''

**IPv6 - ip6-ipsec-lispgpe-ip6 - main fib, vrf (gpe_vni-to-vrf), phy2lisp, virt2lisp**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv6-IPSec-LISPGPE-IPv6-ICMPv6,  

 - **[Cfg] DUT configuration:** Each DUT is configured with LISP and IPsec. IPsec is in transport mode. Tests cases are for IPsec configured both on RLOC interface or lisp_gpe0 interface.  

 - **[Ver] TG verification:** Packet is send from TG(if1) across the DUT1 to DUT2 where it is forwarded to TG(if2).  

 - **[Ref] Applicable standard specifications:** RFC6830, RFC4303.

+------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                       | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
+============================================================================================================+===============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv6 bidirectionally over LISP GPE tunnel using IPsec (transport) on RLOC Int.   |  |prein| **DUT1:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:1::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:1::2 mac fa:16:3e:4f:67:30 |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::2 mac fa:16:3e:74:cf:d6 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 2001:cdba:1::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 2001:cdba:2::0/64 seid 2001:cdba:1::0/64 rloc 2001:cdba:3::2 |br| lisp_add_del_adjacency add vni 0 reid 2001:cdba:2::0/64 leid 2001:cdba:1::0/64 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 5a55716e6850434b78616b6f74664b78 integ_alg sha1-96 integ_key 544d58334b53485964474d4f5438455362496437  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 5a55716e6850434b78616b6f74664b78 integ_alg sha1-96 integ_key 544d58334b53485964474d4f5438455362496437  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 3 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 2001:cdba:3::1 laddr_stop 2001:cdba:3::1 raddr_start 2001:cdba:3::2 raddr_stop 2001:cdba:3::2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 2001:cdba:3::1 laddr_stop 2001:cdba:3::1 raddr_start 2001:cdba:3::2 raddr_stop 2001:cdba:3::2  |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::2/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:2::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:2::2 mac fa:16:3e:61:8c:24 |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::1 mac fa:16:3e:71:45:bf |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 2001:cdba:2::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 2001:cdba:1::0/64 seid 2001:cdba:2::0/64 rloc 2001:cdba:3::1 |br| lisp_add_del_adjacency add vni 0 reid 2001:cdba:1::0/64 leid 2001:cdba:2::0/64 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1000 crypto_alg aes-cbc-128 crypto_key 5a55716e6850434b78616b6f74664b78 integ_alg sha1-96 integ_key 544d58334b53485964474d4f5438455362496437  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1001 crypto_alg aes-cbc-128 crypto_key 5a55716e6850434b78616b6f74664b78 integ_alg sha1-96 integ_key 544d58334b53485964474d4f5438455362496437  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 3 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 2001:cdba:3::2 laddr_stop 2001:cdba:3::2 raddr_start 2001:cdba:3::1 raddr_stop 2001:cdba:3::1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 2001:cdba:3::2 laddr_stop 2001:cdba:3::2 raddr_start 2001:cdba:3::1 raddr_stop 2001:cdba:3::1  |br|  |preout|                         |
+------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT1 and DUT2 route IPv6 bidirectionally over LISP GPE tunnel using IPsec (transport) lisp_gpe0 Int. |  |prein| **DUT1:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:1::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:1::2 mac fa:16:3e:4f:67:30 |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::2 mac fa:16:3e:74:cf:d6 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 2001:cdba:1::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 2001:cdba:2::0/64 seid 2001:cdba:1::0/64 rloc 2001:cdba:3::2 |br| lisp_add_del_adjacency add vni 0 reid 2001:cdba:2::0/64 leid 2001:cdba:1::0/64 |br| sw_interface_dump |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 397562446d665866494377636c6d4333 integ_alg sha1-96 integ_key 36735255314d6c5342434750515a6f31386a6a77  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 397562446d665866494377636c6d4333 integ_alg sha1-96 integ_key 36735255314d6c5342434750515a6f31386a6a77  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 5 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 2001:cdba:1::2 laddr_stop 2001:cdba:1::2 raddr_start 2001:cdba:2::2 raddr_stop 2001:cdba:2::2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 2001:cdba:1::2 laddr_stop 2001:cdba:1::2 raddr_start 2001:cdba:2::2 raddr_stop 2001:cdba:2::2  |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::2/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:2::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:2::2 mac fa:16:3e:61:8c:24 |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::1 mac fa:16:3e:71:45:bf |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 2001:cdba:2::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 2001:cdba:1::0/64 seid 2001:cdba:2::0/64 rloc 2001:cdba:3::1 |br| lisp_add_del_adjacency add vni 0 reid 2001:cdba:1::0/64 leid 2001:cdba:2::0/64 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1000 crypto_alg aes-cbc-128 crypto_key 397562446d665866494377636c6d4333 integ_alg sha1-96 integ_key 36735255314d6c5342434750515a6f31386a6a77  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1001 crypto_alg aes-cbc-128 crypto_key 397562446d665866494377636c6d4333 integ_alg sha1-96 integ_key 36735255314d6c5342434750515a6f31386a6a77  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 5 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 2001:cdba:2::2 laddr_stop 2001:cdba:2::2 raddr_start 2001:cdba:1::2 raddr_stop 2001:cdba:1::2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 2001:cdba:2::2 laddr_stop 2001:cdba:2::2 raddr_start 2001:cdba:1::2 raddr_stop 2001:cdba:1::2  |br|  |preout|  |
+------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

ip4 tunnels
```````````



softwire
''''''''



eth2p-ethip4--ethip6ip4-ip4base--ip6base-swirelw46-func
.......................................................

**Lightweight 4 over 6 test cases**  LW4o6 is a subset of MAP-E, with per-subscriber rules. It uses the same tunneling mechanism and configuration as MAP-E. It does not use embedded address bits.   

 - **[Top] Network Topologies:** TG=DUT1 2-node topology with two links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-UDP on TG_if1-DUT, Eth-IPv6-IPv4-UDP on TG_if2_DUT.  

 - **[Cfg] DUT configuration:** DUT1 is configured as lwAFTR.  

 - **[Ver] TG verification:** Test UDP ICMP Echo Request in IPv4 are sent to lwAFTR and are verified by TG for correctness their encapsulation in IPv6 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC7596 RFC7597.

+----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                             | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+==================================================================================+====================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: Encapsulate IPv4 into IPv6. IPv6 dst depends on IPv4 and UDP destination   |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 10.0.0.1/24 |br| sw_interface_add_del_address sw_if_index 1 2001:0::1/64 |br| ip_neighbor_add_del sw_if_index 1 dst 2001:0::2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 2001:1::2/128 via 2001:0::2  sw_if_index 1  count 1    |br| map_add_domain ip4-pfx 20.0.0.1/32 ip6-pfx 2001:1::/64 ip6-src 2001:1::1 ea-bits-len 0 psid-offset 6 psid-len 8  |br| map_add_del_rule index 0 psid 52 dst 2001:1::2  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                       |
+----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: Encapsulate IPv4 ICMP into IPv6. IPv6 dst depends on IPv4 addr and ICMP ID |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 10.0.0.1/24 |br| sw_interface_add_del_address sw_if_index 1 2001:0::1/64 |br| ip_neighbor_add_del sw_if_index 1 dst 2001:0::2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 2001:1::2/128 via 2001:0::2  sw_if_index 1  count 1    |br| map_add_domain ip4-pfx 20.0.0.1/32 ip6-pfx 2001:1::/64 ip6-src 2001:1::1 ea-bits-len 0 psid-offset 6 psid-len 8  |br| map_add_del_rule index 0 psid 52 dst 2001:1::2  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                       |
+----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: Decapsulate IPv4 UDP from IPv6.                                            |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 10.0.0.1/24 |br| sw_interface_add_del_address sw_if_index 1 2001:0::1/64 |br| ip_neighbor_add_del sw_if_index 2 dst 10.0.0.100 mac fa:16:3e:13:a0:c9 |br| map_add_domain ip4-pfx 20.0.0.1/32 ip6-pfx 2001:1::/64 ip6-src 2001:1::1 ea-bits-len 0 psid-offset 6 psid-len 8  |br| map_add_del_rule index 0 psid 52 dst 2001:1::2  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                   |
+----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC04: Hairpinning of traffic between two lwB4                                    |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 10.0.0.1/24 |br| sw_interface_add_del_address sw_if_index 1 2001:0::1/64 |br| ip_neighbor_add_del sw_if_index 1 dst 2001:0::2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 2001:1::3/128 via 2001:0::2  sw_if_index 1  count 1    |br| map_add_domain ip4-pfx 20.0.0.1/32 ip6-pfx 2001:1::/64 ip6-src 2001:1::1 ea-bits-len 0 psid-offset 6 psid-len 8  |br| map_add_del_rule index 0 psid 52 dst 2001:1::2  |br| map_add_del_rule index 0 psid 22 dst 2001:1::3  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+----------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4--ethip6ip4-ip4base--ip6base-swiremape-func
.......................................................

**Test for Basic mapping rule for MAP-E**  

 - **[Top] Network Topologies:** TG - DUT1 - TG with two links between the nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-UDP on TG-to-DUT-if1. Eth-IPv6-IPv4-UDP on TG-to-DUT-if2.  

 - **[Cfg] DUT configuration:** DUT is configured with IPv4 on one DUT-to-TG interface and IPv6 address on second DUT-to-TG interface. MAP-E domain is configured in test template based on test parameters.  

 - **[Ver] TG verification:** UDP packets in IPv4 are sent by TG to destination in MAP domain. IPv6 packets with encapsulated IPv4 are received on TG interface.  

 - **[Ref] Applicable standard specifications:** RFC7597.

+----------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                             | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+==================================================================================+=======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: BMR, then an IPv4 prefix is assigned                                       |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 10.0.0.1/24 |br| sw_interface_add_del_address sw_if_index 1 2001:0::1/64 |br| ip_add_del_route ::/0 via 2001:0::2  sw_if_index 1      |br| ip_neighbor_add_del sw_if_index 1 dst 2001:0::2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 1.0.0.1/32 via 10.0.0.2  sw_if_index 2      |br| ip_neighbor_add_del sw_if_index 2 dst 10.0.0.2 mac fa:16:3e:13:a0:c9 |br| map_add_domain ip4-pfx 20.0.0.0/8 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 4 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.0.0.0/8 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 8 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.0.0.0/8 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 10 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.0.0.0/8 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 16 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.0.0.0/8 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 20 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.0.0.0/8 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 23 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.0/24 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 4 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.0/24 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 7 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
+----------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: BMR, full IPv4 address is to be assigned                                   |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 10.0.0.1/24 |br| sw_interface_add_del_address sw_if_index 1 2001:0::1/64 |br| ip_add_del_route ::/0 via 2001:0::2  sw_if_index 1      |br| ip_neighbor_add_del sw_if_index 1 dst 2001:0::2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 1.0.0.1/32 via 10.0.0.2  sw_if_index 2      |br| ip_neighbor_add_del sw_if_index 2 dst 10.0.0.2 mac fa:16:3e:13:a0:c9 |br| map_add_domain ip4-pfx 20.0.0.0/8 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 24 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.160.0.0/12 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 20 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.0.0/16 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 16 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.200.0/22 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 10 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.0/24 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 8 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.208/28 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 4 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.219/32 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 0 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.0.0.0/8 ip6-pfx 2001:db8::/40 ip6-src 2001:db8:ffff::1 ea-bits-len 24 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.160.0.0/12 ip6-pfx 2001:db8::/44 ip6-src 2001:db8:ffff::1 ea-bits-len 20 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.0.0/16 ip6-pfx 2001:db8::/48 ip6-src 2001:db8:ffff::1 ea-bits-len 16 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.200.0/22 ip6-pfx 2001:db8::/54 ip6-src 2001:db8:ffff::1 ea-bits-len 10 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+----------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: BMR, shared IPv4 address is to be assigned                                 |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 10.0.0.1/24 |br| sw_interface_add_del_address sw_if_index 1 2001:0::1/64 |br| ip_add_del_route ::/0 via 2001:0::2  sw_if_index 1      |br| ip_neighbor_add_del sw_if_index 1 dst 2001:0::2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 1.0.0.1/32 via 10.0.0.2  sw_if_index 2      |br| ip_neighbor_add_del sw_if_index 2 dst 10.0.0.2 mac fa:16:3e:13:a0:c9 |br| map_add_domain ip4-pfx 20.0.0.0/8 ip6-pfx 2001::/16 ip6-src 2001:db8:ffff::1 ea-bits-len 48 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.0.0/16 ip6-pfx 2001::/16 ip6-src 2001:db8:ffff::1 ea-bits-len 48 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.0/24 ip6-pfx 2001::/16 ip6-src 2001:db8:ffff::1 ea-bits-len 48 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.219/32 ip6-pfx 2001::/16 ip6-src 2001:db8:ffff::1 ea-bits-len 48 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.0.0.0/8 ip6-pfx 2001::/24 ip6-src 2001:db8:ffff::1 ea-bits-len 40 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.0.0/16 ip6-pfx 2001::/24 ip6-src 2001:db8:ffff::1 ea-bits-len 40 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.0/24 ip6-pfx 2001::/24 ip6-src 2001:db8:ffff::1 ea-bits-len 40 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.219/32 ip6-pfx 2001::/24 ip6-src 2001:db8:ffff::1 ea-bits-len 40 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.0.0/16 ip6-pfx 2001::/16 ip6-src 2001:db8:ffff::1 ea-bits-len 40 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.219/32 ip6-pfx 2001::/16 ip6-src 2001:db8:ffff::1 ea-bits-len 40 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.0.0.0/8 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 32 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.0.0/16 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 32 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.0/24 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 32 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.219/32 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 32 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.0.0/16 ip6-pfx 2001::/24 ip6-src 2001:db8:ffff::1 ea-bits-len 32 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.0/24 ip6-pfx 2001::/24 ip6-src 2001:db8:ffff::1 ea-bits-len 32 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.0.0/16 ip6-pfx 2001::/16 ip6-src 2001:db8:ffff::1 ea-bits-len 32 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.0/24 ip6-pfx 2001::/16 ip6-src 2001:db8:ffff::1 ea-bits-len 32 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.160.0.0/12 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 25 psid-offset 6 psid-len 5  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.0.0/16 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 25 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.0/24 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 25 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.219/32 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 25 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.192.0/20 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 17 psid-offset 6 psid-len 5  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.0/24 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 17 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.219/32 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 17 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.0/24 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 12 psid-offset 6 psid-len 4  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.219/32 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 12 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+----------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC04: End user IPv6 prefix is 64                                                 |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 10.0.0.1/24 |br| sw_interface_add_del_address sw_if_index 1 2001:0::1/64 |br| ip_add_del_route ::/0 via 2001:0::2  sw_if_index 1      |br| ip_neighbor_add_del sw_if_index 1 dst 2001:0::2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 1.0.0.1/32 via 10.0.0.2  sw_if_index 2      |br| ip_neighbor_add_del sw_if_index 2 dst 10.0.0.2 mac fa:16:3e:13:a0:c9 |br| map_add_domain ip4-pfx 20.0.0.0/8 ip6-pfx 2001:db8:0012:3400::/56 ip6-src 2001:db8:ffff::1 ea-bits-len 8 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.208/28 ip6-pfx 2001:db8:0012:3400::/56 ip6-src 2001:db8:ffff::1 ea-bits-len 8 psid-offset 5 psid-len 4  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.0.0.0/8 ip6-pfx 2001:db8:0012:3400::/64 ip6-src 2001:db8:ffff::1 ea-bits-len 0 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.219/32 ip6-pfx 2001:db8:0012:3400::/64 ip6-src 2001:db8:ffff::1 ea-bits-len 0 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
+----------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC05: IPv4 prefix is 0                                                           |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 10.0.0.1/24 |br| sw_interface_add_del_address sw_if_index 1 2001:0::1/64 |br| ip_add_del_route ::/0 via 2001:0::2  sw_if_index 1      |br| ip_neighbor_add_del sw_if_index 1 dst 2001:0::2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 1.0.0.1/32 via 10.0.0.2  sw_if_index 2      |br| ip_neighbor_add_del sw_if_index 2 dst 10.0.0.2 mac fa:16:3e:13:a0:c9 |br| map_add_domain ip4-pfx 0.0.0.0/0 ip6-pfx 2001:db8:0000::/40 ip6-src 2001:db8:ffff::1 ea-bits-len 8 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 0.0.0.0/0 ip6-pfx 2001:db8:0000::/40 ip6-src 2001:db8:ffff::1 ea-bits-len 16 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 0.0.0.0/0 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 32 psid-offset 0 psid-len 0  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 0.0.0.0/0 ip6-pfx 2001:d00::/24 ip6-src 2001:db8:ffff::1 ea-bits-len 40 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 0.0.0.0/0 ip6-pfx 2001::/16 ip6-src 2001:db8:ffff::1 ea-bits-len 40 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC06: Multiple domain and check with traffic script IPv4 source IPv6 destination |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 10.0.0.1/24 |br| sw_interface_add_del_address sw_if_index 1 2001:0::1/64 |br| ip_add_del_route ::/0 via 2001:0::2  sw_if_index 1      |br| ip_neighbor_add_del sw_if_index 1 dst 2001:0::2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 0.0.0.0/0 via 10.0.0.2  sw_if_index 2      |br| ip_neighbor_add_del sw_if_index 2 dst 10.0.0.2 mac fa:16:3e:13:a0:c9 |br| map_add_domain ip4-pfx 97.70.0.0/16 ip6-pfx 2001:6146::/48 ip6-src 2001:ffff::1 ea-bits-len 16 psid-offset 0 psid-len 0  |br| map_add_domain ip4-pfx 74.126.0.0/16 ip6-pfx 2001:4a7e::/48 ip6-src 2001:ffff::1 ea-bits-len 16 psid-offset 0 psid-len 0  |br| map_add_domain ip4-pfx 5.14.0.0/16 ip6-pfx 2001:5e::/48 ip6-src 2001:ffff::1 ea-bits-len 16 psid-offset 0 psid-len 0  |br| map_add_domain ip4-pfx 15.137.0.0/16 ip6-pfx 2001:f89::/48 ip6-src 2001:ffff::1 ea-bits-len 16 psid-offset 0 psid-len 0  |br| map_add_domain ip4-pfx 204.185.0.0/16 ip6-pfx 2001:ccb9::/48 ip6-src 2001:ffff::1 ea-bits-len 16 psid-offset 0 psid-len 0  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
+----------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC07: Multiple domain and check with traffic script IPv6 source IPv6 destination |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 10.0.0.1/24 |br| sw_interface_add_del_address sw_if_index 1 2001:0::1/64 |br| ip_add_del_route ::/0 via 2001:0::2  sw_if_index 1      |br| ip_neighbor_add_del sw_if_index 1 dst 2001:0::2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 0.0.0.0/0 via 10.0.0.2  sw_if_index 2      |br| ip_neighbor_add_del sw_if_index 2 dst 10.0.0.2 mac fa:16:3e:13:a0:c9 |br| map_add_domain ip4-pfx 97.70.0.0/16 ip6-pfx 2001:6146::/48 ip6-src 2001:ffff::1 ea-bits-len 16 psid-offset 0 psid-len 0  |br| map_add_domain ip4-pfx 74.126.0.0/16 ip6-pfx 2001:4a7e::/48 ip6-src 2001:ffff::1 ea-bits-len 16 psid-offset 0 psid-len 0  |br| map_add_domain ip4-pfx 5.14.0.0/16 ip6-pfx 2001:5e::/48 ip6-src 2001:ffff::1 ea-bits-len 16 psid-offset 0 psid-len 0  |br| map_add_domain ip4-pfx 15.137.0.0/16 ip6-pfx 2001:f89::/48 ip6-src 2001:ffff::1 ea-bits-len 16 psid-offset 0 psid-len 0  |br| map_add_domain ip4-pfx 204.185.0.0/16 ip6-pfx 2001:ccb9::/48 ip6-src 2001:ffff::1 ea-bits-len 16 psid-offset 0 psid-len 0  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
+----------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC08: Encapsulate IPv4 ICMP into IPv6                                            |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 10.0.0.1/24 |br| sw_interface_add_del_address sw_if_index 1 2001:0::1/64 |br| ip_add_del_route ::/0 via 2001:0::2  sw_if_index 1      |br| ip_neighbor_add_del sw_if_index 1 dst 2001:0::2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 0.0.0.0/0 via 10.0.0.2  sw_if_index 2      |br| ip_neighbor_add_del sw_if_index 2 dst 10.0.0.2 mac fa:16:3e:13:a0:c9 |br| map_add_domain ip4-pfx 97.70.0.0/16 ip6-pfx 2001:6146::/48 ip6-src 2001:ffff::1 ea-bits-len 16 psid-offset 0 psid-len 0  |br| map_add_domain ip4-pfx 74.126.0.0/16 ip6-pfx 2001:4a7e::/48 ip6-src 2001:ffff::1 ea-bits-len 16 psid-offset 0 psid-len 0  |br| map_add_domain ip4-pfx 5.14.0.0/16 ip6-pfx 2001:5e::/48 ip6-src 2001:ffff::1 ea-bits-len 16 psid-offset 0 psid-len 0  |br| map_add_domain ip4-pfx 15.137.0.0/16 ip6-pfx 2001:f89::/48 ip6-src 2001:ffff::1 ea-bits-len 16 psid-offset 0 psid-len 0  |br| map_add_domain ip4-pfx 204.185.0.0/16 ip6-pfx 2001:ccb9::/48 ip6-src 2001:ffff::1 ea-bits-len 16 psid-offset 0 psid-len 0  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
+----------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC09: Repeated ip neighbor command doesnt put FIB to broken state                |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 10.0.0.1/24 |br| sw_interface_add_del_address sw_if_index 1 2001:0::1/64 |br| ip_add_del_route 2001::/16 via 2001:0::2  sw_if_index 1      |br| ip_neighbor_add_del sw_if_index 1 dst 2001:0::2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 0.0.0.0/0 via 10.0.0.2  sw_if_index 2      |br| ip_neighbor_add_del sw_if_index 2 dst 10.0.0.2 mac fa:16:3e:13:a0:c9 |br| map_add_domain ip4-pfx 20.0.0.0/8 ip6-pfx 2001::/16 ip6-src 2001:db8:ffff::1 ea-bits-len 48 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br| sw_interface_add_del_address sw_if_index 2 10.0.0.1/24 |br| sw_interface_add_del_address sw_if_index 1 2001:0::1/64 |br| ip_add_del_route 2001::/16 via 2001:0::2  sw_if_index 1      |br| ip_neighbor_add_del sw_if_index 1 dst 2001:0::2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 0.0.0.0/0 via 10.0.0.2  sw_if_index 2      |br| ip_neighbor_add_del sw_if_index 2 dst 10.0.0.2 mac fa:16:3e:13:a0:c9 |br| map_add_domain ip4-pfx 20.0.0.0/8 ip6-pfx 2001::/16 ip6-src 2001:db8:ffff::1 ea-bits-len 48 psid-offset 6 psid-len 8  |br| map_del_domain index 0 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
+----------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Bug: VPP-318                                                                     |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 10.0.0.1/24 |br| sw_interface_add_del_address sw_if_index 1 2001:0::1/64 |br| map_add_domain ip4-pfx 20.169.0.0/16 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::1 ea-bits-len 20 psid-offset 6 psid-len 8  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
+----------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4--ethip6ip4-ip4base--ip6base-swiremapt-func
.......................................................

**Test for Basic mapping rule for MAP-T**  

 - **[Top] Network Topologies:** TG - DUT1 - TG with two links between the nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-UDP on TG-to-DUT-if1. Eth-IPv6-UDP on TG-to-DUT-if2.  

 - **[Cfg] DUT configuration:** DUT is configured with IPv4 on one DUT-to-TG interface and IPv6 address on second DUT-to-TG interface. MAP-T domain is configured in test template based on test parameters.  

 - **[Ver] TG verification:** UDP packets in IPv4 are sent by TG to destination in MAP domain. IPv6 packets with translated IPv4 addresses are received on TG interface.  

 - **[Ref] Applicable standard specifications:** RFC7599

+------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name             | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
+==================+==========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: MAP-T test |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 10.0.0.1/24 |br| sw_interface_add_del_address sw_if_index 1 2001:0::1/64 |br| ip_add_del_route ::/0 via 2001:0::2  sw_if_index 1      |br| ip_neighbor_add_del sw_if_index 1 dst 2001:0::2 mac fa:16:3e:4f:67:30 |br| ip_add_del_route 0.0.0.0/0 via 10.0.0.2  sw_if_index 2      |br| ip_neighbor_add_del sw_if_index 2 dst 10.0.0.2 mac fa:16:3e:13:a0:c9 |br| map_add_domain ip4-pfx 20.169.0.0/16 ip6-pfx 2001::/16 ip6-src 2001:db8:ffff::/96 ea-bits-len 40 psid-offset 0 psid-len 0 map-t |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.169.201.219/32 ip6-pfx 2001:db8::/32 ip6-src 2001:db8:ffff::/96 ea-bits-len 0 psid-offset 0 psid-len 0 map-t |br| map_del_domain index 0 |br| map_add_domain ip4-pfx 20.0.0.0/8 ip6-pfx 2001:db8::/40 ip6-src 2001:db8:ffff::/96 ea-bits-len 24 psid-offset 0 psid-len 0 map-t |br| map_del_domain index 0 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

vxlan
'''''



eth2p-dot1qip4vxlan-l2bdbasemaclrn-func
.......................................

**RFC7348 VXLAN: Bridge-domain with VXLAN over VLAN test cases**   

 - **[Top] Network topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet encapsulations:** Eth-dot1q-IPv4-VXLAN-Eth-IPv4-ICMPv4 on DUT1-DUT2, Eth-dot1q-IPv4-ICMPv4 on TG-DUTn for L2 switching of IPv4.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with L2 bridge-domain (L2BD) switching combined with static MACs, MAC learning enabled and Split Horizon Groups (SHG) depending on test case; VXLAN tunnels are configured between L2BDs on DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC7348.

+------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                     | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+==========================================================================================+=======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 with L2BD and VXLANoIPv4oVLAN tunnels switch ICMPv4 between TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vlan_subif sw_if_index 3 vlan 10 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 5 172.16.0.1/24 |br| ip_neighbor_add_del sw_if_index 5 dst 172.16.0.2 mac fa:16:3e:74:cf:d6 |br| vxlan_add_del_tunnel src 172.16.0.1 dst 172.16.0.2 vni 23 |br| sw_interface_set_flags sw_if_index 6 admin-up |br| bridge_domain_add_del bd_id 23 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 23 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 23 shg 0  enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vlan_subif sw_if_index 3 vlan 10 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_dump |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 5 172.16.0.2/24 |br| ip_neighbor_add_del sw_if_index 5 dst 172.16.0.1 mac fa:16:3e:71:45:bf |br| vxlan_add_del_tunnel src 172.16.0.2 dst 172.16.0.1 vni 23 |br| sw_interface_set_flags sw_if_index 6 admin-up |br| bridge_domain_add_del bd_id 23 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 23 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 23 shg 0  enable |br|  |preout|  |
+------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4vxlan-l2bdbasemaclrn-func
.....................................

**Bridge-domain with VXLAN test cases - IPv4**   

 - **[Top] Network topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet encapsulations:** Eth-IPv4-VXLAN-Eth-IPv4-ICMPv4 on DUT1-DUT2, Eth-IPv4-ICMPv4 on TG-DUTn for L2 switching of IPv4.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with L2 bridge-domain (L2BD) switching combined with MAC learning enabled; VXLAN tunnels are configured between L2BDs on DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC7348.

+-------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
+=====================================================================================+===============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 with L2BD and VXLANoIPv4 tunnels switch ICMPv4 between TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 172.16.0.1/24 |br| ip_neighbor_add_del sw_if_index 3 dst 172.16.0.2 mac fa:16:3e:74:cf:d6 |br| vxlan_add_del_tunnel src 172.16.0.1 dst 172.16.0.2 vni 23 |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 10 shg 0  enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 172.16.0.2/24 |br| ip_neighbor_add_del sw_if_index 3 dst 172.16.0.1 mac fa:16:3e:71:45:bf |br| vxlan_add_del_tunnel src 172.16.0.2 dst 172.16.0.1 vni 23 |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 10 shg 0  enable |br|  |preout|  |
+-------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4vxlan-l2xcbase-func
...............................

**RFC7348 VXLAN: L2 cross-connect with VXLAN test cases**   

 - **[Top] Network topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet encapsulations:** Eth-IPv4-VXLAN-Eth-IPv4-ICMPv4 on DUT1-DUT2, Eth-IPv4-ICMPv4 on TG-DUTn for L2 switching of IPv4.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with L2 cross-connect (L2XC) switching; VXLAN tunnels are configured between L2XCs on DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC7348.

+-------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
+=====================================================================================+===============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 with L2XC and VXLANoIPv4 tunnels switch ICMPv4 between TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 172.16.0.1/24 |br| ip_neighbor_add_del sw_if_index 3 dst 172.16.0.2 mac fa:16:3e:74:cf:d6 |br| vxlan_add_del_tunnel src 172.16.0.1 dst 172.16.0.2 vni 24 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 1 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 172.16.0.2/24 |br| ip_neighbor_add_del sw_if_index 3 dst 172.16.0.1 mac fa:16:3e:71:45:bf |br| vxlan_add_del_tunnel src 172.16.0.2 dst 172.16.0.1 vni 24 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 1 |br|  |preout|  |
+-------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth4p-ethip4vxlan-l2bdbasemaclrn-l2shg-func
...........................................

**L2BD with SHG combined with VXLAN test cases - IPv4**   

 - **[Top] Network topologies:** TG=DUT1=DUT2=TG 3-node circular topology with double parallel links.  

 - **[Enc] Packet encapsulations:** Eth-IPv4-VXLAN-Eth-IPv4-ICMPv4 on DUT1-DUT2, Eth-IPv4-ICMPv4 on TG-DUTn for L2 switching of IPv4.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with L2 bridge-domain (L2BD) switching combined with MAC learning enabled and Split Horizon Groups (SHG); VXLAN tunnels are configured between L2BDs on DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC7348.

+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                  | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
+=======================================================================================================+===============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 with L2BD and VXLANoIPv4 tunnels in SHG switch ICMPv4 between TG links            |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 172.16.0.1/24 |br| vxlan_add_del_tunnel src 172.16.0.1 dst 172.16.0.2 vni 23 |br| vxlan_add_del_tunnel src 172.16.0.1 dst 172.16.0.2 vni 35 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_dump |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_l2_bridge sw_if_index 2 bd_id 10 shg 0 enable |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 10 shg 1 enable |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 10 shg 1 enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 172.16.0.2/24 |br| vxlan_add_del_tunnel src 172.16.0.2 dst 172.16.0.1 vni 23 |br| vxlan_add_del_tunnel src 172.16.0.2 dst 172.16.0.1 vni 35 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_dump |br| bridge_domain_add_del bd_id 20 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_l2_bridge sw_if_index 2 bd_id 20 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 20 shg 0 enable |br| bridge_domain_add_del bd_id 30 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 30 shg 0 enable |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 30 shg 0 enable |br|  |preout|  |
+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC01: DUT1 and DUT2 with L2BD and VXLANoIPv4 tunnels in different SHGs switch ICMPv4 between TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 172.16.0.1/24 |br| vxlan_add_del_tunnel src 172.16.0.1 dst 172.16.0.2 vni 23 |br| vxlan_add_del_tunnel src 172.16.0.1 dst 172.16.0.2 vni 35 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_dump |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_l2_bridge sw_if_index 2 bd_id 10 shg 0 enable |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 10 shg 1 enable |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 10 shg 2 enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 172.16.0.2/24 |br| vxlan_add_del_tunnel src 172.16.0.2 dst 172.16.0.1 vni 23 |br| vxlan_add_del_tunnel src 172.16.0.2 dst 172.16.0.1 vni 35 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_dump |br| bridge_domain_add_del bd_id 20 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_l2_bridge sw_if_index 2 bd_id 20 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 20 shg 0 enable |br| bridge_domain_add_del bd_id 30 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 30 shg 0 enable |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 30 shg 0 enable |br|  |preout|  |
+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

telemetry
`````````



eth2p-ethip4-ip4base-ip4ipfixbase-func
''''''''''''''''''''''''''''''''''''''

**IPFIX ipv4 test cases**  IPFIX tests use 3-node topology TG - DUT1 - DUT2 - TG with one link between the nodes. DUT1 is configured with IPv4 routing and static routes. IPFIX is configured on DUT1 with DUT1->TG interface as collector. Test packets are sent from TG to DUT1. TG listens for flow report packets and verifies that they contains flow record of test packets sent.

+---------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                      | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+===========================================================================+===================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT sends IPFIX template and data packets                           |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.1.2 mac fa:16:3e:4f:67:30 |br| classify_add_del_table mask l3 ip4 src |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 1 match l3 ip4 src 192.168.1.2 |br| flow_classify_set_interface sw_if_index 1 ip4-table 0  |br| set_ipfix_exporter collector_address 192.168.1.2 src_address 192.168.1.1   template_interval 5 |br| set_ipfix_classify_stream domain 1  |br| ipfix_classify_table_add_del table 0 ip4 add |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|                                                                               |
+---------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT reports packet flow for traffic by source address               |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.1.2 mac fa:16:3e:4f:67:30 |br| classify_add_del_table mask l3 ip4 src |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 1 match l3 ip4 src 192.168.1.2 |br| flow_classify_set_interface sw_if_index 1 ip4-table 0  |br| set_ipfix_exporter collector_address 192.168.1.2 src_address 192.168.1.1   template_interval 5 |br| set_ipfix_classify_stream domain 1  |br| ipfix_classify_table_add_del table 0 ip4 add |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|                                                                               |
+---------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: DUT reports packet flow for traffic with local destination address  |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.1.2 mac fa:16:3e:4f:67:30 |br| classify_add_del_table mask l3 ip4 dst |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 dst 192.168.1.1 |br| flow_classify_set_interface sw_if_index 1 ip4-table 0  |br| set_ipfix_exporter collector_address 192.168.1.2 src_address 192.168.1.1   template_interval 5 |br| set_ipfix_classify_stream domain 1  |br| ipfix_classify_table_add_del table 0 ip4 add |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|                                                                               |
+---------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC04: DUT reports packet flow for traffic with remote destination address |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.1.2 mac fa:16:3e:4f:67:30 |br| ip_neighbor_add_del sw_if_index 3 dst 192.168.2.1 mac fa:16:3e:74:cf:d6 |br| classify_add_del_table mask l3 ip4 dst |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 dst 192.168.2.1 |br| flow_classify_set_interface sw_if_index 1 ip4-table 0  |br| set_ipfix_exporter collector_address 192.168.1.2 src_address 192.168.1.1   template_interval 5 |br| set_ipfix_classify_stream domain 1  |br| ipfix_classify_table_add_del table 0 ip4 add |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|  |
+---------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC05: DUT reports packet flow for traffic by source and destination port  |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.1.2 mac fa:16:3e:4f:67:30 |br| classify_add_del_table mask l3 ip4 src proto l4 src_port dst_port |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 80 dst_port 80 |br| flow_classify_set_interface sw_if_index 1 ip4-table 0  |br| set_ipfix_exporter collector_address 192.168.1.2 src_address 192.168.1.1   template_interval 5 |br| set_ipfix_classify_stream domain 1  |br| ipfix_classify_table_add_del table 0 ip4 add |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|                 |
+---------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4-ip4base-ip4ipfixscale-func
'''''''''''''''''''''''''''''''''''''''

**IPFIX ipv4 test cases**  IPFIX tests use 3-node topology TG - DUT1 - DUT2 - TG with one link between the nodes. DUT1 is configured with IPv4 routing and static routes. IPFIX is configured on DUT1 with DUT1->TG interface as collector. Test packets are sent from TG to DUT1. TG listens for flow report packets and verifies that they contains flow record of test packets sent.

+---------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
+=====================================================================+==========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT reports packet flow with a large number of packets        |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.1.2 mac fa:16:3e:4f:67:30 |br| classify_add_del_table mask l3 ip4 src |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 1 match l3 ip4 src 192.168.1.2 |br| flow_classify_set_interface sw_if_index 1 ip4-table 0  |br| set_ipfix_exporter collector_address 192.168.1.2 src_address 192.168.1.1   template_interval 5 |br| set_ipfix_classify_stream domain 1  |br| ipfix_classify_table_add_del table 0 ip4 add |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
+---------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT reports packet flow when multiple sessions are configured |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.1.2 mac fa:16:3e:4f:67:30 |br| classify_add_del_table mask l3 ip4 src proto l4 src_port dst_port |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 0 dst_port 0 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 1 dst_port 1 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 2 dst_port 2 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 3 dst_port 3 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 4 dst_port 4 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 5 dst_port 5 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 6 dst_port 6 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 7 dst_port 7 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 8 dst_port 8 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 9 dst_port 9 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 10 dst_port 10 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 11 dst_port 11 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 12 dst_port 12 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 13 dst_port 13 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 14 dst_port 14 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 15 dst_port 15 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 16 dst_port 16 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 17 dst_port 17 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 18 dst_port 18 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 19 dst_port 19 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 20 dst_port 20 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 21 dst_port 21 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 22 dst_port 22 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 23 dst_port 23 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 24 dst_port 24 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 25 dst_port 25 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 26 dst_port 26 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 27 dst_port 27 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 28 dst_port 28 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 29 dst_port 29 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 30 dst_port 30 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 31 dst_port 31 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 32 dst_port 32 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 33 dst_port 33 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 34 dst_port 34 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 35 dst_port 35 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 36 dst_port 36 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 37 dst_port 37 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 38 dst_port 38 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 39 dst_port 39 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 40 dst_port 40 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 41 dst_port 41 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 42 dst_port 42 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 43 dst_port 43 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 44 dst_port 44 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 45 dst_port 45 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 46 dst_port 46 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 47 dst_port 47 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 48 dst_port 48 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 49 dst_port 49 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 50 dst_port 50 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 51 dst_port 51 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 52 dst_port 52 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 53 dst_port 53 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 54 dst_port 54 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 55 dst_port 55 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 56 dst_port 56 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 57 dst_port 57 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 58 dst_port 58 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 59 dst_port 59 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 60 dst_port 60 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 61 dst_port 61 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 62 dst_port 62 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 63 dst_port 63 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 64 dst_port 64 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 65 dst_port 65 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 66 dst_port 66 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 67 dst_port 67 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 68 dst_port 68 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 69 dst_port 69 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 70 dst_port 70 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 71 dst_port 71 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 72 dst_port 72 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 73 dst_port 73 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 74 dst_port 74 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 75 dst_port 75 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 76 dst_port 76 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 77 dst_port 77 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 78 dst_port 78 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip4 src 192.168.1.2 proto 6 l4 src_port 79 dst_port 79 |br| flow_classify_set_interface sw_if_index 1 ip4-table 0  |br| set_ipfix_exporter collector_address 192.168.1.2 src_address 192.168.1.1  path_mtu 1450 template_interval 5 |br| set_ipfix_classify_stream domain 1  |br| ipfix_classify_table_add_del table 0 ip4 add |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|  |
+---------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4-ip4base-spanrx-func
''''''''''''''''''''''''''''''''

**SPAN test suite**  

 - **[Top] Network Topologies:** TG=DUT1 2-node topology with two links between nodes.  

 - **[Cfg] DUT configuration:** DUT1 is configured with SPAN mirroring from the first DUT1-TG interface to the second one.  

 - **[Ver] TG verification:** Test ARP or ICMP packets are sent by TG on first link to DUT1; On receipt through second link TG verifies the copy of packet sent and the copy of DUT's reply packet.  

 - **[Ref] Applicable standard specifications: None?**

+--------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                         | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                       |
+==============================================================+=========================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT mirrors L2 packets from one interface to another   |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 192.168.1.2/24 |br| sw_interface_span_enable_disable src_sw_if_index 2 dst_sw_if_index 1 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                               |
+--------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT mirrors IPv4 packets from one interface to another |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 192.168.1.2/24 |br| ip_neighbor_add_del sw_if_index 2 dst 192.168.1.1 mac fa:16:3e:13:a0:c9 |br| sw_interface_span_enable_disable src_sw_if_index 2 dst_sw_if_index 1 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+--------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6-ip6base-ip6ipfixbase-func
''''''''''''''''''''''''''''''''''''''

**IPFIX ipv6 test cases**  IPFIX tests use 3-node topology TG - DUT1 - DUT2 - TG with one link between the nodes. DUT1 is configured with IPv4 and IPV6 routing and static routes. IPFIX is configured on DUT1 with DUT1->TG interface as collector.Test packets are sent from TG to or through DUT1. TG listens for flow report packets and verifies that they contains flow records of test packets sent.

+---------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                      | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+===========================================================================+====================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT reports packet flow for traffic by source address               |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 10::10/64 |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.1.2 mac fa:16:3e:4f:67:30 |br| ip_neighbor_add_del sw_if_index 1 dst 12::10 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| classify_add_del_table mask l3 ip6 src |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip6 src 12::10 |br| flow_classify_set_interface sw_if_index 1 ip6-table 0  |br| set_ipfix_exporter collector_address 192.168.1.2 src_address 192.168.1.1   template_interval 5 |br| set_ipfix_classify_stream domain 1  |br| ipfix_classify_table_add_del table 0 ip6 add |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|                                                                          |
+---------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT reports packet flow for traffic with local destination address  |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 10::10/64 |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.1.2 mac fa:16:3e:4f:67:30 |br| ip_neighbor_add_del sw_if_index 1 dst 12::10 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| classify_add_del_table mask l3 ip6 dst |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 2 match_n 2 match l3 ip6 dst 10::10 |br| flow_classify_set_interface sw_if_index 1 ip6-table 0  |br| set_ipfix_exporter collector_address 192.168.1.2 src_address 192.168.1.1   template_interval 5 |br| set_ipfix_classify_stream domain 1  |br| ipfix_classify_table_add_del table 0 ip6 add |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|                                                                          |
+---------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: DUT reports packet flow for traffic with remote destination address |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 10::10/64 |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.1.2 mac fa:16:3e:4f:67:30 |br| ip_neighbor_add_del sw_if_index 1 dst 12::10 mac fa:16:3e:4f:67:30 |br| ip_neighbor_add_del sw_if_index 3 dst 11::10 mac fa:16:3e:74:cf:d6 |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| classify_add_del_table mask l3 ip6 dst |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 2 match_n 2 match l3 ip6 dst 11::10 |br| flow_classify_set_interface sw_if_index 1 ip6-table 0  |br| set_ipfix_exporter collector_address 192.168.1.2 src_address 192.168.1.1   template_interval 5 |br| set_ipfix_classify_stream domain 1  |br| ipfix_classify_table_add_del table 0 ip6 add |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|  |
+---------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC04: DUT reports packet flow for traffic by source and destination port  |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 10::10/64 |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.1.2 mac fa:16:3e:4f:67:30 |br| ip_neighbor_add_del sw_if_index 1 dst 12::10 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| classify_add_del_table mask l3 ip6 src proto l4 src_port dst_port |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 80 dst_port 80 |br| flow_classify_set_interface sw_if_index 1 ip6-table 0  |br| set_ipfix_exporter collector_address 192.168.1.2 src_address 192.168.1.1   template_interval 5 |br| set_ipfix_classify_stream domain 1  |br| ipfix_classify_table_add_del table 0 ip6 add |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|            |
+---------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6-ip6base-ip6ipfixscale-func
'''''''''''''''''''''''''''''''''''''''

**IPFIX ipv6 test cases**  IPFIX tests use 3-node topology TG - DUT1 - DUT2 - TG with one link between the nodes. DUT1 is configured with IPv4 and IPV6 routing and static routes. IPFIX is configured on DUT1 with DUT1->TG interface as collector.Test packets are sent from TG to or through DUT1. TG listens for flow report packets and verifies that they contains flow records of test packets sent.

+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+=====================================================================+===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT reports packet flow with a large number of packets        |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 10::10/64 |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.1.2 mac fa:16:3e:4f:67:30 |br| ip_neighbor_add_del sw_if_index 1 dst 12::10 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| classify_add_del_table mask l3 ip6 src |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 2 match l3 ip6 src 12::10 |br| flow_classify_set_interface sw_if_index 1 ip6-table 0  |br| set_ipfix_exporter collector_address 192.168.1.2 src_address 192.168.1.1   template_interval 5 |br| set_ipfix_classify_stream domain 1  |br| ipfix_classify_table_add_del table 0 ip6 add |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT reports packet flow when multiple sessions are configured |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 10::10/64 |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.1.2 mac fa:16:3e:4f:67:30 |br| ip_neighbor_add_del sw_if_index 1 dst 12::10 mac fa:16:3e:4f:67:30 |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| classify_add_del_table mask l3 ip6 src proto l4 src_port dst_port |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 0 dst_port 0 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 1 dst_port 1 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 2 dst_port 2 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 3 dst_port 3 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 4 dst_port 4 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 5 dst_port 5 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 6 dst_port 6 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 7 dst_port 7 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 8 dst_port 8 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 9 dst_port 9 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 10 dst_port 10 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 11 dst_port 11 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 12 dst_port 12 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 13 dst_port 13 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 14 dst_port 14 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 15 dst_port 15 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 16 dst_port 16 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 17 dst_port 17 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 18 dst_port 18 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 19 dst_port 19 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 20 dst_port 20 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 21 dst_port 21 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 22 dst_port 22 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 23 dst_port 23 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 24 dst_port 24 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 25 dst_port 25 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 26 dst_port 26 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 27 dst_port 27 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 28 dst_port 28 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 29 dst_port 29 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 30 dst_port 30 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 31 dst_port 31 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 32 dst_port 32 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 33 dst_port 33 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 34 dst_port 34 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 35 dst_port 35 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 36 dst_port 36 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 37 dst_port 37 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 38 dst_port 38 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 39 dst_port 39 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 40 dst_port 40 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 41 dst_port 41 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 42 dst_port 42 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 43 dst_port 43 |br| classify_add_del_session acl-hit-next permit table-index 0 skip_n 1 match_n 3 match l3 ip6 src 12::10 proto 6 l4 src_port 44 dst_port 44 |br| flow_classify_set_interface sw_if_index 1 ip6-table 0  |br| set_ipfix_exporter collector_address 192.168.1.2 src_address 192.168.1.1  path_mtu 1450 template_interval 5 |br| set_ipfix_classify_stream domain 1  |br| ipfix_classify_table_add_del table 0 ip6 add |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|  |
+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6-ip6base-spanrx-func
''''''''''''''''''''''''''''''''

**SPAN test suite**  

 - **[Top] Network Topologies:** TG=DUT1 2-node topology with two links between nodes.  

 - **[Cfg] DUT configuration:** DUT1 is configured with SPAN mirroring from the first DUT1-TG interface to the second one.  

 - **[Ver] TG verification:** Test ARP or ICMP packets are sent by TG on first link to DUT1; On receipt through second link TG verifies the copy of packet sent and the copy of DUT's reply packet.  

 - **[Ref] Applicable standard specifications: None?**

+--------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                         | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
+==============================================================+================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT mirrors IPv6 packets from one interface to another |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_add_del_address sw_if_index 2 10::1/24 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| ip_neighbor_add_del sw_if_index 2 dst 11::1 mac fa:16:3e:13:a0:c9 |br| ip_add_del_route 11::1/24 via 10::1  sw_if_index 2 resolve-attempts 10 count 1    |br| sw_interface_span_enable_disable src_sw_if_index 2 dst_sw_if_index 1 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+--------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

ip4
```



eth2p-dot1q-ip4base-func
''''''''''''''''''''''''

**IPv4 with VLAN subinterfaces**   

 - **[Top] Network Topologies:** TG-DUT1-TG 2-node circular topology with double links between nodes.  

 - **[Enc] Packet encapsulations:** Eth-IPv4-ICMPv4 on TG-DUT1-IF1, Eth-dot1q-IPv4-ICMPv4 on TG-DUT1-IF2.  

 - **[Cfg] DUT configuration:** DUT1 is configured with 2 Vlan subinterfaces on DUT1-IF2. The subinterfaces and DUT1-IF1 have IP addresses set and corresponding IP neighbor entries are configured.  

 - **[Ref] Applicable standard specifications:** IEEE 802.1q.

+------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                               | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+====================================+===================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: Process untagged send tagged |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| create_vlan_subif sw_if_index 1 vlan 10 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| create_vlan_subif sw_if_index 1 vlan 20 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_add_del_address sw_if_index 2 192.168.0.1/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.100.1/24 |br| sw_interface_add_del_address sw_if_index 6 192.168.200.1/24 |br| ip_neighbor_add_del sw_if_index 2 dst 192.168.0.2 mac fa:16:3e:ec:18:84 |br| ip_neighbor_add_del sw_if_index 5 dst 192.168.100.2 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 6 dst 192.168.200.2 mac fa:16:3e:87:a4:72 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: Process tagged send untagged |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| create_vlan_subif sw_if_index 1 vlan 10 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| create_vlan_subif sw_if_index 1 vlan 20 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_add_del_address sw_if_index 2 192.168.0.1/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.100.1/24 |br| sw_interface_add_del_address sw_if_index 6 192.168.200.1/24 |br| ip_neighbor_add_del sw_if_index 2 dst 192.168.0.2 mac fa:16:3e:ec:18:84 |br| ip_neighbor_add_del sw_if_index 5 dst 192.168.100.2 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 6 dst 192.168.200.2 mac fa:16:3e:87:a4:72 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: Process tagged send tagged   |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| create_vlan_subif sw_if_index 1 vlan 10 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| create_vlan_subif sw_if_index 1 vlan 20 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_add_del_address sw_if_index 2 192.168.0.1/24 |br| sw_interface_add_del_address sw_if_index 5 192.168.100.1/24 |br| sw_interface_add_del_address sw_if_index 6 192.168.200.1/24 |br| ip_neighbor_add_del sw_if_index 2 dst 192.168.0.2 mac fa:16:3e:ec:18:84 |br| ip_neighbor_add_del sw_if_index 5 dst 192.168.100.2 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 6 dst 192.168.200.2 mac fa:16:3e:87:a4:72 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4-ip4base-copblklistbase-func
''''''''''''''''''''''''''''''''''''''''

**COP Security IPv4 Blacklist Tests**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-ICMPv4 on all links.  

 - **[Cfg] DUT configuration:** DUT1 is configured with IPv4 routing and static routes. COP security black-lists are applied on DUT1 ingress interface from TG. DUT2 is configured with L2XC.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent in one direction by TG on link to DUT1; on receive TG verifies packets for correctness and drops as applicable.  

 - **[Ref] Applicable standard specifications:**

+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
+=====================================================================+===============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT drops IPv4 pkts with COP blacklist set with IPv4 src-addr |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 3 192.168.2.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.1.2 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 3 dst 192.168.2.2 mac fa:16:3e:44:bb:1f |br| ip_add_del_route 32.0.0.1/24 via 192.168.2.2  sw_if_index 3 resolve-attempts 10 count 1    |br| ip_add_del_route 16.0.0.0/24 drop vrf 1 create-vrf |br| cop_whitelist_enable_disable sw_if_index 1 ip4 fib-id 1 |br| cop_interface_enable_disable sw_if_index 1  |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br|  |preout|  |
+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4-ip4base-copwhlistbase-func
'''''''''''''''''''''''''''''''''''''''

**COP Security IPv4 Whitelist Tests**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-ICMPv4 on all links.  

 - **[Cfg] DUT configuration:** DUT1 is configured with IPv4 routing and static routes. COP security white-lists are applied on DUT1 ingress interface from TG. DUT2 is configured with L2XC.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent in one direction by TG on link to DUT1; on receive TG verifies packets for correctness and drops as applicable.  

 - **[Ref] Applicable standard specifications:**

+-----------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                  | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
+=======================================================================+================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT permits IPv4 pkts with COP whitelist set with IPv4 src-addr |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 3 192.168.2.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.1.2 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 3 dst 192.168.2.2 mac fa:16:3e:44:bb:1f |br| ip_add_del_route 32.0.0.1/24 via 192.168.2.2  sw_if_index 3 resolve-attempts 10 count 1    |br| ip_add_del_route 16.0.0.0/24 local vrf 1 create-vrf |br| cop_whitelist_enable_disable sw_if_index 1 ip4 fib-id 1 |br| cop_interface_enable_disable sw_if_index 1  |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br|  |preout|  |
+-----------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4-ip4base-func
'''''''''''''''''''''''''

**IPv4 routing test cases**  RFC791 IPv4, RFC826 ARP, RFC792 ICMPv4. Encapsulations: Eth-IPv4-ICMPv4 on links TG-DUT1, TG-DUT2, DUT1-DUT2. IPv4 routing tests use circular 3-node topology TG - DUT1 - DUT2 - TG with one link between the nodes. DUT1 and DUT2 are configured with IPv4 routing and static routes. Test ICMPv4 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2 and received on TG links on the other side of circular topology. On receive TG verifies packets IPv4 src-addr, dst-addr and MAC addresses.

+----------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+
| Name                                                                 | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                 |
+======================================================================+===================================================================================================================+
| TC01: DUT replies to ICMPv4 Echo Req to its ingress interface        |  |prein| **DUT1:** |br| no VAT command executed |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+----------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+
| TC02: DUT routes IPv4 to its egress interface                        |  |prein| **DUT1:** |br| no VAT command executed |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+----------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+
| TC03: DUT1 routes IPv4 to DUT2 ingress interface                     |  |prein| **DUT1:** |br| no VAT command executed |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+----------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+
| TC04: DUT1 routes IPv4 to DUT2 egress interface                      |  |prein| **DUT1:** |br| no VAT command executed |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+----------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+
| TC05: DUT1 and DUT2 route IPv4 between TG interfaces                 |  |prein| **DUT1:** |br| no VAT command executed |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+----------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+
| TC06: DUT replies to ICMPv4 Echo Reqs with size 64B-to-1500B-incr-1B |  |prein| **DUT1:** |br| no VAT command executed |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+----------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+
| TC08: DUT replies to ARP request                                     |  |prein| **DUT1:** |br| no VAT command executed |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+----------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4-ip4base-iaclbase-func
''''''''''''''''''''''''''''''''''

**IPv4 routing with ingress ACL test cases**  Encapsulations: Eth-IPv4 on links TG-DUT1, TG-DUT2, DUT1-DUT2. IPv4 ingress ACL (iACL) tests use 3-node topology TG - DUT1 - DUT2 - TG with one link between the nodes. DUT1 and DUT2 are configured with IPv4 routing and static routes. DUT1 is configured with iACL on link to TG, iACL classification and permit/deny action are configured on a per test case basis. Test ICMPv4 Echo Request packets are sent in one direction by TG on link to DUT1 and received on TG link to DUT2. On receive TG verifies if packets are dropped, or if received verifies packet IPv4 src-addr, dst-addr and MAC addresses.

+--------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                     | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
+==========================================================================+========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT with iACL IPv4 src-addr drops matching pkts                    |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 3 192.168.2.1/24 |br| ip_neighbor_add_del sw_if_index 3 dst 192.168.2.2 mac fa:16:3e:44:bb:1f |br| ip_add_del_route 32.0.0.1/24 via 192.168.2.2  sw_if_index 3 resolve-attempts 10 count 1    |br| classify_add_del_table mask l3 ip4 src |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 1 match_n 1 match l3 ip4 src 16.0.0.1 |br| input_acl_set_interface sw_if_index 1 ip4-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br|  |preout|                                                                                                                                                                                                                                                                                                                |
+--------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT with iACL IPv4 dst-addr drops matching pkts                    |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 3 192.168.2.1/24 |br| ip_neighbor_add_del sw_if_index 3 dst 192.168.2.2 mac fa:16:3e:44:bb:1f |br| ip_add_del_route 32.0.0.1/24 via 192.168.2.2  sw_if_index 3 resolve-attempts 10 count 1    |br| ip_add_del_route 33.0.0.1/24 via 192.168.2.2  sw_if_index 3 resolve-attempts 10 count 1    |br| classify_add_del_table mask l3 ip4 dst |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 1 match_n 2 match l3 ip4 dst 32.0.0.1 |br| input_acl_set_interface sw_if_index 1 ip4-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br|  |preout|                                                                                                                                                                                                                |
+--------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: DUT with iACL IPv4 src-addr and dst-addr drops matching pkts       |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 3 192.168.2.1/24 |br| ip_neighbor_add_del sw_if_index 3 dst 192.168.2.2 mac fa:16:3e:44:bb:1f |br| ip_add_del_route 32.0.0.1/24 via 192.168.2.2  sw_if_index 3 resolve-attempts 10 count 1    |br| ip_add_del_route 33.0.0.1/24 via 192.168.2.2  sw_if_index 3 resolve-attempts 10 count 1    |br| classify_add_del_table mask l3 ip4 src |br| classify_add_del_table mask l3 ip4 dst |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 1 match_n 2 match l3 ip4 src 16.0.0.1 |br| classify_add_del_session acl-hit-next deny table-index 1 skip_n 1 match_n 2 match l3 ip4 dst 32.0.0.1 |br| input_acl_set_interface sw_if_index 1 ip4-table 0 |br| input_acl_set_interface sw_if_index 1 ip4-table 1 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br|  |preout|  |
+--------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC04: DUT with iACL IPv4 protocol set to TCP drops matching pkts         |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 3 192.168.2.1/24 |br| ip_neighbor_add_del sw_if_index 3 dst 192.168.2.2 mac fa:16:3e:44:bb:1f |br| ip_add_del_route 32.0.0.1/24 via 192.168.2.2  sw_if_index 3 resolve-attempts 10 count 1    |br| classify_add_del_table mask hex 0000000000000000000000000000000000000000000000FF |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 1 match_n 1 match hex 000000000000000000000000000000000000000000000006 |br| input_acl_set_interface sw_if_index 1 ip4-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br|  |preout|                                                                                                                                                                                                                                     |
+--------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC05: DUT with iACL IPv4 protocol set to UDP drops matching pkts         |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 3 192.168.2.1/24 |br| ip_neighbor_add_del sw_if_index 3 dst 192.168.2.2 mac fa:16:3e:44:bb:1f |br| ip_add_del_route 32.0.0.1/24 via 192.168.2.2  sw_if_index 3 resolve-attempts 10 count 1    |br| classify_add_del_table mask hex 0000000000000000000000000000000000000000000000FF |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 1 match_n 1 match hex 000000000000000000000000000000000000000000000011 |br| input_acl_set_interface sw_if_index 1 ip4-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br|  |preout|                                                                                                                                                                                                                                     |
+--------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC06: DUT with iACL IPv4 TCP src-ports drops matching pkts               |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 3 192.168.2.1/24 |br| ip_neighbor_add_del sw_if_index 3 dst 192.168.2.2 mac fa:16:3e:44:bb:1f |br| ip_add_del_route 32.0.0.1/24 via 192.168.2.2  sw_if_index 3 resolve-attempts 10 count 1    |br| classify_add_del_table mask hex 00000000000000000000000000000000000000000000000000000000000000000000FFFF0000 |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 2 match_n 1 match hex 0000000000000000000000000000000000000000000000000000000000000000000000500000 |br| input_acl_set_interface sw_if_index 1 ip4-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br|  |preout|                                                                                                                                                                             |
+--------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC07: DUT with iACL IPv4 TCP dst-ports drops matching pkts               |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 3 192.168.2.1/24 |br| ip_neighbor_add_del sw_if_index 3 dst 192.168.2.2 mac fa:16:3e:44:bb:1f |br| ip_add_del_route 32.0.0.1/24 via 192.168.2.2  sw_if_index 3 resolve-attempts 10 count 1    |br| classify_add_del_table mask hex 000000000000000000000000000000000000000000000000000000000000000000000000FFFF |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 2 match_n 1 match hex 0000000000000000000000000000000000000000000000000000000000000000000000000050 |br| input_acl_set_interface sw_if_index 1 ip4-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br|  |preout|                                                                                                                                                                             |
+--------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC08: DUT with iACL IPv4 TCP src-ports and dst-ports drops matching pkts |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 3 192.168.2.1/24 |br| ip_neighbor_add_del sw_if_index 3 dst 192.168.2.2 mac fa:16:3e:44:bb:1f |br| ip_add_del_route 32.0.0.1/24 via 192.168.2.2  sw_if_index 3 resolve-attempts 10 count 1    |br| classify_add_del_table mask hex 00000000000000000000000000000000000000000000000000000000000000000000FFFFFFFF |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 2 match_n 1 match hex 0000000000000000000000000000000000000000000000000000000000000000000000500014 |br| input_acl_set_interface sw_if_index 1 ip4-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br|  |preout|                                                                                                                                                                             |
+--------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC09: DUT with iACL IPv4 UDP src-ports drops matching pkts               |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 3 192.168.2.1/24 |br| ip_neighbor_add_del sw_if_index 3 dst 192.168.2.2 mac fa:16:3e:44:bb:1f |br| ip_add_del_route 32.0.0.1/24 via 192.168.2.2  sw_if_index 3 resolve-attempts 10 count 1    |br| classify_add_del_table mask hex 00000000000000000000000000000000000000000000000000000000000000000000FFFF0000 |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 2 match_n 1 match hex 0000000000000000000000000000000000000000000000000000000000000000000000500000 |br| input_acl_set_interface sw_if_index 1 ip4-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br|  |preout|                                                                                                                                                                             |
+--------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC10: DUT with iACL IPv4 UDP dst-ports drops matching pkts               |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 3 192.168.2.1/24 |br| ip_neighbor_add_del sw_if_index 3 dst 192.168.2.2 mac fa:16:3e:44:bb:1f |br| ip_add_del_route 32.0.0.1/24 via 192.168.2.2  sw_if_index 3 resolve-attempts 10 count 1    |br| classify_add_del_table mask hex 000000000000000000000000000000000000000000000000000000000000000000000000FFFF |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 2 match_n 1 match hex 0000000000000000000000000000000000000000000000000000000000000000000000000050 |br| input_acl_set_interface sw_if_index 1 ip4-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br|  |preout|                                                                                                                                                                             |
+--------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC11: DUT with iACL IPv4 UDP src-ports and dst-ports drops matching pkts |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 3 192.168.2.1/24 |br| ip_neighbor_add_del sw_if_index 3 dst 192.168.2.2 mac fa:16:3e:44:bb:1f |br| ip_add_del_route 32.0.0.1/24 via 192.168.2.2  sw_if_index 3 resolve-attempts 10 count 1    |br| classify_add_del_table mask hex 00000000000000000000000000000000000000000000000000000000000000000000FFFFFFFF |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 2 match_n 1 match hex 0000000000000000000000000000000000000000000000000000000000000000000000500014 |br| input_acl_set_interface sw_if_index 1 ip4-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br|  |preout|                                                                                                                                                                             |
+--------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4-ip4base-ip4arp-func
''''''''''''''''''''''''''''''''

**IPv4 ARP test cases**  RFC826 ARP: Eth-IPv4 and Eth-ARP on links TG-DUT1, TG-DUT2, DUT1-DUT2: IPv4 ARP tests use 3-node topology TG - DUT1 - DUT2 - TG with one link between the nodes. DUT1 and DUT2 are configured with IPv4 routing and static routes. DUT ARP functionality is tested by making TG send ICMPv4 Echo Requests towards its other interface via DUT1 and DUT2.

+---------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                      | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+===========================================================================+============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT sends ARP Request for unresolved locally connected IPv4 address |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 3 192.168.2.1/24 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br|  |preout|                                                                               |
+---------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT sends ARP Request for route next hop IPv4 address               |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 3 192.168.2.1/24 |br| ip_add_del_route 32.0.0.1/24 via 192.168.2.2  sw_if_index 3  count 1    |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br|  |preout|  |
+---------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4-ip4base-ip4dhcpclient-func
'''''''''''''''''''''''''''''''''''''''

**DHCPv4 Client related test cases**

+------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                             | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                   |
+==================================================================+=====================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: VPP sends a DHCP DISCOVER                                  |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| dhcp_client_config sw_if_index 2  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                             |
+------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: VPP sends a DHCPv4 DISCOVER with hostname                  |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| dhcp_client_config sw_if_index 2 hostname dhcp-client |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                         |
+------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: VPP sends DHCPv4 REQUEST after OFFER                       |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| ip_add_del_route 255.255.255.255/32   local  count 1    |br| dhcp_client_config sw_if_index 2  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                |
+------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC04: VPP doesn't send DHCPv4 REQUEST after OFFER with wrong XID |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| ip_add_del_route 255.255.255.255/32   local  count 1    |br| dhcp_client_config sw_if_index 2  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                |
+------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC05: VPP honors DHCPv4 lease time                               |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| ip_add_del_route 255.255.255.255/32   local  count 1    |br| dhcp_client_config sw_if_index 2  |br| ip_neighbor_add_del sw_if_index 2 dst 192.168.23.1 mac fa:16:3e:ec:18:84 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4-ip4base-ip4dhcpproxy-func
''''''''''''''''''''''''''''''''''''''

**DHCPv4 proxy test cases**   

 - **[Top] Network Topologies:** TG = DUT with two links between the nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-UDP-BOOTP-DHCP  

 - **[Cfg] DUT configuration:** DUT is configured with DHCPv4 proxy.  

 - **[Ver] TG verification:** Test DHCPv4 packets are sent on TG on first link to DUT and received on TG on second link. On receive TG verifies if DHCPv4 packets are valid.

+---------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                    | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+=========================================================+====================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: VPP proxies valid DHCPv4 request to DHCPv4 server |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| ip_add_del_route 255.255.255.255/32   local  count 1    |br| sw_interface_add_del_address sw_if_index 2 172.16.0.1/24 |br| sw_interface_add_del_address sw_if_index 1 192.168.0.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.0.100 mac fa:16:3e:87:a4:72 |br| dhcp_proxy_config svr 192.168.0.100 src 172.16.0.1 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+---------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: VPP proxy ignores invalid DHCPv4 request          |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| ip_add_del_route 255.255.255.255/32   local  count 1    |br| sw_interface_add_del_address sw_if_index 2 172.16.0.1/24 |br| sw_interface_add_del_address sw_if_index 1 192.168.0.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.0.100 mac fa:16:3e:87:a4:72 |br| dhcp_proxy_config svr 192.168.0.100 src 172.16.0.1 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+---------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4-ip4base-ip4ecmp-func
'''''''''''''''''''''''''''''''''

**Ipv4 Multipath routing test cases**   

 - **[Top] Network topologies:** TG=DUT 2-node topology with two links between nodes.  

 - **[Cfg] DUT configuration:** On DUT configure interfaces IPv4 adresses, and multipath routing.  

 - **[Ver] TG verification:** Test packets are sent from TG on the first link to DUT. Packet is received on TG on the second link from DUT1.

+-----------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                    | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+=========================================+===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: IPv4 Equal-cost multipath routing |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 2 192.168.2.1/24 |br| ip_neighbor_add_del sw_if_index 2 dst 192.168.2.10 mac 02:00:00:00:00:02 |br| ip_neighbor_add_del sw_if_index 2 dst 192.168.2.20 mac 02:00:00:00:00:03 |br| ip_add_del_route 32.0.0.1/24 via 192.168.2.10  sw_if_index 2  count 1  multipath  |br| ip_add_del_route 32.0.0.1/24 via 192.168.2.20  sw_if_index 2  count 1  multipath  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+-----------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4-ip4base-ip4proxyarp-func
'''''''''''''''''''''''''''''''''''''

**RFC1027 Proxy ARP test cases**   

 - **[Top] Network topologies:** TG-DUT1 2-node topology with single link between nodes.  

 - **[Cfg] DUT configuration:** DUT1 is configured with Proxy ARP  

 - **[Ver] TG verification:** Test ARP Request packet is sent from TG on link to DUT1; on receive TG verifies ARP reply packet for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC1027.

+-------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                      | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                               |
+===========================================================================================+=================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT sends ARP reply on behalf of another machine from the IP range                  |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 10.0.0.1/24 |br| proxy_arp_add_del 192.168.1.2 - 192.168.1.10 |br| sw_interface_dump |br| proxy_arp_intfc_enable_disable sw_if_index 1 enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|  |
+-------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT sends ARP reply on behalf of another machine from beginning of the IP range     |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 10.0.0.1/24 |br| proxy_arp_add_del 192.168.1.2 - 192.168.1.10 |br| sw_interface_dump |br| proxy_arp_intfc_enable_disable sw_if_index 1 enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|  |
+-------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: DUT sends ARP reply on behalf of another machine from end of the IP range           |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 10.0.0.1/24 |br| proxy_arp_add_del 192.168.1.2 - 192.168.1.10 |br| sw_interface_dump |br| proxy_arp_intfc_enable_disable sw_if_index 1 enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|  |
+-------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC04: DUT does not send ARP reply on behalf of another machine from below of the IP range |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 10.0.0.1/24 |br| proxy_arp_add_del 192.168.1.2 - 192.168.1.10 |br| sw_interface_dump |br| proxy_arp_intfc_enable_disable sw_if_index 1 enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|  |
+-------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC05: DUT does not send ARP reply on behalf of another machine from above of the IP range |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 10.0.0.1/24 |br| proxy_arp_add_del 192.168.1.2 - 192.168.1.10 |br| sw_interface_dump |br| proxy_arp_intfc_enable_disable sw_if_index 1 enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|  |
+-------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4-ip4base-ipolicemarkbase-func
'''''''''''''''''''''''''''''''''''''''''

**IPv4 policer test cases**   

 - **[Top] Network topologies:** TG=DUT1 2-node topology with two links between nodes.  

 - **[Cfg] DUT configuration:** On DUT1 configure interfaces IPv4 adresses, and static ARP record on the second interface.  

 - **[Ver] TG verification:** Test packet is sent from TG on the first link to DUT1. Packet is received on TG on the second link from DUT1.  

 - **[Ref] Applicable standard specifications:** RFC2474, RFC2697, RFC2698.

+-------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                            | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+=================================================+===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: VPP policer 2R3C Color-aware marks packet |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 192.168.122.1/24 |br| sw_interface_add_del_address sw_if_index 1 192.168.123.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.123.2 mac fa:16:3e:87:a4:72 |br| policer_add_del name policer1  cir 100 eir 150 cb 200 eb 300 rate_type pps round_type closest type 2r3c-2698 conform_action transmit exceed_action mark-and-transmit AF22 violate_action drop color-aware |br| classify_add_del_table mask l3 ip4 src |br| classify_add_del_session policer-hit-next 0 exceed-color table-index 0 skip_n 1 match_n 1 match l3 ip4 src 192.168.122.2 |br| policer_classify_set_interface sw_if_index 2 ip4-table 0 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+-------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: VPP policer 2R3C Color-blind marks packet |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 192.168.122.1/24 |br| sw_interface_add_del_address sw_if_index 1 192.168.123.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.123.2 mac fa:16:3e:87:a4:72 |br| policer_add_del name policer1  cir 100 eir 150 cb 200 eb 300 rate_type pps round_type closest type 2r3c-2698 conform_action mark-and-transmit AF22 exceed_action transmit violate_action drop  |br| classify_add_del_table mask l3 ip4 src |br| classify_add_del_session policer-hit-next 0 conform-color table-index 0 skip_n 1 match_n 1 match l3 ip4 src 192.168.122.2 |br| policer_classify_set_interface sw_if_index 2 ip4-table 0 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|            |
+-------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: VPP policer 1R3C Color-aware marks packet |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 192.168.122.1/24 |br| sw_interface_add_del_address sw_if_index 1 192.168.123.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.123.2 mac fa:16:3e:87:a4:72 |br| policer_add_del name policer1  cir 1 eir 0 cb 2 eb 300 rate_type pps round_type closest type 1r3c conform_action transmit exceed_action mark-and-transmit AF22 violate_action drop color-aware |br| classify_add_del_table mask l3 ip4 src |br| classify_add_del_session policer-hit-next 0 exceed-color table-index 0 skip_n 1 match_n 1 match l3 ip4 src 192.168.122.2 |br| policer_classify_set_interface sw_if_index 2 ip4-table 0 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|             |
+-------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC04: VPP policer 1R3C Color-blind marks packet |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 192.168.122.1/24 |br| sw_interface_add_del_address sw_if_index 1 192.168.123.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.123.2 mac fa:16:3e:87:a4:72 |br| policer_add_del name policer1  cir 100 eir 0 cb 200 eb 300 rate_type pps round_type closest type 1r3c conform_action mark-and-transmit AF22 exceed_action transmit violate_action drop  |br| classify_add_del_table mask l3 ip4 src |br| classify_add_del_session policer-hit-next 0 conform-color table-index 0 skip_n 1 match_n 1 match l3 ip4 src 192.168.122.2 |br| policer_classify_set_interface sw_if_index 2 ip4-table 0 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                   |
+-------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4-ip4base-rpf-func
'''''''''''''''''''''''''''''

**Source RPF check on IPv4 test cases**   

 - **[Top] Network Topologies:** TG - DUT1 - DUT2 - TG with one link between the nodes.  

 - **[Cfg] DUT configuration:** DUT2 is configured with L2 Cross connect. DUT1 is configured with IP source check on link to TG,  

 - **[Ver] TG verification:** Test ICMP Echo Request packets are sent in one direction by TG on link to DUT1 and received on TG link to DUT2. On receive TG verifies if packets which source address is not in routes are dropped.

+-----------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
+=====================================================+================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: VPP source RPF check on IPv4 src-addr         |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 3 192.168.2.1/24 |br| ip_neighbor_add_del sw_if_index 3 dst 192.168.2.2 mac fa:16:3e:44:bb:1f |br| ip_add_del_route 32.0.0.1/24 via 192.168.2.2  sw_if_index 3  count 1    |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.1.2 mac fa:16:3e:87:a4:72 |br| ip_add_del_route 16.0.0.1/24 via 192.168.1.2  sw_if_index 1  count 1    |br| exec set interface ip source-check GigabitEthernet0/4/0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br|  |preout|  |
+-----------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: VPP pass traffic on non-enabled RPF interface |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 3 192.168.2.1/24 |br| ip_neighbor_add_del sw_if_index 3 dst 192.168.2.2 mac fa:16:3e:44:bb:1f |br| ip_add_del_route 32.0.0.1/24 via 192.168.2.2  sw_if_index 3  count 1    |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.1.2 mac fa:16:3e:87:a4:72 |br| ip_add_del_route 16.0.0.1/24 via 192.168.1.2  sw_if_index 1  count 1    |br| exec set interface ip source-check GigabitEthernet0/4/0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br|  |preout|  |
+-----------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4-ip4basevrf-func
''''''''''''''''''''''''''''

**Vpn routed forwarding - baseline IPv4**  

 - **[Top] Network Topologies:** TG=DUT1=DUT2=TG 3-node topology with two links in between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-ICMPv4 for L2 switching of IPv4.  

 - **[Cfg] DUT configuration:** Each DUT is configured with two VRF tables; Separation of traffic is tested by IP packets; Basic ARP and ROUTES are set on DUT nodes; IP addresses are set on DUT interfaces.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent by TG on link to DUT1, DUT2 or back to TG; On receipt TG verifies packets for correctness and their IPv4 src-addr, dst-addr, and MAC addresses.  

 - **[Ref] Applicable standard specifications:**

+----------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                         | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+==============================================================================================+=======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: TG packets routed to DUT ingress interface, VPP configured with two VRFs               |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 4 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| ip_add_del_route 30.0.0.1/24 via 20.0.0.3 sw_if_index 4 multipath vrf 9 create-vrf |br| ip_add_del_route 30.0.0.2/24 via 20.0.0.2 sw_if_index 3 multipath vrf 99 create-vrf |br| sw_interface_set_table sw_if_index 4 vrf 9  |br| sw_interface_set_table sw_if_index 3 vrf 99  |br| sw_interface_set_table sw_if_index 2 vrf 9  |br| sw_interface_set_table sw_if_index 1 vrf 99  |br| sw_interface_add_del_address sw_if_index 2 10.0.0.3/24 |br| sw_interface_add_del_address sw_if_index 1 10.0.0.4/24 |br| sw_interface_add_del_address sw_if_index 4 20.0.0.1/24 |br| sw_interface_add_del_address sw_if_index 3 20.0.0.2/24 |br| ip_neighbor_add_del sw_if_index 2 dst 10.0.0.1 mac fa:16:3e:ec:18:84 |br| ip_neighbor_add_del sw_if_index 4 dst 20.0.0.3 mac fa:16:3e:e0:33:70 |br| ip_neighbor_add_del sw_if_index 1 dst 10.0.0.2 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 3 dst 20.0.0.4 mac fa:16:3e:6e:17:58 |br| ip_add_del_route 30.0.0.1/24 via 20.0.0.3 vrf 9 sw_if_index 4 resolve-attempts 10 count 1    |br| ip_add_del_route 30.0.0.2/24 via 20.0.0.4 vrf 99 sw_if_index 3 resolve-attempts 10 count 1    |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 4 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| ip_add_del_route 10.0.0.1/24 via 20.0.0.3 sw_if_index 4 multipath vrf 9 create-vrf |br| ip_add_del_route 10.0.0.2/24 via 20.0.0.4 sw_if_index 3 multipath vrf 99 create-vrf |br| sw_interface_set_table sw_if_index 4 vrf 9  |br| sw_interface_set_table sw_if_index 3 vrf 99  |br| sw_interface_set_table sw_if_index 2 vrf 9  |br| sw_interface_set_table sw_if_index 1 vrf 99  |br| sw_interface_add_del_address sw_if_index 2 30.0.0.3/24 |br| sw_interface_add_del_address sw_if_index 1 30.0.0.4/24 |br| sw_interface_add_del_address sw_if_index 4 20.0.0.3/24 |br| sw_interface_add_del_address sw_if_index 3 20.0.0.4/24 |br| ip_neighbor_add_del sw_if_index 2 dst 30.0.0.1 mac fa:16:3e:f0:cd:6e |br| ip_neighbor_add_del sw_if_index 4 dst 20.0.0.1 mac fa:16:3e:28:28:a5 |br| ip_neighbor_add_del sw_if_index 1 dst 30.0.0.2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 20.0.0.2 mac fa:16:3e:d7:aa:2b |br| ip_add_del_route 10.0.0.1/24 via 20.0.0.1 vrf 9 sw_if_index 4 resolve-attempts 10 count 1    |br| ip_add_del_route 10.0.0.2/24 via 20.0.0.2 vrf 99 sw_if_index 3 resolve-attempts 10 count 1    |br|  |preout|  |
+----------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: TG packets routed to DUT egress interface, VPP configured with two VRFs                |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 4 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| ip_add_del_route 30.0.0.1/24 via 20.0.0.3 sw_if_index 4 multipath vrf 9 create-vrf |br| ip_add_del_route 30.0.0.2/24 via 20.0.0.2 sw_if_index 3 multipath vrf 99 create-vrf |br| sw_interface_set_table sw_if_index 4 vrf 9  |br| sw_interface_set_table sw_if_index 3 vrf 99  |br| sw_interface_set_table sw_if_index 2 vrf 9  |br| sw_interface_set_table sw_if_index 1 vrf 99  |br| sw_interface_add_del_address sw_if_index 2 10.0.0.3/24 |br| sw_interface_add_del_address sw_if_index 1 10.0.0.4/24 |br| sw_interface_add_del_address sw_if_index 4 20.0.0.1/24 |br| sw_interface_add_del_address sw_if_index 3 20.0.0.2/24 |br| ip_neighbor_add_del sw_if_index 2 dst 10.0.0.1 mac fa:16:3e:ec:18:84 |br| ip_neighbor_add_del sw_if_index 4 dst 20.0.0.3 mac fa:16:3e:e0:33:70 |br| ip_neighbor_add_del sw_if_index 1 dst 10.0.0.2 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 3 dst 20.0.0.4 mac fa:16:3e:6e:17:58 |br| ip_add_del_route 30.0.0.1/24 via 20.0.0.3 vrf 9 sw_if_index 4 resolve-attempts 10 count 1    |br| ip_add_del_route 30.0.0.2/24 via 20.0.0.4 vrf 99 sw_if_index 3 resolve-attempts 10 count 1    |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 4 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| ip_add_del_route 10.0.0.1/24 via 20.0.0.3 sw_if_index 4 multipath vrf 9 create-vrf |br| ip_add_del_route 10.0.0.2/24 via 20.0.0.4 sw_if_index 3 multipath vrf 99 create-vrf |br| sw_interface_set_table sw_if_index 4 vrf 9  |br| sw_interface_set_table sw_if_index 3 vrf 99  |br| sw_interface_set_table sw_if_index 2 vrf 9  |br| sw_interface_set_table sw_if_index 1 vrf 99  |br| sw_interface_add_del_address sw_if_index 2 30.0.0.3/24 |br| sw_interface_add_del_address sw_if_index 1 30.0.0.4/24 |br| sw_interface_add_del_address sw_if_index 4 20.0.0.3/24 |br| sw_interface_add_del_address sw_if_index 3 20.0.0.4/24 |br| ip_neighbor_add_del sw_if_index 2 dst 30.0.0.1 mac fa:16:3e:f0:cd:6e |br| ip_neighbor_add_del sw_if_index 4 dst 20.0.0.1 mac fa:16:3e:28:28:a5 |br| ip_neighbor_add_del sw_if_index 1 dst 30.0.0.2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 20.0.0.2 mac fa:16:3e:d7:aa:2b |br| ip_add_del_route 10.0.0.1/24 via 20.0.0.1 vrf 9 sw_if_index 4 resolve-attempts 10 count 1    |br| ip_add_del_route 10.0.0.2/24 via 20.0.0.2 vrf 99 sw_if_index 3 resolve-attempts 10 count 1    |br|  |preout|  |
+----------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: TG packets routed to DUT2 ingress interface through DUT1, VPP configured with two VRFs |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 4 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| ip_add_del_route 30.0.0.1/24 via 20.0.0.3 sw_if_index 4 multipath vrf 9 create-vrf |br| ip_add_del_route 30.0.0.2/24 via 20.0.0.2 sw_if_index 3 multipath vrf 99 create-vrf |br| sw_interface_set_table sw_if_index 4 vrf 9  |br| sw_interface_set_table sw_if_index 3 vrf 99  |br| sw_interface_set_table sw_if_index 2 vrf 9  |br| sw_interface_set_table sw_if_index 1 vrf 99  |br| sw_interface_add_del_address sw_if_index 2 10.0.0.3/24 |br| sw_interface_add_del_address sw_if_index 1 10.0.0.4/24 |br| sw_interface_add_del_address sw_if_index 4 20.0.0.1/24 |br| sw_interface_add_del_address sw_if_index 3 20.0.0.2/24 |br| ip_neighbor_add_del sw_if_index 2 dst 10.0.0.1 mac fa:16:3e:ec:18:84 |br| ip_neighbor_add_del sw_if_index 4 dst 20.0.0.3 mac fa:16:3e:e0:33:70 |br| ip_neighbor_add_del sw_if_index 1 dst 10.0.0.2 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 3 dst 20.0.0.4 mac fa:16:3e:6e:17:58 |br| ip_add_del_route 30.0.0.1/24 via 20.0.0.3 vrf 9 sw_if_index 4 resolve-attempts 10 count 1    |br| ip_add_del_route 30.0.0.2/24 via 20.0.0.4 vrf 99 sw_if_index 3 resolve-attempts 10 count 1    |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 4 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| ip_add_del_route 10.0.0.1/24 via 20.0.0.3 sw_if_index 4 multipath vrf 9 create-vrf |br| ip_add_del_route 10.0.0.2/24 via 20.0.0.4 sw_if_index 3 multipath vrf 99 create-vrf |br| sw_interface_set_table sw_if_index 4 vrf 9  |br| sw_interface_set_table sw_if_index 3 vrf 99  |br| sw_interface_set_table sw_if_index 2 vrf 9  |br| sw_interface_set_table sw_if_index 1 vrf 99  |br| sw_interface_add_del_address sw_if_index 2 30.0.0.3/24 |br| sw_interface_add_del_address sw_if_index 1 30.0.0.4/24 |br| sw_interface_add_del_address sw_if_index 4 20.0.0.3/24 |br| sw_interface_add_del_address sw_if_index 3 20.0.0.4/24 |br| ip_neighbor_add_del sw_if_index 2 dst 30.0.0.1 mac fa:16:3e:f0:cd:6e |br| ip_neighbor_add_del sw_if_index 4 dst 20.0.0.1 mac fa:16:3e:28:28:a5 |br| ip_neighbor_add_del sw_if_index 1 dst 30.0.0.2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 20.0.0.2 mac fa:16:3e:d7:aa:2b |br| ip_add_del_route 10.0.0.1/24 via 20.0.0.1 vrf 9 sw_if_index 4 resolve-attempts 10 count 1    |br| ip_add_del_route 10.0.0.2/24 via 20.0.0.2 vrf 99 sw_if_index 3 resolve-attempts 10 count 1    |br|  |preout|  |
+----------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC04: TG packets routed to DUT2 egress interface through DUT1, VPP configured with two VRFs  |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 4 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| ip_add_del_route 30.0.0.1/24 via 20.0.0.3 sw_if_index 4 multipath vrf 9 create-vrf |br| ip_add_del_route 30.0.0.2/24 via 20.0.0.2 sw_if_index 3 multipath vrf 99 create-vrf |br| sw_interface_set_table sw_if_index 4 vrf 9  |br| sw_interface_set_table sw_if_index 3 vrf 99  |br| sw_interface_set_table sw_if_index 2 vrf 9  |br| sw_interface_set_table sw_if_index 1 vrf 99  |br| sw_interface_add_del_address sw_if_index 2 10.0.0.3/24 |br| sw_interface_add_del_address sw_if_index 1 10.0.0.4/24 |br| sw_interface_add_del_address sw_if_index 4 20.0.0.1/24 |br| sw_interface_add_del_address sw_if_index 3 20.0.0.2/24 |br| ip_neighbor_add_del sw_if_index 2 dst 10.0.0.1 mac fa:16:3e:ec:18:84 |br| ip_neighbor_add_del sw_if_index 4 dst 20.0.0.3 mac fa:16:3e:e0:33:70 |br| ip_neighbor_add_del sw_if_index 1 dst 10.0.0.2 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 3 dst 20.0.0.4 mac fa:16:3e:6e:17:58 |br| ip_add_del_route 30.0.0.1/24 via 20.0.0.3 vrf 9 sw_if_index 4 resolve-attempts 10 count 1    |br| ip_add_del_route 30.0.0.2/24 via 20.0.0.4 vrf 99 sw_if_index 3 resolve-attempts 10 count 1    |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 4 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| ip_add_del_route 10.0.0.1/24 via 20.0.0.3 sw_if_index 4 multipath vrf 9 create-vrf |br| ip_add_del_route 10.0.0.2/24 via 20.0.0.4 sw_if_index 3 multipath vrf 99 create-vrf |br| sw_interface_set_table sw_if_index 4 vrf 9  |br| sw_interface_set_table sw_if_index 3 vrf 99  |br| sw_interface_set_table sw_if_index 2 vrf 9  |br| sw_interface_set_table sw_if_index 1 vrf 99  |br| sw_interface_add_del_address sw_if_index 2 30.0.0.3/24 |br| sw_interface_add_del_address sw_if_index 1 30.0.0.4/24 |br| sw_interface_add_del_address sw_if_index 4 20.0.0.3/24 |br| sw_interface_add_del_address sw_if_index 3 20.0.0.4/24 |br| ip_neighbor_add_del sw_if_index 2 dst 30.0.0.1 mac fa:16:3e:f0:cd:6e |br| ip_neighbor_add_del sw_if_index 4 dst 20.0.0.1 mac fa:16:3e:28:28:a5 |br| ip_neighbor_add_del sw_if_index 1 dst 30.0.0.2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 20.0.0.2 mac fa:16:3e:d7:aa:2b |br| ip_add_del_route 10.0.0.1/24 via 20.0.0.1 vrf 9 sw_if_index 4 resolve-attempts 10 count 1    |br| ip_add_del_route 10.0.0.2/24 via 20.0.0.2 vrf 99 sw_if_index 3 resolve-attempts 10 count 1    |br|  |preout|  |
+----------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC05: TG packets routed to TG through DUT1 and DUT2, VPP configured with two VRFs            |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 4 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| ip_add_del_route 30.0.0.1/24 via 20.0.0.3 sw_if_index 4 multipath vrf 9 create-vrf |br| ip_add_del_route 30.0.0.2/24 via 20.0.0.2 sw_if_index 3 multipath vrf 99 create-vrf |br| sw_interface_set_table sw_if_index 4 vrf 9  |br| sw_interface_set_table sw_if_index 3 vrf 99  |br| sw_interface_set_table sw_if_index 2 vrf 9  |br| sw_interface_set_table sw_if_index 1 vrf 99  |br| sw_interface_add_del_address sw_if_index 2 10.0.0.3/24 |br| sw_interface_add_del_address sw_if_index 1 10.0.0.4/24 |br| sw_interface_add_del_address sw_if_index 4 20.0.0.1/24 |br| sw_interface_add_del_address sw_if_index 3 20.0.0.2/24 |br| ip_neighbor_add_del sw_if_index 2 dst 10.0.0.1 mac fa:16:3e:ec:18:84 |br| ip_neighbor_add_del sw_if_index 4 dst 20.0.0.3 mac fa:16:3e:e0:33:70 |br| ip_neighbor_add_del sw_if_index 1 dst 10.0.0.2 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 3 dst 20.0.0.4 mac fa:16:3e:6e:17:58 |br| ip_add_del_route 30.0.0.1/24 via 20.0.0.3 vrf 9 sw_if_index 4 resolve-attempts 10 count 1    |br| ip_add_del_route 30.0.0.2/24 via 20.0.0.4 vrf 99 sw_if_index 3 resolve-attempts 10 count 1    |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 4 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| ip_add_del_route 10.0.0.1/24 via 20.0.0.3 sw_if_index 4 multipath vrf 9 create-vrf |br| ip_add_del_route 10.0.0.2/24 via 20.0.0.4 sw_if_index 3 multipath vrf 99 create-vrf |br| sw_interface_set_table sw_if_index 4 vrf 9  |br| sw_interface_set_table sw_if_index 3 vrf 99  |br| sw_interface_set_table sw_if_index 2 vrf 9  |br| sw_interface_set_table sw_if_index 1 vrf 99  |br| sw_interface_add_del_address sw_if_index 2 30.0.0.3/24 |br| sw_interface_add_del_address sw_if_index 1 30.0.0.4/24 |br| sw_interface_add_del_address sw_if_index 4 20.0.0.3/24 |br| sw_interface_add_del_address sw_if_index 3 20.0.0.4/24 |br| ip_neighbor_add_del sw_if_index 2 dst 30.0.0.1 mac fa:16:3e:f0:cd:6e |br| ip_neighbor_add_del sw_if_index 4 dst 20.0.0.1 mac fa:16:3e:28:28:a5 |br| ip_neighbor_add_del sw_if_index 1 dst 30.0.0.2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 20.0.0.2 mac fa:16:3e:d7:aa:2b |br| ip_add_del_route 10.0.0.1/24 via 20.0.0.1 vrf 9 sw_if_index 4 resolve-attempts 10 count 1    |br| ip_add_del_route 10.0.0.2/24 via 20.0.0.2 vrf 99 sw_if_index 3 resolve-attempts 10 count 1    |br|  |preout|  |
+----------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

ip4 tunnels
```````````



gre
'''



eth2p-ethip4gre-ip4base-func
............................

**GREoIPv4 test cases**   

 - **[Top] Network Topologies:** TG=DUT1 2-node topology with two links between nodes; TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-GRE-IPv4-ICMPv4 on DUT1-DUT2, Eth-IPv4-ICMPv4 on TG-DUTn for routing over GRE tunnel; Eth-IPv4-ICMPv4 on TG_if1-DUT, Eth-IPv4-GRE-IPv4-ICMPv4 on TG_if2_DUT for GREoIPv4 encapsulation and decapsulation verification.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with IPv4 routing and static routes. GREoIPv4 tunnel is configured between DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv4 (or ICMPv6) Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; GREoIPv4 encapsulation and decapsulation are verified separately by TG; on receive TG verifies packets for correctness and their IPv4 (IPv6) src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC2784.

+---------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                  | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+=======================================================================================+============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route over GREoIPv4 tunnel between two TG links                   |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 1 192.168.0.1/24 |br| gre_add_del_tunnel src 192.168.1.1 dst 192.168.1.2 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_add_del_address sw_if_index 5 172.16.0.1/24 |br| ip_add_del_route 192.168.2.0/24 via 172.16.0.2  sw_if_index 5 resolve-attempts 10 count 1    |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 192.168.1.2/24 |br| sw_interface_add_del_address sw_if_index 1 192.168.2.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.2.100 mac fa:16:3e:44:bb:1f |br| gre_add_del_tunnel src 192.168.1.2 dst 192.168.1.1 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_add_del_address sw_if_index 5 172.16.0.2/24 |br|  |preout|                                                                                                                                                                                            |
+---------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT encapsulates IPv4 into GREoIPv4 tunnel - GRE header verification            |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 2 192.168.0.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.1.2 mac fa:16:3e:87:a4:72 |br| gre_add_del_tunnel src 192.168.1.1 dst 192.168.1.2 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_add_del_address sw_if_index 5 172.16.0.1/24 |br| ip_add_del_route 192.168.2.0/24 via 172.16.0.2  sw_if_index 5 resolve-attempts 10 count 1    |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+---------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: DUT decapsulates IPv4 from GREoIPv4 tunnel - IPv4 header verification           |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 2 192.168.0.1/24 |br| ip_neighbor_add_del sw_if_index 2 dst 192.168.0.100 mac fa:16:3e:ec:18:84 |br| gre_add_del_tunnel src 192.168.1.1 dst 192.168.1.2 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_add_del_address sw_if_index 5 172.16.0.1/24 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+---------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC04: DUT encapsulates IPv4 into GREoIPv4 different tunnels - GRE header verification |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| create_loopback |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 2 192.168.0.1/24 |br| sw_interface_add_del_address sw_if_index 5 10.0.0.1/32 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.1.2 mac fa:16:3e:87:a4:72 |br| ip_add_del_route 10.0.0.2/32 via 192.168.1.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ip_add_del_route 10.0.0.3/32 via 192.168.1.2  sw_if_index 1 resolve-attempts 10 count 1    |br| gre_add_del_tunnel src 10.0.0.1 dst 10.0.0.2 |br| sw_interface_set_flags sw_if_index 6 admin-up |br| gre_add_del_tunnel src 10.0.0.1 dst 10.0.0.3 |br| sw_interface_set_flags sw_if_index 7 admin-up |br| sw_interface_add_del_address sw_if_index 6 172.16.0.1/24 |br| sw_interface_add_del_address sw_if_index 7 172.16.1.1/24 |br| ip_add_del_route 192.168.2.0/24 via 172.16.0.2  sw_if_index 6 resolve-attempts 10 count 1    |br| ip_add_del_route 192.168.3.0/24 via 172.16.1.2  sw_if_index 7 resolve-attempts 10 count 1    |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+---------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC05: DUT re-encapsulates IPv4 GRE into other GRE tunnel - GRE header verification    |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| create_loopback |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 2 192.168.0.1/24 |br| sw_interface_add_del_address sw_if_index 5 10.0.0.1/32 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.1.2 mac fa:16:3e:87:a4:72 |br| ip_add_del_route 10.0.0.2/32 via 192.168.1.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ip_add_del_route 10.0.0.3/32 via 192.168.1.2  sw_if_index 1 resolve-attempts 10 count 1    |br| gre_add_del_tunnel src 10.0.0.1 dst 10.0.0.2 |br| sw_interface_set_flags sw_if_index 6 admin-up |br| gre_add_del_tunnel src 10.0.0.1 dst 10.0.0.3 |br| sw_interface_set_flags sw_if_index 7 admin-up |br| sw_interface_add_del_address sw_if_index 6 172.16.0.1/24 |br| sw_interface_add_del_address sw_if_index 7 172.16.1.1/24 |br| ip_add_del_route 192.168.2.0/24 via 172.16.0.2  sw_if_index 6 resolve-attempts 10 count 1    |br| ip_add_del_route 192.168.3.0/24 via 172.16.1.2  sw_if_index 7 resolve-attempts 10 count 1    |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+---------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC06: DUT do not process GRE with wrong tunnel destination IP                         |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| create_loopback |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_add_del_address sw_if_index 1 192.168.1.1/24 |br| sw_interface_add_del_address sw_if_index 2 192.168.0.1/24 |br| sw_interface_add_del_address sw_if_index 5 10.0.0.1/32 |br| ip_neighbor_add_del sw_if_index 2 dst 192.168.0.100 mac fa:16:3e:ec:18:84 |br| ip_neighbor_add_del sw_if_index 1 dst 192.168.1.2 mac fa:16:3e:87:a4:72 |br| ip_add_del_route 10.0.0.2/32 via 192.168.1.2  sw_if_index 1 resolve-attempts 10 count 1    |br| ip_add_del_route 10.0.0.3/32 via 192.168.1.2  sw_if_index 1 resolve-attempts 10 count 1    |br| gre_add_del_tunnel src 10.0.0.1 dst 10.0.0.2 |br| sw_interface_set_flags sw_if_index 6 admin-up |br| gre_add_del_tunnel src 10.0.0.1 dst 10.0.0.3 |br| sw_interface_set_flags sw_if_index 7 admin-up |br| sw_interface_add_del_address sw_if_index 6 172.16.0.1/24 |br| sw_interface_add_del_address sw_if_index 7 172.16.1.1/24 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                       |
+---------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

lisp
''''



api-crud-lisp-func
..................

**API test cases**   

 - **[Top] Network Topologies:** DUT1 1-node topology.  

 - **[Enc] Packet Encapsulations:** None.  

 - **[Cfg] DUT configuration:** DUT1 gets configured with all LISP parameters.  

 - **[Ver] Verification:** DUT1 operational data gets verified following configuration.  

 - **[Ref] Applicable standard specifications:** RFC6830.

+--------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                   | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+========================================================+===================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT can enable and disable LISP                  |  |prein| **DUT1:** |br| lisp_enable_disable enable |br| lisp_enable_disable disable |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
+--------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT can add and delete locator_set               |  |prein| **DUT1:** |br| lisp_enable_disable enable |br| lisp_add_del_locator_set locator-set ls0 |br| lisp_add_del_locator locator-set ls0 sw_if_index 4 p 1 w 1 |br| lisp_add_del_locator locator-set ls0 sw_if_index 2 p 2 w 2 |br| lisp_add_del_locator locator-set ls0 sw_if_index 3 p 3 w 3 |br| lisp_add_del_locator locator-set ls0 sw_if_index 1 p 4 w 4 |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_locator locator-set ls1 sw_if_index 4 p 5 w 5 |br| lisp_add_del_locator locator-set ls1 sw_if_index 2 p 6 w 6 |br| lisp_add_del_locator locator-set ls1 sw_if_index 3 p 7 w 7 |br| lisp_add_del_locator locator-set ls1 sw_if_index 1 p 8 w 8 |br| lisp_add_del_locator_set locator-set ls2 |br| lisp_add_del_locator locator-set ls2 sw_if_index 4 p 9 w 9 |br| lisp_add_del_locator locator-set ls2 sw_if_index 2 p 10 w 10 |br| lisp_add_del_locator locator-set ls2 sw_if_index 3 p 11 w 11 |br| lisp_add_del_locator locator-set ls2 sw_if_index 1 p 12 w 12 |br| lisp_locator_set_dump local |br| lisp_add_del_locator locator-set ls0 sw_if_index 4 p 1 w 1 del |br| lisp_add_del_locator locator-set ls0 sw_if_index 2 p 2 w 2 del |br| lisp_add_del_locator locator-set ls0 sw_if_index 3 p 3 w 3 del |br| lisp_add_del_locator locator-set ls0 sw_if_index 1 p 4 w 4 del |br| lisp_add_del_locator_set locator-set ls0 del |br| lisp_add_del_locator locator-set ls1 sw_if_index 4 p 5 w 5 del |br| lisp_add_del_locator locator-set ls1 sw_if_index 2 p 6 w 6 del |br| lisp_add_del_locator locator-set ls1 sw_if_index 3 p 7 w 7 del |br| lisp_add_del_locator locator-set ls1 sw_if_index 1 p 8 w 8 del |br| lisp_add_del_locator_set locator-set ls1 del |br| lisp_add_del_locator locator-set ls2 sw_if_index 4 p 9 w 9 del |br| lisp_add_del_locator locator-set ls2 sw_if_index 2 p 10 w 10 del |br| lisp_add_del_locator locator-set ls2 sw_if_index 3 p 11 w 11 del |br| lisp_add_del_locator locator-set ls2 sw_if_index 1 p 12 w 12 del |br| lisp_add_del_locator_set locator-set ls2 del |br| lisp_locator_set_dump  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
+--------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: DUT can add, reset and delete locator_set        |  |prein| **DUT1:** |br| lisp_enable_disable enable |br| lisp_add_del_locator_set locator-set ls0 |br| lisp_add_del_locator locator-set ls0 sw_if_index 4 p 1 w 1 |br| lisp_add_del_locator locator-set ls0 sw_if_index 2 p 2 w 2 |br| lisp_add_del_locator locator-set ls0 sw_if_index 3 p 3 w 3 |br| lisp_add_del_locator locator-set ls0 sw_if_index 1 p 4 w 4 |br| lisp_add_del_locator_set locator-set ls0 |br| lisp_add_del_locator locator-set ls0 sw_if_index 4 p 1 w 1 |br| lisp_add_del_locator locator-set ls0 sw_if_index 2 p 2 w 2 |br| lisp_add_del_locator locator-set ls0 sw_if_index 3 p 3 w 3 |br| lisp_add_del_locator locator-set ls0 sw_if_index 1 p 4 w 4 |br| lisp_add_del_locator_set locator-set ls0 |br| lisp_add_del_locator locator-set ls0 sw_if_index 4 p 1 w 1 |br| lisp_add_del_locator locator-set ls0 sw_if_index 2 p 2 w 2 |br| lisp_add_del_locator locator-set ls0 sw_if_index 3 p 3 w 3 |br| lisp_add_del_locator locator-set ls0 sw_if_index 1 p 4 w 4 |br| lisp_add_del_locator_set locator-set ls0 |br| lisp_add_del_locator locator-set ls0 sw_if_index 4 p 1 w 1 |br| lisp_add_del_locator locator-set ls0 sw_if_index 2 p 2 w 2 |br| lisp_add_del_locator locator-set ls0 sw_if_index 3 p 3 w 3 |br| lisp_add_del_locator locator-set ls0 sw_if_index 1 p 4 w 4 |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_locator locator-set ls1 sw_if_index 4 p 5 w 5 |br| lisp_add_del_locator locator-set ls1 sw_if_index 2 p 6 w 6 |br| lisp_add_del_locator locator-set ls1 sw_if_index 3 p 7 w 7 |br| lisp_add_del_locator locator-set ls1 sw_if_index 1 p 8 w 8 |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_locator locator-set ls1 sw_if_index 4 p 5 w 5 |br| lisp_add_del_locator locator-set ls1 sw_if_index 2 p 6 w 6 |br| lisp_add_del_locator locator-set ls1 sw_if_index 3 p 7 w 7 |br| lisp_add_del_locator locator-set ls1 sw_if_index 1 p 8 w 8 |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_locator locator-set ls1 sw_if_index 4 p 5 w 5 |br| lisp_add_del_locator locator-set ls1 sw_if_index 2 p 6 w 6 |br| lisp_add_del_locator locator-set ls1 sw_if_index 3 p 7 w 7 |br| lisp_add_del_locator locator-set ls1 sw_if_index 1 p 8 w 8 |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_locator locator-set ls1 sw_if_index 4 p 5 w 5 |br| lisp_add_del_locator locator-set ls1 sw_if_index 2 p 6 w 6 |br| lisp_add_del_locator locator-set ls1 sw_if_index 3 p 7 w 7 |br| lisp_add_del_locator locator-set ls1 sw_if_index 1 p 8 w 8 |br| lisp_add_del_locator_set locator-set ls2 |br| lisp_add_del_locator locator-set ls2 sw_if_index 4 p 9 w 9 |br| lisp_add_del_locator locator-set ls2 sw_if_index 2 p 10 w 10 |br| lisp_add_del_locator locator-set ls2 sw_if_index 3 p 11 w 11 |br| lisp_add_del_locator locator-set ls2 sw_if_index 1 p 12 w 12 |br| lisp_add_del_locator_set locator-set ls2 |br| lisp_add_del_locator locator-set ls2 sw_if_index 4 p 9 w 9 |br| lisp_add_del_locator locator-set ls2 sw_if_index 2 p 10 w 10 |br| lisp_add_del_locator locator-set ls2 sw_if_index 3 p 11 w 11 |br| lisp_add_del_locator locator-set ls2 sw_if_index 1 p 12 w 12 |br| lisp_add_del_locator_set locator-set ls2 |br| lisp_add_del_locator locator-set ls2 sw_if_index 4 p 9 w 9 |br| lisp_add_del_locator locator-set ls2 sw_if_index 2 p 10 w 10 |br| lisp_add_del_locator locator-set ls2 sw_if_index 3 p 11 w 11 |br| lisp_add_del_locator locator-set ls2 sw_if_index 1 p 12 w 12 |br| lisp_add_del_locator_set locator-set ls2 |br| lisp_add_del_locator locator-set ls2 sw_if_index 4 p 9 w 9 |br| lisp_add_del_locator locator-set ls2 sw_if_index 2 p 10 w 10 |br| lisp_add_del_locator locator-set ls2 sw_if_index 3 p 11 w 11 |br| lisp_add_del_locator locator-set ls2 sw_if_index 1 p 12 w 12 |br| lisp_locator_set_dump local |br| lisp_add_del_locator locator-set ls0 sw_if_index 4 p 1 w 1 del |br| lisp_add_del_locator locator-set ls0 sw_if_index 2 p 2 w 2 del |br| lisp_add_del_locator locator-set ls0 sw_if_index 3 p 3 w 3 del |br| lisp_add_del_locator locator-set ls0 sw_if_index 1 p 4 w 4 del |br| lisp_add_del_locator_set locator-set ls0 del |br| lisp_add_del_locator locator-set ls0 sw_if_index 4 p 1 w 1 del |br| lisp_add_del_locator locator-set ls0 sw_if_index 2 p 2 w 2 del |br| lisp_add_del_locator locator-set ls0 sw_if_index 3 p 3 w 3 del |br| lisp_add_del_locator locator-set ls0 sw_if_index 1 p 4 w 4 del |br| lisp_add_del_locator_set locator-set ls0 del |br| lisp_add_del_locator locator-set ls0 sw_if_index 4 p 1 w 1 del |br| lisp_add_del_locator locator-set ls0 sw_if_index 2 p 2 w 2 del |br| lisp_add_del_locator locator-set ls0 sw_if_index 3 p 3 w 3 del |br| lisp_add_del_locator locator-set ls0 sw_if_index 1 p 4 w 4 del |br| lisp_add_del_locator_set locator-set ls0 del |br| lisp_add_del_locator locator-set ls0 sw_if_index 4 p 1 w 1 del |br| lisp_add_del_locator locator-set ls0 sw_if_index 2 p 2 w 2 del |br| lisp_add_del_locator locator-set ls0 sw_if_index 3 p 3 w 3 del |br| lisp_add_del_locator locator-set ls0 sw_if_index 1 p 4 w 4 del |br| lisp_add_del_locator_set locator-set ls0 del |br| lisp_add_del_locator locator-set ls1 sw_if_index 4 p 5 w 5 del |br| lisp_add_del_locator locator-set ls1 sw_if_index 2 p 6 w 6 del |br| lisp_add_del_locator locator-set ls1 sw_if_index 3 p 7 w 7 del |br| lisp_add_del_locator locator-set ls1 sw_if_index 1 p 8 w 8 del |br| lisp_add_del_locator_set locator-set ls1 del |br| lisp_add_del_locator locator-set ls1 sw_if_index 4 p 5 w 5 del |br| lisp_add_del_locator locator-set ls1 sw_if_index 2 p 6 w 6 del |br| lisp_add_del_locator locator-set ls1 sw_if_index 3 p 7 w 7 del |br| lisp_add_del_locator locator-set ls1 sw_if_index 1 p 8 w 8 del |br| lisp_add_del_locator_set locator-set ls1 del |br| lisp_add_del_locator locator-set ls1 sw_if_index 4 p 5 w 5 del |br| lisp_add_del_locator locator-set ls1 sw_if_index 2 p 6 w 6 del |br| lisp_add_del_locator locator-set ls1 sw_if_index 3 p 7 w 7 del |br| lisp_add_del_locator locator-set ls1 sw_if_index 1 p 8 w 8 del |br| lisp_add_del_locator_set locator-set ls1 del |br| lisp_add_del_locator locator-set ls1 sw_if_index 4 p 5 w 5 del |br| lisp_add_del_locator locator-set ls1 sw_if_index 2 p 6 w 6 del |br| lisp_add_del_locator locator-set ls1 sw_if_index 3 p 7 w 7 del |br| lisp_add_del_locator locator-set ls1 sw_if_index 1 p 8 w 8 del |br| lisp_add_del_locator_set locator-set ls1 del |br| lisp_add_del_locator locator-set ls2 sw_if_index 4 p 9 w 9 del |br| lisp_add_del_locator locator-set ls2 sw_if_index 2 p 10 w 10 del |br| lisp_add_del_locator locator-set ls2 sw_if_index 3 p 11 w 11 del |br| lisp_add_del_locator locator-set ls2 sw_if_index 1 p 12 w 12 del |br| lisp_add_del_locator_set locator-set ls2 del |br| lisp_add_del_locator locator-set ls2 sw_if_index 4 p 9 w 9 del |br| lisp_add_del_locator locator-set ls2 sw_if_index 2 p 10 w 10 del |br| lisp_add_del_locator locator-set ls2 sw_if_index 3 p 11 w 11 del |br| lisp_add_del_locator locator-set ls2 sw_if_index 1 p 12 w 12 del |br| lisp_add_del_locator_set locator-set ls2 del |br| lisp_add_del_locator locator-set ls2 sw_if_index 4 p 9 w 9 del |br| lisp_add_del_locator locator-set ls2 sw_if_index 2 p 10 w 10 del |br| lisp_add_del_locator locator-set ls2 sw_if_index 3 p 11 w 11 del |br| lisp_add_del_locator locator-set ls2 sw_if_index 1 p 12 w 12 del |br| lisp_add_del_locator_set locator-set ls2 del |br| lisp_add_del_locator locator-set ls2 sw_if_index 4 p 9 w 9 del |br| lisp_add_del_locator locator-set ls2 sw_if_index 2 p 10 w 10 del |br| lisp_add_del_locator locator-set ls2 sw_if_index 3 p 11 w 11 del |br| lisp_add_del_locator locator-set ls2 sw_if_index 1 p 12 w 12 del |br| lisp_add_del_locator_set locator-set ls2 del |br| lisp_locator_set_dump  |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+--------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC04: DUT can add and delete eid address               |  |prein| **DUT1:** |br| lisp_enable_disable enable |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_local_eid vni 0 eid 192.168.0.0/24 locator-set ls1 |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_local_eid vni 0 eid 192.168.1.0/24 locator-set ls1 |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_local_eid vni 0 eid 192.168.2.0/24 locator-set ls1 |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_local_eid vni 0 eid 192.168.3.0/24 locator-set ls1 |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_local_eid vni 0 eid 10:1::/64 locator-set ls1 |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_local_eid vni 0 eid 10:2::/64 locator-set ls1 |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_local_eid vni 0 eid 10:3::/64 locator-set ls1 |br| lisp_add_del_local_eid vni 0 eid 192.168.0.0/24 locator-set ls1 del |br| lisp_add_del_local_eid vni 0 eid 192.168.1.0/24 locator-set ls1 del |br| lisp_add_del_local_eid vni 0 eid 192.168.2.0/24 locator-set ls1 del |br| lisp_add_del_local_eid vni 0 eid 192.168.3.0/24 locator-set ls1 del |br| lisp_add_del_local_eid vni 0 eid 10:1::/64 locator-set ls1 del |br| lisp_add_del_local_eid vni 0 eid 10:2::/64 locator-set ls1 del |br| lisp_add_del_local_eid vni 0 eid 10:3::/64 locator-set ls1 del |br| lisp_add_del_locator_set locator-set ls1 del |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
+--------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC05: DUT can add and delete LISP map resolver address |  |prein| **DUT1:** |br| lisp_enable_disable enable |br| lisp_add_del_map_resolver 192.169.0.1 |br| lisp_add_del_map_resolver 192.169.1.1 |br| lisp_add_del_map_resolver 192.169.2.1 |br| lisp_add_del_map_resolver 12:1::1 |br| lisp_add_del_map_resolver 12:2::1 |br| lisp_add_del_map_resolver 192.169.0.1 del |br| lisp_add_del_map_resolver 192.169.1.1 del |br| lisp_add_del_map_resolver 192.169.2.1 del |br| lisp_add_del_map_resolver 12:1::1 del |br| lisp_add_del_map_resolver 12:2::1 del |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
+--------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4lisp-ip4base-func
.............................

**IP AFI independent functional tests.**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-LISP-IPv4-ICMPv4 on DUT1-DUT2, Eth-IPv4-ICMPv4 on TG-DUTn for IPv4 routing over LISPoIPv4 tunnel.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with IPv4 routing and static routes. LISPoIPv4 tunnel is configured between DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC6830.

+---------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                      | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
+===========================================================================+======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv4 over LISPoIPv4 tunnel after disable-enable |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6.0.3.1/24 |br| sw_interface_add_del_address sw_if_index 1 6.0.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 6.0.1.2 mac fa:16:3e:87:a4:72 |br| lisp_enable_disable enable |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_locator locator-set ls1 sw_if_index 3 p 1 w 1 |br| lisp_add_del_local_eid vni 0 eid 6.0.1.0/24 locator-set ls1 |br| lisp_add_del_remote_mapping add vni 0 eid 6.0.2.0/24 seid 6.0.1.0/24 rloc 6.0.3.2 |br| lisp_add_del_adjacency add vni 0 reid 6.0.2.0/24 leid 6.0.1.0/24 |br| lisp_enable_disable disable |br| lisp_enable_disable enable |br| lisp_add_del_adjacency add vni 0 reid 6.0.2.0/24 leid 6.0.1.0/24 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6.0.3.2/24 |br| sw_interface_add_del_address sw_if_index 1 6.0.2.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 6.0.2.2 mac fa:16:3e:44:bb:1f |br| lisp_enable_disable enable |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_locator locator-set ls1 sw_if_index 3 p 1 w 1 |br| lisp_add_del_local_eid vni 0 eid 6.0.2.0/24 locator-set ls1 |br| lisp_add_del_remote_mapping add vni 0 eid 6.0.1.0/24 seid 6.0.2.0/24 rloc 6.0.3.1 |br| lisp_add_del_adjacency add vni 0 reid 6.0.1.0/24 leid 6.0.2.0/24 |br| lisp_add_del_adjacency add vni 0 reid 6.0.1.0/24 leid 6.0.2.0/24 |br|  |preout|  |
+---------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4lisp-l2bdbasemaclrn-func
....................................

**ip4-lispgpe-ip4 encapsulation test cases**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-ICMPv4-LISPGpe-IP4  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with IPv4 routing and static routes. LISPoIPv4 tunnel is configured between DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC6830.

+----------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                           | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
+================================================================+===============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: Route IPv4 packet through LISP with Bridge Domain setup. |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 10.0.3.1/24 |br| sw_interface_add_del_address sw_if_index 1 10.0.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 10.0.1.2 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 3 dst 10.0.3.2 mac fa:16:3e:6e:17:58 |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0 enable |br| lisp_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 5 bd_index 10 |br| lisp_add_del_local_eid vni 5 eid 08:22:22:22:22:11 locator-set tst_locator |br| lisp_add_del_map_resolver 10.0.0.2 |br| lisp_add_del_remote_mapping add vni 5 eid 08:22:22:22:22:22 seid 08:22:22:22:22:11 rloc 10.0.3.2 |br| lisp_add_del_adjacency add vni 5 reid 08:22:22:22:22:22 leid 08:22:22:22:22:11 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 10.0.3.2/24 |br| sw_interface_add_del_address sw_if_index 1 10.0.2.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 10.0.2.2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 10.0.3.1 mac fa:16:3e:d7:aa:2b |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0 enable |br| lisp_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 5 bd_index 10 |br| lisp_add_del_local_eid vni 5 eid 08:22:22:22:22:22 locator-set tst_locator |br| lisp_add_del_map_resolver 10.0.0.1 |br| lisp_add_del_remote_mapping add vni 5 eid 08:22:22:22:22:11 seid 08:22:22:22:22:22 rloc 10.0.3.1 |br| lisp_add_del_adjacency add vni 5 reid 08:22:22:22:22:11 leid 08:22:22:22:22:22 |br|  |preout|  |
+----------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4lispgpe-ip4base-func
................................

**ip4-lispgpe-ip4 encapsulation test cases**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-LISP-IPv4-ICMPv4 on DUT1-DUT2, Eth-IPv4-ICMPv4 on TG-DUTn for IPv4 routing over LISPoIPv4 tunnel.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with IPv4 routing and static routes. LISPoIPv4 tunnel is configured between DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC6830.

+-----------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                          | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+===============================================================================================+===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv4 bidirectionally over LISP GPE tunnel using physical interfaces |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6.0.4.1/24 |br| sw_interface_add_del_address sw_if_index 1 6.0.1.2/24 |br| ip_neighbor_add_del sw_if_index 1 dst 6.0.1.1 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 3 dst 6.0.4.2 mac fa:16:3e:6e:17:58 |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6.0.1.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 6.0.5.0/24 seid 6.0.1.0/24 rloc 6.0.4.2 |br| lisp_add_del_adjacency add vni 0 reid 6.0.5.0/24 leid 6.0.1.0/24 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6.0.4.2/24 |br| sw_interface_add_del_address sw_if_index 1 6.0.5.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 6.0.5.2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 6.0.4.1 mac fa:16:3e:d7:aa:2b |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6.0.5.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 6.0.1.0/24 seid 6.0.5.0/24 rloc 6.0.4.1 |br| lisp_add_del_adjacency add vni 0 reid 6.0.1.0/24 leid 6.0.5.0/24 |br|  |preout|  |
+-----------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4lispgpe-ip4basevrf-func
...................................

**ip4-lispgpe-ip4 encapsulation test cases**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-LISP-IPv4-ICMPv4 on DUT1-DUT2, Eth-IPv4-ICMPv4 on TG-DUTn for IPv4 routing over LISPoIPv4 tunnel.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with IPv4 routing and static routes. LISPoIPv4 tunnel is configured between DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC6830.

+------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                             | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
+==================================================================================================================+=============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv4 bidirectionally over LISP GPE tunnel using physical interfaces and VRF is enabled |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 1  |br| ip_neighbor_add_del sw_if_index 1 dst 6.0.1.1 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 3 dst 6.0.4.2 mac fa:16:3e:6e:17:58 |br| sw_interface_add_del_address sw_if_index 3 6.0.4.1/24 |br| sw_interface_add_del_address sw_if_index 1 6.0.1.2/24 |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 1 vrf 1 |br| lisp_add_del_local_eid vni 1 eid 6.0.1.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 1 eid 6.0.5.0/24 seid 6.0.1.0/24 rloc 6.0.4.2 |br| lisp_add_del_adjacency add vni 1 reid 6.0.5.0/24 leid 6.0.1.0/24 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 1  |br| ip_neighbor_add_del sw_if_index 1 dst 6.0.5.2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 6.0.4.1 mac fa:16:3e:d7:aa:2b |br| sw_interface_add_del_address sw_if_index 3 6.0.4.2/24 |br| sw_interface_add_del_address sw_if_index 1 6.0.5.1/24 |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 1 vrf 1 |br| lisp_add_del_local_eid vni 1 eid 6.0.5.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 1 eid 6.0.1.0/24 seid 6.0.5.0/24 rloc 6.0.4.1 |br| lisp_add_del_adjacency add vni 1 reid 6.0.1.0/24 leid 6.0.5.0/24 |br|  |preout|  |
+------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4lispgpe-ip6base-func
................................

**LISP static adjacency test cases**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-LISP-IPv6-ICMPv6 on DUT1-DUT2, Eth-IPv6-ICMPv6 on TG-DUTn for IPv6 routing over LISPoIPv4 tunnel.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with IPv6 routing and static routes. LISPoIPv4 tunnel is configured between DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv6 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv6 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC6830.

+----------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                 | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+======================================================================+===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv6 bidirectionally over LISPoIPv4 tunnel |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6.0.3.1/24 |br| sw_interface_add_del_address sw_if_index 1 6:0:1::1/64 |br| ip_neighbor_add_del sw_if_index 1 dst 6:0:1::2 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 3 dst 6.0.3.2 mac fa:16:3e:6e:17:58 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_locator locator-set ls1 sw_if_index 3 p 1 w 1 |br| lisp_add_del_local_eid vni 0 eid 6:0:1::0/64 locator-set ls1 |br| lisp_add_del_remote_mapping add vni 0 eid 6:0:2::0/64 seid 6:0:1::0/64 rloc 6.0.3.2 |br| lisp_add_del_adjacency add vni 0 reid 6:0:2::0/64 leid 6:0:1::0/64 |br| lisp_add_del_remote_mapping del vni 0 eid 6:0:2::0/64 seid 6:0:1::0/64 rloc 6.0.3.2 |br| lisp_add_del_adjacency del vni 0 reid 6:0:2::0/64 leid 6:0:1::0/64 |br| ip_neighbor_add_del sw_if_index 3 dst 6.0.3.20 mac fa:16:3e:6e:17:58 |br| lisp_add_del_remote_mapping add vni 0 eid 6:0:2::0/64 seid 6:0:1::0/64 rloc 6.0.3.20 |br| lisp_add_del_adjacency add vni 0 reid 6:0:2::0/64 leid 6:0:1::0/64 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6.0.3.2/24 |br| sw_interface_add_del_address sw_if_index 1 6:0:2::1/64 |br| ip_neighbor_add_del sw_if_index 1 dst 6:0:2::2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 6.0.3.1 mac fa:16:3e:d7:aa:2b |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_locator locator-set ls1 sw_if_index 3 p 1 w 1 |br| lisp_add_del_local_eid vni 0 eid 6:0:2::0/64 locator-set ls1 |br| lisp_add_del_remote_mapping add vni 0 eid 6:0:1::0/64 seid 6:0:2::0/64 rloc 6.0.3.1 |br| lisp_add_del_adjacency add vni 0 reid 6:0:1::0/64 leid 6:0:2::0/64 |br| sw_interface_add_del_address sw_if_index 3 del-all |br| sw_interface_add_del_address sw_if_index 3 6.0.3.20/24 |br| ip_neighbor_add_del sw_if_index 3 dst 6.0.3.1 mac fa:16:3e:d7:aa:2b |br|  |preout|  |
+----------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4lispgpe-ip6basevrf-func
...................................

**LISP static adjacency test cases**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-LISP-IPv6-ICMPv6 on DUT1-DUT2, Eth-IPv6-ICMPv6 on TG-DUTn for IPv6 routing over LISPoIPv4 tunnel.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with IPv6 routing and static routes. LISPoIPv4 tunnel is configured between DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv6 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv6 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC6830.

+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                             | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+==================================================================================================================+===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv6 bidirectionally over LISP GPE tunnel using physical interfaces and VRF is enabled |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 1 ipv6 |br| ip_neighbor_add_del sw_if_index 1 dst 6:0:1::2 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 3 dst 6.0.3.2 mac fa:16:3e:6e:17:58 |br| sw_interface_add_del_address sw_if_index 3 6.0.3.1/24 |br| sw_interface_add_del_address sw_if_index 1 6:0:1::1/64 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_locator locator-set ls1 sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 1 vrf 1 |br| lisp_add_del_local_eid vni 1 eid 6:0:1::0/64 locator-set ls1 |br| lisp_add_del_remote_mapping add vni 1 eid 6:0:2::0/64 seid 6:0:1::0/64 rloc 6.0.3.2 |br| lisp_add_del_adjacency add vni 1 reid 6:0:2::0/64 leid 6:0:1::0/64 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 1 ipv6 |br| ip_neighbor_add_del sw_if_index 1 dst 6:0:2::2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 6.0.3.1 mac fa:16:3e:d7:aa:2b |br| sw_interface_add_del_address sw_if_index 3 6.0.3.2/24 |br| sw_interface_add_del_address sw_if_index 1 6:0:2::1/64 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_locator locator-set ls1 sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 1 vrf 1 |br| lisp_add_del_local_eid vni 1 eid 6:0:2::0/64 locator-set ls1 |br| lisp_add_del_remote_mapping add vni 1 eid 6:0:1::0/64 seid 6:0:2::0/64 rloc 6.0.3.1 |br| lisp_add_del_adjacency add vni 1 reid 6:0:1::0/64 leid 6:0:2::0/64 |br|  |preout|  |
+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

ip6 tunnels
```````````



vxlan
'''''



eth2p-ethip6vxlan-l2bdbasemaclrn-func
.....................................

**Bridge-domain with VXLAN test cases - IPv6**   

 - **[Top] Network topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet encapsulations:** Eth-IPv6-VXLAN-Eth-IPv6-ICMPv6 on DUT1-DUT2, Eth-IPv6-ICMPv6 on TG-DUTn for L2 switching of IPv6.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with L2 bridge-domain (L2BD) switching combined with MAC learning enabled; VXLAN tunnels are configured between L2BDs on DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv6 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv6 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC7348.

+-------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
+=====================================================================================+=================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 with L2BD and VXLANoIPv6 tunnels switch ICMPv6 between TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 3ffe:64::1/64 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| vxlan_add_del_tunnel src 3ffe:64::1 dst 3ffe:64::2 vni 23 |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 10 shg 0  enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 3ffe:64::2/64 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| vxlan_add_del_tunnel src 3ffe:64::2 dst 3ffe:64::1 vni 23 |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 10 shg 0  enable |br|  |preout|  |
+-------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth4p-ethip6vxlan-l2bdbasemaclrn-l2shg-func
...........................................

**L2BD with SHG combined with VXLAN test cases - IPv6**   

 - **[Top] Network topologies:** TG=DUT1=DUT2=TG 3-node circular topology with double parallel links.  

 - **[Enc] Packet encapsulations:** th-IPv6-VXLAN-Eth-IPv6-ICMPv6 on DUT1-DUT2, Eth-IPv6-ICMPv6 on TG-DUTn for L2 switching of IPv6.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with L2 bridge-domain (L2BD) switching combined with MAC learning enabled and Split Horizon Groups (SHG); VXLAN tunnels are configured between L2BDs on DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv6 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC7348.

+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                  | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+=======================================================================================================+=======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 with L2BD and VXLANoIPv6 tunnels in SHG switch ICMPv6 between TG links            |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 3ffe:64::1/64 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| vxlan_add_del_tunnel src 3ffe:64::1 dst 3ffe:64::2 vni 23 |br| vxlan_add_del_tunnel src 3ffe:64::1 dst 3ffe:64::2 vni 35 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_dump |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_l2_bridge sw_if_index 2 bd_id 10 shg 0 enable |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 10 shg 1 enable |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 10 shg 1 enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 3ffe:64::2/64 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| vxlan_add_del_tunnel src 3ffe:64::2 dst 3ffe:64::1 vni 23 |br| vxlan_add_del_tunnel src 3ffe:64::2 dst 3ffe:64::1 vni 35 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_dump |br| bridge_domain_add_del bd_id 20 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_l2_bridge sw_if_index 2 bd_id 20 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 20 shg 0 enable |br| bridge_domain_add_del bd_id 30 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 30 shg 0 enable |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 30 shg 0 enable |br|  |preout|  |
+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT1 and DUT2 with L2BD and VXLANoIPv6 tunnels in different SHGs switch ICMPv6 between TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 3ffe:64::1/64 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| vxlan_add_del_tunnel src 3ffe:64::1 dst 3ffe:64::2 vni 23 |br| vxlan_add_del_tunnel src 3ffe:64::1 dst 3ffe:64::2 vni 35 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_dump |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_l2_bridge sw_if_index 2 bd_id 10 shg 0 enable |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 10 shg 1 enable |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 10 shg 2 enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 3ffe:64::2/64 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| vxlan_add_del_tunnel src 3ffe:64::2 dst 3ffe:64::1 vni 23 |br| vxlan_add_del_tunnel src 3ffe:64::2 dst 3ffe:64::1 vni 35 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_dump |br| bridge_domain_add_del bd_id 20 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_l2_bridge sw_if_index 2 bd_id 20 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 20 shg 0 enable |br| bridge_domain_add_del bd_id 30 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 30 shg 0 enable |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 30 shg 0 enable |br|  |preout|  |
+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

vm vhost
````````



ip4
'''



eth2p-ethip4-ip4base-eth-2vhost-1vm
...................................

**IPv4 routing test cases with vhost user interface**  RFC791 IPv4, RFC826 ARP, RFC792 ICMPv4. Encapsulations: Eth-IPv4-ICMPv4 on links TG=DUT1. IPv4 routing tests use circular 2-node topology TG - DUT1 - TG with two link between the nodes. DUT is configured with IPv4 routing and static routes. Test sends packets by TG on links to DUT and received on TG link on the other side of circular topology. On receive TG verifies packets IPv4 src-addr, dst-addr and MAC addresses.

+---------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                        | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+=============================================+============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: IPv4 forward via vhost to another VRF |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_table sw_if_index 6 vrf 20  |br| sw_interface_set_table sw_if_index 1 vrf 20  |br| sw_interface_add_del_address sw_if_index 2 10.0.1.1/24 |br| sw_interface_add_del_address sw_if_index 5 10.0.2.1/24 |br| sw_interface_add_del_address sw_if_index 6 10.0.2.2/24 |br| sw_interface_add_del_address sw_if_index 1 10.0.3.1/24 |br| sw_interface_dump |br| ip_add_del_route 10.0.3.0/24 via 10.0.2.2  sw_if_index 5      |br| ip_add_del_route 10.0.1.0/24 via 10.0.2.1 vrf 20 sw_if_index 6      |br| ip_neighbor_add_del sw_if_index 5 dst 10.0.2.2 mac 02:fe:bf:a0:bc:b5 |br| ip_neighbor_add_del sw_if_index 1 dst 10.0.3.2 mac fa:16:3e:87:a4:72 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+---------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4ipsectptlispgpe-ip4base-eth-2vhost-1vm-func
.......................................................

**IPv4-ip4-ipsec-lispgpe-ip4 - main fib, vrf (gpe_vni-to-vrf)**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** ICMPv4-IPv4-IPSec-LISPGPE-IPv4-ICMPv4.  

 - **[Cfg] DUT configuration:** Each DUT is configured with LISP and IPsec. IPsec is in transport mode. Tests cases are for IPsec configured both on RLOC interface or lisp_gpe0 interface.  

 - **[Ver] TG verification:** Packet is send from TG(if1) across the DUT1 via VM to DUT2 where it is forwarded to TG(if2).  

 - **[Ref] Applicable standard specifications:** RFC6830, RFC4303.

+--------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                   | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
+========================================================================================================+=============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv4 over Vhost to LISP GPE tunnel using IPsec (transport) on RLOC Int.      |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 0  |br| sw_interface_add_del_address sw_if_index 3 6.6.3.1/24 |br| sw_interface_add_del_address sw_if_index 1 6.6.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 6.6.1.2 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.2 mac fa:16:3e:6e:17:58 |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_add_del_address sw_if_index 6 6.6.1.9/24 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 10 shg 0 enable |br| sw_interface_dump |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6.6.1.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 6.6.2.0/24 seid 6.6.1.0/24 rloc 6.6.3.2 |br| lisp_add_del_adjacency add vni 0 reid 6.6.2.0/24 leid 6.6.1.0/24 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 7964715457585432614f703151454567 integ_alg sha1-96 integ_key 394f426c4a593068634e68504d4f777148506e36  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 7964715457585432614f703151454567 integ_alg sha1-96 integ_key 394f426c4a593068634e68504d4f777148506e36  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 3 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.3.1 laddr_stop 6.6.3.1 raddr_start 6.6.3.2 raddr_stop 6.6.3.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.3.1 laddr_stop 6.6.3.1 raddr_start 6.6.3.2 raddr_stop 6.6.3.2  |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 0  |br| sw_interface_add_del_address sw_if_index 3 6.6.3.2/24 |br| sw_interface_add_del_address sw_if_index 1 6.6.2.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 6.6.2.2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.1 mac fa:16:3e:d7:aa:2b |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6.6.2.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 6.6.1.0/24 seid 6.6.2.0/24 rloc 6.6.3.1 |br| lisp_add_del_adjacency add vni 0 reid 6.6.1.0/24 leid 6.6.2.0/24 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1000 crypto_alg aes-cbc-128 crypto_key 7964715457585432614f703151454567 integ_alg sha1-96 integ_key 394f426c4a593068634e68504d4f777148506e36  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1001 crypto_alg aes-cbc-128 crypto_key 7964715457585432614f703151454567 integ_alg sha1-96 integ_key 394f426c4a593068634e68504d4f777148506e36  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 3 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.3.2 laddr_stop 6.6.3.2 raddr_start 6.6.3.1 raddr_stop 6.6.3.1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.3.2 laddr_stop 6.6.3.2 raddr_start 6.6.3.1 raddr_stop 6.6.3.1  |br|  |preout|                                                |
+--------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT1 and DUT2 route IPv4 over Vhost to LISP GPE tunnel using IPsec (transport) on lisp_gpe0 Int. |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 0  |br| sw_interface_add_del_address sw_if_index 3 6.6.3.1/24 |br| sw_interface_add_del_address sw_if_index 1 6.6.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 6.6.1.2 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.2 mac fa:16:3e:6e:17:58 |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_add_del_address sw_if_index 6 6.6.1.9/24 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 10 shg 0 enable |br| sw_interface_dump |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6.6.1.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 6.6.2.0/24 seid 6.6.1.0/24 rloc 6.6.3.2 |br| lisp_add_del_adjacency add vni 0 reid 6.6.2.0/24 leid 6.6.1.0/24 |br| sw_interface_dump |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 75356e773231626156594f4745376e39 integ_alg sha1-96 integ_key 554a575574346673574e644874786b6b78423047  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 75356e773231626156594f4745376e39 integ_alg sha1-96 integ_key 554a575574346673574e644874786b6b78423047  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 7 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.3.1 laddr_stop 6.6.3.1 raddr_start 6.6.3.2 raddr_stop 6.6.3.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.3.1 laddr_stop 6.6.3.1 raddr_start 6.6.3.2 raddr_stop 6.6.3.2  |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 0  |br| sw_interface_add_del_address sw_if_index 3 6.6.3.2/24 |br| sw_interface_add_del_address sw_if_index 1 6.6.2.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 6.6.2.2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.1 mac fa:16:3e:d7:aa:2b |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6.6.2.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 6.6.1.0/24 seid 6.6.2.0/24 rloc 6.6.3.1 |br| lisp_add_del_adjacency add vni 0 reid 6.6.1.0/24 leid 6.6.2.0/24 |br| sw_interface_dump |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1000 crypto_alg aes-cbc-128 crypto_key 75356e773231626156594f4745376e39 integ_alg sha1-96 integ_key 554a575574346673574e644874786b6b78423047  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1001 crypto_alg aes-cbc-128 crypto_key 75356e773231626156594f4745376e39 integ_alg sha1-96 integ_key 554a575574346673574e644874786b6b78423047  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 5 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.3.2 laddr_stop 6.6.3.2 raddr_start 6.6.3.1 raddr_stop 6.6.3.1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.3.2 laddr_stop 6.6.3.2 raddr_start 6.6.3.1 raddr_stop 6.6.3.1  |br|  |preout|  |
+--------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4ipsectptlispgpe-ip6base-eth-2vhost-1vm-func
.......................................................

**IPv6 - ip4-ipsec-lispgpe-ip6 - main fib, vrf, virt2lisp, phy2lisp**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-LISPGPE-IPSec-IPv6-ICMP, Eth-IPv4-IPSec-LISPGPE-IPv6-ICMP  

 - **[Cfg] DUT configuration:** Each DUT is configured with LISP and IPsec. IPsec is in transport mode. Tests cases are for IPsec configured both on RLOC interface or lisp_gpe0 interface.  

 - **[Ver] TG verification:** Packet is send from TG(if1) across the DUT1 via VM to DUT2 where it is forwarded to TG(if2).  

 - **[Ref] Applicable standard specifications:** RFC6830, RFC4303.

+--------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                   | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
+========================================================================================================+=================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv6 over Vhost to LISP GPE tunnel using IPsec (transport) on RLOC Int.      |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6.6.3.1/24 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:1::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.2 mac fa:16:3e:6e:17:58 |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:1::2 mac fa:16:3e:87:a4:72 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 2001:cdba:1::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 2001:cdba:2::0/64 seid 2001:cdba:1::0/64 rloc 6.6.3.2 |br| lisp_add_del_adjacency add vni 0 reid 2001:cdba:2::0/64 leid 2001:cdba:1::0/64 |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_add_del_address sw_if_index 8 2001:cdba:1::3/64 |br| sw_interface_set_flags sw_if_index 7 admin-up |br| sw_interface_set_flags sw_if_index 8 admin-up |br| sw_interface_ip6nd_ra_config sw_if_index 8 surpress |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0 enable |br| sw_interface_set_flags sw_if_index 7 admin-up |br| sw_interface_set_l2_bridge sw_if_index 7 bd_id 10 shg 0 enable |br| sw_interface_dump |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 456c4558554a4c567865566d6a526c69 integ_alg sha1-96 integ_key 597348787069704846584e4c4454655a58613430  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 456c4558554a4c567865566d6a526c69 integ_alg sha1-96 integ_key 597348787069704846584e4c4454655a58613430  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 3 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.3.1 laddr_stop 6.6.3.1 raddr_start 6.6.3.2 raddr_stop 6.6.3.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.3.1 laddr_stop 6.6.3.1 raddr_start 6.6.3.2 raddr_stop 6.6.3.2  |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6.6.3.2/24 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:2::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:2::2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.1 mac fa:16:3e:d7:aa:2b |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 2001:cdba:2::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 2001:cdba:1::0/64 seid 2001:cdba:2::0/64 rloc 6.6.3.1 |br| lisp_add_del_adjacency add vni 0 reid 2001:cdba:1::0/64 leid 2001:cdba:2::0/64 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1000 crypto_alg aes-cbc-128 crypto_key 456c4558554a4c567865566d6a526c69 integ_alg sha1-96 integ_key 597348787069704846584e4c4454655a58613430  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1001 crypto_alg aes-cbc-128 crypto_key 456c4558554a4c567865566d6a526c69 integ_alg sha1-96 integ_key 597348787069704846584e4c4454655a58613430  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 3 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.3.2 laddr_stop 6.6.3.2 raddr_start 6.6.3.1 raddr_stop 6.6.3.1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.3.2 laddr_stop 6.6.3.2 raddr_start 6.6.3.1 raddr_stop 6.6.3.1  |br|  |preout|                                                |
+--------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT1 and DUT2 route IPv6 over Vhost to LISP GPE tunnel using IPsec (transport) on lisp_gpe0 Int. |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6.6.3.1/24 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:1::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.2 mac fa:16:3e:6e:17:58 |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:1::2 mac fa:16:3e:87:a4:72 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 2001:cdba:1::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 2001:cdba:2::0/64 seid 2001:cdba:1::0/64 rloc 6.6.3.2 |br| lisp_add_del_adjacency add vni 0 reid 2001:cdba:2::0/64 leid 2001:cdba:1::0/64 |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_add_del_address sw_if_index 8 2001:cdba:1::3/64 |br| sw_interface_set_flags sw_if_index 7 admin-up |br| sw_interface_set_flags sw_if_index 8 admin-up |br| sw_interface_ip6nd_ra_config sw_if_index 8 surpress |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0 enable |br| sw_interface_set_flags sw_if_index 7 admin-up |br| sw_interface_set_l2_bridge sw_if_index 7 bd_id 10 shg 0 enable |br| sw_interface_dump |br| sw_interface_dump |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 6254704d514a6938786278346e514f39 integ_alg sha1-96 integ_key 4b4b5172344a547376546e6b30504a7844304245  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 6254704d514a6938786278346e514f39 integ_alg sha1-96 integ_key 4b4b5172344a547376546e6b30504a7844304245  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 5 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.3.1 laddr_stop 6.6.3.1 raddr_start 6.6.3.2 raddr_stop 6.6.3.2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.3.1 laddr_stop 6.6.3.1 raddr_start 6.6.3.2 raddr_stop 6.6.3.2  |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6.6.3.2/24 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:2::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:2::2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 6.6.3.1 mac fa:16:3e:d7:aa:2b |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 2001:cdba:2::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 2001:cdba:1::0/64 seid 2001:cdba:2::0/64 rloc 6.6.3.1 |br| lisp_add_del_adjacency add vni 0 reid 2001:cdba:1::0/64 leid 2001:cdba:2::0/64 |br| sw_interface_dump |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1000 crypto_alg aes-cbc-128 crypto_key 6254704d514a6938786278346e514f39 integ_alg sha1-96 integ_key 4b4b5172344a547376546e6b30504a7844304245  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1001 crypto_alg aes-cbc-128 crypto_key 6254704d514a6938786278346e514f39 integ_alg sha1-96 integ_key 4b4b5172344a547376546e6b30504a7844304245  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 5 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 6.6.3.2 laddr_stop 6.6.3.2 raddr_start 6.6.3.1 raddr_stop 6.6.3.1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 6.6.3.2 laddr_stop 6.6.3.2 raddr_start 6.6.3.1 raddr_stop 6.6.3.1  |br|  |preout|  |
+--------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4lispgpe-ip4base-eth-2vhost-1vm-func
...............................................

**ip4-lispgpe-ip4 encapsulation test cases**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-LISP-IPv4-ICMPv4 on DUT1-DUT2, Eth-IPv4-ICMPv4 on TG-DUTn for IPv4 routing over LISPoIPv4 tunnel.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with IPv4 routing and static routes. LISPoIPv4 tunnel is configured between DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC6830.

+--------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                       | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
+============================================================================================+==============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv4 bidirectionally over LISP GPE tunnel using vhost interfaces |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6.0.4.1/24 |br| sw_interface_add_del_address sw_if_index 1 6.0.1.2/24 |br| ip_neighbor_add_del sw_if_index 1 dst 6.0.1.1 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 3 dst 6.0.4.2 mac fa:16:3e:6e:17:58 |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6.0.1.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 6.0.5.0/24 seid 6.0.1.0/24 rloc 6.0.4.2 |br| lisp_add_del_adjacency add vni 0 reid 6.0.5.0/24 leid 6.0.1.0/24 |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_set_table sw_if_index 8 vrf 0  |br| sw_interface_add_del_address sw_if_index 8 6.0.1.3/24 |br| sw_interface_set_flags sw_if_index 7 admin-up |br| sw_interface_set_flags sw_if_index 8 admin-up |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0 enable |br| sw_interface_set_flags sw_if_index 7 admin-up |br| sw_interface_set_l2_bridge sw_if_index 7 bd_id 10 shg 0 enable |br| sw_interface_dump |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6.0.4.2/24 |br| sw_interface_add_del_address sw_if_index 1 6.0.5.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 6.0.5.2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 6.0.4.1 mac fa:16:3e:d7:aa:2b |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6.0.5.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 6.0.1.0/24 seid 6.0.5.0/24 rloc 6.0.4.1 |br| lisp_add_del_adjacency add vni 0 reid 6.0.1.0/24 leid 6.0.5.0/24 |br|  |preout|  |
+--------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4lispgpe-ip4basevrf-eth-2vhost-1vm-func
..................................................

**ip4-lispgpe-ip4 encapsulation test cases**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-LISP-IPv4-ICMPv4 on DUT1-DUT2, Eth-IPv4-ICMPv4 on TG-DUTn for IPv4 routing over LISPoIPv4 tunnel.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with IPv4 routing and static routes. LISPoIPv4 tunnel is configured between DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC6830.

+---------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                          | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
+===============================================================================================================+================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv4 bidirectionally over LISP GPE tunnel using vhost interfaces and VRF is enabled |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 1  |br| ip_neighbor_add_del sw_if_index 1 dst 6.0.1.1 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 3 dst 6.0.4.2 mac fa:16:3e:6e:17:58 |br| sw_interface_add_del_address sw_if_index 3 6.0.4.1/24 |br| sw_interface_add_del_address sw_if_index 1 6.0.1.2/24 |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 1 vrf 1 |br| lisp_add_del_local_eid vni 1 eid 6.0.1.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 1 eid 6.0.5.0/24 seid 6.0.1.0/24 rloc 6.0.4.2 |br| lisp_add_del_adjacency add vni 1 reid 6.0.5.0/24 leid 6.0.1.0/24 |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_set_table sw_if_index 9 vrf 1  |br| sw_interface_add_del_address sw_if_index 9 6.0.1.3/24 |br| sw_interface_set_flags sw_if_index 8 admin-up |br| sw_interface_set_flags sw_if_index 9 admin-up |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0 enable |br| sw_interface_set_flags sw_if_index 8 admin-up |br| sw_interface_set_l2_bridge sw_if_index 8 bd_id 10 shg 0 enable |br| sw_interface_dump |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 1  |br| ip_neighbor_add_del sw_if_index 1 dst 6.0.5.2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 6.0.4.1 mac fa:16:3e:d7:aa:2b |br| sw_interface_add_del_address sw_if_index 3 6.0.4.2/24 |br| sw_interface_add_del_address sw_if_index 1 6.0.5.1/24 |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 1 vrf 1 |br| lisp_add_del_local_eid vni 1 eid 6.0.5.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 1 eid 6.0.1.0/24 seid 6.0.5.0/24 rloc 6.0.4.1 |br| lisp_add_del_adjacency add vni 1 reid 6.0.1.0/24 leid 6.0.5.0/24 |br|  |preout|  |
+---------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4lispgpe-ip6base-eth-2vhost-1vm-func
...............................................

**LISP static adjacency test cases**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-LISP-IPv6-ICMPv6 on DUT1-DUT2, Eth-IPv6-ICMPv6 on TG-DUTn for IPv6 routing over LISPoIPv4 tunnel.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with IPv6 routing and static routes. LISPoIPv4 tunnel is configured between DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv6 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv6 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC6830.

+--------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                       | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+============================================================================================+====================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv6 bidirectionally over LISP GPE tunnel using vhost interfaces |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6.0.3.1/24 |br| sw_interface_add_del_address sw_if_index 1 6:0:1::1/64 |br| ip_neighbor_add_del sw_if_index 1 dst 6:0:1::2 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 3 dst 6.0.3.2 mac fa:16:3e:6e:17:58 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_locator locator-set ls1 sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6:0:1::0/64 locator-set ls1 |br| lisp_add_del_remote_mapping add vni 0 eid 6:0:2::0/64 seid 6:0:1::0/64 rloc 6.0.3.2 |br| lisp_add_del_adjacency add vni 0 reid 6:0:2::0/64 leid 6:0:1::0/64 |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_add_del_address sw_if_index 8 6:0:1::3/24 |br| sw_interface_set_flags sw_if_index 7 admin-up |br| sw_interface_set_flags sw_if_index 8 admin-up |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0 enable |br| sw_interface_set_flags sw_if_index 7 admin-up |br| sw_interface_set_l2_bridge sw_if_index 7 bd_id 10 shg 0 enable |br| sw_interface_dump |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6.0.3.2/24 |br| sw_interface_add_del_address sw_if_index 1 6:0:2::1/64 |br| ip_neighbor_add_del sw_if_index 1 dst 6:0:2::2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 6.0.3.1 mac fa:16:3e:d7:aa:2b |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_locator locator-set ls1 sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6:0:2::0/64 locator-set ls1 |br| lisp_add_del_remote_mapping add vni 0 eid 6:0:1::0/64 seid 6:0:2::0/64 rloc 6.0.3.1 |br| lisp_add_del_adjacency add vni 0 reid 6:0:1::0/64 leid 6:0:2::0/64 |br|  |preout|  |
+--------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

ip6
'''



eth2p-ethip6ipsectptlispgpe-ip4base-eth-2vhost-1vm-func
.......................................................

**IPv6 - ip4-ipsec-lispgpe-ip6 - main fib, virt2lisp, phy2lisp**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv6-LISPGPE-IPSec-IPv4-ICMP, Eth-IPv6-IPSec-LISPGPE-IPv4-ICMP  

 - **[Cfg] DUT configuration:** Each DUT is configured with LISP and IPsec. IPsec is in transport mode. Test cases are for IPsec configured both on RLOC interface or lisp_gpe0 interface.  

 - **[Ver] TG verification:** Packet is send from TG(if1) across the DUT1 to DUT2 where it is forwarded to TG(if2).  

 - **[Ref] Applicable standard specifications:** RFC6830, RFC4303.

+--------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                   | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
+========================================================================================================+==============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv4 over Vhost to LISP GPE tunnel using IPsec (transport) on RLOC Int.      |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 6.0.1.1/24 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::2 mac fa:16:3e:6e:17:58 |br| ip_neighbor_add_del sw_if_index 1 dst 6.0.1.2 mac fa:16:3e:87:a4:72 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6.0.1.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 6.0.2.0/24 seid 6.0.1.0/24 rloc 2001:cdba:3::2 |br| lisp_add_del_adjacency add vni 0 reid 6.0.2.0/24 leid 6.0.1.0/24 |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_add_del_address sw_if_index 8 6.0.1.3/24 |br| sw_interface_set_flags sw_if_index 7 admin-up |br| sw_interface_set_flags sw_if_index 8 admin-up |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0 enable |br| sw_interface_set_flags sw_if_index 7 admin-up |br| sw_interface_set_l2_bridge sw_if_index 7 bd_id 10 shg 0 enable |br| sw_interface_dump |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 6231673370504d74426e6e6d7466427a integ_alg sha1-96 integ_key 585766494d484d4b6765426374693863777a6346  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 6231673370504d74426e6e6d7466427a integ_alg sha1-96 integ_key 585766494d484d4b6765426374693863777a6346  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 3 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 2001:cdba:3::1 laddr_stop 2001:cdba:3::1 raddr_start 2001:cdba:3::2 raddr_stop 2001:cdba:3::2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 2001:cdba:3::1 laddr_stop 2001:cdba:3::1 raddr_start 2001:cdba:3::2 raddr_stop 2001:cdba:3::2  |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::2/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 6.0.2.1/24 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 6.0.2.2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::1 mac fa:16:3e:d7:aa:2b |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6.0.2.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 6.0.1.0/24 seid 6.0.2.0/24 rloc 2001:cdba:3::1 |br| lisp_add_del_adjacency add vni 0 reid 6.0.1.0/24 leid 6.0.2.0/24 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1000 crypto_alg aes-cbc-128 crypto_key 6231673370504d74426e6e6d7466427a integ_alg sha1-96 integ_key 585766494d484d4b6765426374693863777a6346  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1001 crypto_alg aes-cbc-128 crypto_key 6231673370504d74426e6e6d7466427a integ_alg sha1-96 integ_key 585766494d484d4b6765426374693863777a6346  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 3 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 2001:cdba:3::2 laddr_stop 2001:cdba:3::2 raddr_start 2001:cdba:3::1 raddr_stop 2001:cdba:3::1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 2001:cdba:3::2 laddr_stop 2001:cdba:3::2 raddr_start 2001:cdba:3::1 raddr_stop 2001:cdba:3::1  |br|  |preout|                                                |
+--------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT1 and DUT2 route IPv4 over Vhost to LISP GPE tunnel using IPsec (transport) on lisp_gpe0 Int. |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 6.0.1.1/24 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::2 mac fa:16:3e:6e:17:58 |br| ip_neighbor_add_del sw_if_index 1 dst 6.0.1.2 mac fa:16:3e:87:a4:72 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6.0.1.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 6.0.2.0/24 seid 6.0.1.0/24 rloc 2001:cdba:3::2 |br| lisp_add_del_adjacency add vni 0 reid 6.0.2.0/24 leid 6.0.1.0/24 |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_add_del_address sw_if_index 8 6.0.1.3/24 |br| sw_interface_set_flags sw_if_index 7 admin-up |br| sw_interface_set_flags sw_if_index 8 admin-up |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0 enable |br| sw_interface_set_flags sw_if_index 7 admin-up |br| sw_interface_set_l2_bridge sw_if_index 7 bd_id 10 shg 0 enable |br| sw_interface_dump |br| sw_interface_dump |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 4332445a687537307654564263797134 integ_alg sha1-96 integ_key 494e36316a4149434e4653387233714b4e324f78  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 4332445a687537307654564263797134 integ_alg sha1-96 integ_key 494e36316a4149434e4653387233714b4e324f78  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 5 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 2001:cdba:3::1 laddr_stop 2001:cdba:3::1 raddr_start 2001:cdba:3::2 raddr_stop 2001:cdba:3::2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 2001:cdba:3::1 laddr_stop 2001:cdba:3::1 raddr_start 2001:cdba:3::2 raddr_stop 2001:cdba:3::2  |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::2/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 6.0.2.1/24 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 6.0.2.2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::1 mac fa:16:3e:d7:aa:2b |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 6.0.2.0/24 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 6.0.1.0/24 seid 6.0.2.0/24 rloc 2001:cdba:3::1 |br| lisp_add_del_adjacency add vni 0 reid 6.0.1.0/24 leid 6.0.2.0/24 |br| sw_interface_dump |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1000 crypto_alg aes-cbc-128 crypto_key 4332445a687537307654564263797134 integ_alg sha1-96 integ_key 494e36316a4149434e4653387233714b4e324f78  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1001 crypto_alg aes-cbc-128 crypto_key 4332445a687537307654564263797134 integ_alg sha1-96 integ_key 494e36316a4149434e4653387233714b4e324f78  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 5 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 2001:cdba:3::2 laddr_stop 2001:cdba:3::2 raddr_start 2001:cdba:3::1 raddr_stop 2001:cdba:3::1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 2001:cdba:3::2 laddr_stop 2001:cdba:3::2 raddr_start 2001:cdba:3::1 raddr_stop 2001:cdba:3::1  |br|  |preout|  |
+--------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6ipsectptlispgpe-ip6base-eth-2vhost-1vm-func
.......................................................

**IPv6 - ip6-ipsec-lispgpe-ip6 - main fib, vrf (gpe_vni-to-vrf), phy2lisp, virt2lisp**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv6-IPSec-LISPGPE-IPv6-ICMPv6,  

 - **[Cfg] DUT configuration:** Each DUT is configured with LISP and IPsec. IPsec is in transport mode. Tests cases are for IPsec configured both on RLOC interface or lisp_gpe0 interface.  

 - **[Ver] TG verification:** Packet is send from TG(if1) across the DUT1 via VM to DUT2 where it is forwarded to TG(if2).  

 - **[Ref] Applicable standard specifications:** RFC6830, RFC4303.

+--------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                   | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+========================================================================================================+===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv6 over Vhost to LISP GPE tunnel using IPsec (transport) on RLOC Int.      |  |prein| **DUT1:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:1::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:1::2 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::2 mac fa:16:3e:6e:17:58 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_add_del_address sw_if_index 6 2001:cdba:1::9/64 |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_ip6nd_ra_config sw_if_index 6 surpress |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 10 shg 0 enable |br| sw_interface_dump |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 2001:cdba:1::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 2001:cdba:2::0/64 seid 2001:cdba:1::0/64 rloc 2001:cdba:3::2 |br| lisp_add_del_adjacency add vni 0 reid 2001:cdba:2::0/64 leid 2001:cdba:1::0/64 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 66486e54515078533579394330655252 integ_alg sha1-96 integ_key 57387a7666414178336d316546375939666e4c44  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 66486e54515078533579394330655252 integ_alg sha1-96 integ_key 57387a7666414178336d316546375939666e4c44  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 3 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 2001:cdba:3::1 laddr_stop 2001:cdba:3::1 raddr_start 2001:cdba:3::2 raddr_stop 2001:cdba:3::2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 2001:cdba:3::1 laddr_stop 2001:cdba:3::1 raddr_start 2001:cdba:3::2 raddr_stop 2001:cdba:3::2  |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::2/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:2::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:2::2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::1 mac fa:16:3e:d7:aa:2b |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 2001:cdba:2::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 2001:cdba:1::0/64 seid 2001:cdba:2::0/64 rloc 2001:cdba:3::1 |br| lisp_add_del_adjacency add vni 0 reid 2001:cdba:1::0/64 leid 2001:cdba:2::0/64 |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1000 crypto_alg aes-cbc-128 crypto_key 66486e54515078533579394330655252 integ_alg sha1-96 integ_key 57387a7666414178336d316546375939666e4c44  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1001 crypto_alg aes-cbc-128 crypto_key 66486e54515078533579394330655252 integ_alg sha1-96 integ_key 57387a7666414178336d316546375939666e4c44  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 3 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 2001:cdba:3::2 laddr_stop 2001:cdba:3::2 raddr_start 2001:cdba:3::1 raddr_stop 2001:cdba:3::1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 2001:cdba:3::2 laddr_stop 2001:cdba:3::2 raddr_start 2001:cdba:3::1 raddr_stop 2001:cdba:3::1  |br|  |preout|                                                |
+--------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT1 and DUT2 route IPv6 over Vhost to LISP GPE tunnel using IPsec (transport) on lisp_gpe0 Int. |  |prein| **DUT1:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:1::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:1::2 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::2 mac fa:16:3e:6e:17:58 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_add_del_address sw_if_index 6 2001:cdba:1::9/64 |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_ip6nd_ra_config sw_if_index 6 surpress |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 10 shg 0 enable |br| sw_interface_dump |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 2001:cdba:1::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 2001:cdba:2::0/64 seid 2001:cdba:1::0/64 rloc 2001:cdba:3::2 |br| lisp_add_del_adjacency add vni 0 reid 2001:cdba:2::0/64 leid 2001:cdba:1::0/64 |br| sw_interface_dump |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1001 crypto_alg aes-cbc-128 crypto_key 31435466556256765531667232725370 integ_alg sha1-96 integ_key 76544a37795445364736636b594e767036524872  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1000 crypto_alg aes-cbc-128 crypto_key 31435466556256765531667232725370 integ_alg sha1-96 integ_key 76544a37795445364736636b594e767036524872  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 7 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 2001:cdba:3::1 laddr_stop 2001:cdba:3::1 raddr_start 2001:cdba:3::2 raddr_stop 2001:cdba:3::2  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 2001:cdba:3::1 laddr_stop 2001:cdba:3::1 raddr_start 2001:cdba:3::2 raddr_stop 2001:cdba:3::2  |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::2/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:2::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:2::2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::1 mac fa:16:3e:d7:aa:2b |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 2001:cdba:2::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 2001:cdba:1::0/64 seid 2001:cdba:2::0/64 rloc 2001:cdba:3::1 |br| lisp_add_del_adjacency add vni 0 reid 2001:cdba:1::0/64 leid 2001:cdba:2::0/64 |br| sw_interface_dump |br| ipsec_sad_add_del_entry esp sad_id 10 spi 1000 crypto_alg aes-cbc-128 crypto_key 31435466556256765531667232725370 integ_alg sha1-96 integ_key 76544a37795445364736636b594e767036524872  |br| ipsec_sad_add_del_entry esp sad_id 20 spi 1001 crypto_alg aes-cbc-128 crypto_key 31435466556256765531667232725370 integ_alg sha1-96 integ_key 76544a37795445364736636b594e767036524872  |br| ipsec_spd_add_del spd_id 1 |br| ipsec_interface_add_del_spd sw_if_index 5 spd_id 1 |br| ipsec_spd_add_del_entry spd_id 1 priority 100 inbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 100 outbound action bypass protocol 50  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 inbound action protectsa_id 20 laddr_start 2001:cdba:3::2 laddr_stop 2001:cdba:3::2 raddr_start 2001:cdba:3::1 raddr_stop 2001:cdba:3::1  |br| ipsec_spd_add_del_entry spd_id 1 priority 10 outbound action protectsa_id 10 laddr_start 2001:cdba:3::2 laddr_stop 2001:cdba:3::2 raddr_start 2001:cdba:3::1 raddr_stop 2001:cdba:3::1  |br|  |preout|  |
+--------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6lispgpe-ip6base-eth-2vhost-1vm-func
...............................................

**ip6-lispgpe-ip6 encapsulation test cases**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv6-LISP-IPv6-ICMPv6 on DUT1-DUT2, Eth-IPv6-ICMPv6 on TG-DUTn for IPv6 routing over LISPoIPv6 tunnel.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with IPv6 routing and static routes. LISPoIPv6 tunnel is configured between DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv6 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv6 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC6830.

+--------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                       | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+============================================================================================+====================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv6 bidirectionally over LISP GPE tunnel using vhost interfaces |  |prein| **DUT1:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:1::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:1::2 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::2 mac fa:16:3e:6e:17:58 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 2001:cdba:1::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 2001:cdba:2::0/64 seid 2001:cdba:1::0/64 rloc 2001:cdba:3::2 |br| lisp_add_del_adjacency add vni 0 reid 2001:cdba:2::0/64 leid 2001:cdba:1::0/64 |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_set_table sw_if_index 8 vrf 0 ipv6 |br| sw_interface_add_del_address sw_if_index 8 2001:cdba:1::9/64 |br| sw_interface_set_flags sw_if_index 8 admin-up |br| sw_interface_set_flags sw_if_index 7 admin-up |br| sw_interface_set_flags sw_if_index 8 admin-up |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0 enable |br| sw_interface_set_flags sw_if_index 7 admin-up |br| sw_interface_set_l2_bridge sw_if_index 7 bd_id 10 shg 0 enable |br| sw_interface_dump |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::2/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:2::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:2::2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::1 mac fa:16:3e:d7:aa:2b |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 2001:cdba:2::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 2001:cdba:1::0/64 seid 2001:cdba:2::0/64 rloc 2001:cdba:3::1 |br| lisp_add_del_adjacency add vni 0 reid 2001:cdba:1::0/64 leid 2001:cdba:2::0/64 |br|  |preout|  |
+--------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6lispgpe-ip6basevrf-eth-2vhost-1vm-func
..................................................

**ip6-lispgpe-ip6 encapsulation test cases**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv6-LISP-IPv6-ICMPv6 on DUT1-DUT2, Eth-IPv6-ICMPv6 on TG-DUTn for IPv6 routing over LISPoIPv6 tunnel.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with IPv6 routing and static routes. LISPoIPv6 tunnel is configured between DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv6 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv6 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC6830.

+---------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                          | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
+===============================================================================================================+==============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv6 bidirectionally over LISP GPE tunnel using vhost interfaces and VRF is enabled |  |prein| **DUT1:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 1 ipv6 |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:1::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:1::2 mac fa:16:3e:87:a4:72 |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::2 mac fa:16:3e:6e:17:58 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 1 vrf 1 |br| lisp_add_del_local_eid vni 1 eid 2001:cdba:1::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 1 eid 2001:cdba:2::0/64 seid 2001:cdba:1::0/64 rloc 2001:cdba:3::2 |br| lisp_add_del_adjacency add vni 1 reid 2001:cdba:2::0/64 leid 2001:cdba:1::0/64 |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_set_table sw_if_index 9 vrf 1 ipv6 |br| sw_interface_add_del_address sw_if_index 9 2001:cdba:1::9/64 |br| sw_interface_set_flags sw_if_index 9 admin-up |br| sw_interface_set_flags sw_if_index 8 admin-up |br| sw_interface_set_flags sw_if_index 9 admin-up |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0 enable |br| sw_interface_set_flags sw_if_index 8 admin-up |br| sw_interface_set_l2_bridge sw_if_index 8 bd_id 10 shg 0 enable |br| sw_interface_dump |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 1 ipv6 |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::2/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:2::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:2::2 mac fa:16:3e:44:bb:1f |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::1 mac fa:16:3e:d7:aa:2b |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 1 vrf 1 |br| lisp_add_del_local_eid vni 1 eid 2001:cdba:2::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 1 eid 2001:cdba:1::0/64 seid 2001:cdba:2::0/64 rloc 2001:cdba:3::1 |br| lisp_add_del_adjacency add vni 1 reid 2001:cdba:1::0/64 leid 2001:cdba:2::0/64 |br|  |preout|  |
+---------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

interfaces
``````````



api-crud-tap-func
'''''''''''''''''

**Tap Interface CRUD Tests**  

 - **[Top] Network Topologies:** TG=DUT1 2-node topology with two links between nodes.  

 - **[Enc] Packet Encapsulations:** No packet sent.  

 - **[Cfg] DUT configuration:** Add/Modify/Delete linux-TAP on DUT1.  

 - **[Ver] Verification:** Check dump of tap interfaces for correctness.  

 - **[Ref] Applicable standard specifications:**

+---------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                  | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+=======================================+=======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: Tap Interface Modify And Delete |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| tap_connect tapname tap_int1 |br| tap_connect tapname tap_int2 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| tap_modify sw_if_index 5 tapname tap_int1MOD |br| sw_interface_tap_dump |br| tap_delete sw_if_index 5 |br| sw_interface_tap_dump |br| sw_interface_tap_dump |br| tap_delete sw_if_index 6 |br| sw_interface_tap_dump |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+---------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-eth-l2bdbasemaclrn-eth-2tap-func
''''''''''''''''''''''''''''''''''''''

**Tap Interface Traffic Tests**  

 - **[Top] Network Topologies:** TG=DUT1 2-node topology with two links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-ICMPv4 for L2 switching of IPv4.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with L2 bridge-domain (L2BD) MAC learning enabled; Split Horizon Groups (SHG) are set depending on test case; Namespaces (NM) are set on DUT1 with attached linux-TAP.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent by TG on link to DUT1; On receipt TG verifies packets for correctness and their IPv4 src-addr, dst-addr, and MAC addresses.  

 - **[Ref] Applicable standard specifications:**

+-------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                          | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
+===============================+=================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: Tap Interface Simple BD |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| tap_connect tapname tap_int1 |br| tap_connect tapname tap_int2 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| bridge_domain_add_del bd_id 19 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| bridge_domain_add_del bd_id 20 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 20 shg 0 enable |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_l2_bridge sw_if_index 2 bd_id 20 shg 0 enable |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 19 shg 0 enable |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 19 shg 0 enable |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+-------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-eth-l2bdbasemaclrn-l2shg-eth-2tap-func
''''''''''''''''''''''''''''''''''''''''''''

**Tap Interface Traffic Tests**  

 - **[Top] Network Topologies:** TG=DUT1 2-node topology with two links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-ICMPv4 for L2 switching of IPv4.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with L2 bridge-domain (L2BD) MAC learning enabled; Split Horizon Groups (SHG) are set depending on test case; Namespaces (NM) are set on DUT1 with attached linux-TAP.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent by TG on link to DUT1; On receipt TG verifies packets for correctness and their IPv4 src-addr, dst-addr, and MAC addresses.  

 - **[Ref] Applicable standard specifications:**

+--------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                             | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
+==================================================+======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: Tap Interface BD - Different Split Horizon |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| tap_connect tapname tap_int1 |br| tap_connect tapname tap_int2 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| bridge_domain_add_del bd_id 21 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_l2_bridge sw_if_index 2 bd_id 21 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 21 shg 2 enable |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 21 shg 3 enable |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+--------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: Tap Interface BD - Same Split Horizon      |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| tap_connect tapname tap_int1 |br| tap_connect tapname tap_int2 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| bridge_domain_add_del bd_id 21 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_l2_bridge sw_if_index 2 bd_id 21 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 21 shg 2 enable |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 21 shg 2 enable |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+--------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4-ip4base-eth-1tap-func
''''''''''''''''''''''''''''''''''

**Tap Interface Traffic Tests**  

 - **[Top] Network Topologies:** TG=DUT1 2-node topology with two links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-ICMPv4 for L2 switching of IPv4.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with L2 bridge-domain (L2BD) MAC learning enabled; Split Horizon Groups (SHG) are set depending on test case; Namespaces (NM) are set on DUT1 with attached linux-TAP.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent by TG on link to DUT1; On receipt TG verifies packets for correctness and their IPv4 src-addr, dst-addr, and MAC addresses.  

 - **[Ref] Applicable standard specifications:**

+-----------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                          | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+===============================================+============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: Tap Interface IP Ping Without Namespace |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| tap_connect tapname tap_int1 |br| sw_interface_add_del_address sw_if_index 5 16.0.10.1/24 |br| sw_interface_add_del_address sw_if_index 2 192.168.0.1/24 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 2 dst 192.168.0.2 mac fa:16:3e:8d:88:a9 |br| ip_neighbor_add_del sw_if_index 5 dst 16.0.10.2 mac 02:00:00:00:00:02 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+-----------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: Tap Interface IP Ping With Namespace    |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| tap_connect tapname tap_int1 |br| sw_interface_add_del_address sw_if_index 5 16.0.10.1/24 |br| sw_interface_add_del_address sw_if_index 2 192.168.0.1/24 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| ip_neighbor_add_del sw_if_index 2 dst 192.168.0.2 mac fa:16:3e:8d:88:a9 |br| ip_neighbor_add_del sw_if_index 5 dst 16.0.10.2 mac 02:00:00:00:00:02 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+-----------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

ip6
```



eth2p-ethip6-ip6base-copblklistbase-func
''''''''''''''''''''''''''''''''''''''''

**COP Security IPv6 Blacklist Tests**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv6-ICMPv6 on all links.  

 - **[Cfg] DUT configuration:** DUT1 is configured with IPv6 routing and static routes. COP security black-lists are applied on DUT1 ingress interface from TG. DUT2 is configured with L2XC.  

 - **[Ver] TG verification:** Test ICMPv6 Echo Request packets are sent in one direction by TG on link to DUT1; on receive TG verifies packets for correctness and drops as applicable.  

 - **[Ref] Applicable standard specifications:**

+---------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
+=====================================================================+=============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT drops IPv6 pkts with COP blacklist set with IPv6 src-addr |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:62::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 3 3ffe:63::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:62::2 mac fa:16:3e:f2:e7:64 |br| ip_neighbor_add_del sw_if_index 3 dst 3ffe:63::2 mac fa:16:3e:f6:75:00 |br| ip_add_del_route 3ffe:64::1/64 via 3ffe:63::2  sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:61::/64 drop vrf 1 create-vrf |br| cop_whitelist_enable_disable sw_if_index 1 ip6 fib-id 1 |br| cop_interface_enable_disable sw_if_index 1  |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| sw_interface_add_del_address sw_if_index 3 3ffe:72::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 3ffe:73::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|  |
+---------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6-ip6base-copwhlistbase-func
'''''''''''''''''''''''''''''''''''''''

**COP Security IPv6 Whitelist Tests**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv6-ICMPv6 on all links.  

 - **[Cfg] DUT configuration:** DUT1 is configured with IPv6 routing and static routes. COP security white-lists are applied on DUT1 ingress interface from TG. DUT2 is configured with L2XC.  

 - **[Ver] TG verification:** Test ICMPv6 Echo Request packets are sent in one direction by TG on link to DUT1; on receive TG verifies packets for correctness and drops as applicable.  

 - **[Ref] Applicable standard specifications:**

+-----------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                  | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
+=======================================================================+==============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT permits IPv6 pkts with COP whitelist set with IPv6 src-addr |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:62::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 3 3ffe:63::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:62::2 mac fa:16:3e:f2:e7:64 |br| ip_neighbor_add_del sw_if_index 3 dst 3ffe:63::2 mac fa:16:3e:f6:75:00 |br| ip_add_del_route 3ffe:64::1/64 via 3ffe:63::2  sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:61::/64 local vrf 1 create-vrf |br| cop_whitelist_enable_disable sw_if_index 1 ip6 fib-id 1 |br| cop_interface_enable_disable sw_if_index 1  |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| sw_interface_add_del_address sw_if_index 3 3ffe:72::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 3ffe:73::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|  |
+-----------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6-ip6base-func
'''''''''''''''''''''''''

**IPv6 routing test cases**  RFC2460 IPv6, RFC4443 ICMPv6, RFC4861 Neighbor Discovery. Encapsulations: Eth-IPv6-ICMPv6 on links TG-DUT1, TG-DUT2, DUT1-DUT2; Eth-IPv6-NS/NA on links TG-DUT. IPv6 routing tests use circular 3-node topology TG - DUT1 - DUT2 - TG with one link between the nodes. DUT1 and DUT2 are configured with IPv6 routing and static routes. Test ICMPv6 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2 and received on TG links on the other side of circular topology. On receive TG verifies packets IPv6 src-addr, dst-addr and MAC addresses.

+-------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                    | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                             |
+=========================================================================+===============================================================================================================================================================================+
| TC01: DUT replies to ICMPv6 Echo Req to its ingress interface           |  |prein| **DUT1:** |br| want_stats enable |br| dump_stats_table |br| dump_stats_table |br| dump_stats_table |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+-------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT replies to ICMPv6 Echo Req pkt with size 64B-to-1500B-incr-1B |  |prein| **DUT1:** |br| no VAT command executed |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                              |
+-------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC04: DUT routes to its egress interface                                |  |prein| **DUT1:** |br| no VAT command executed |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                              |
+-------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC05: DUT1 routes to DUT2 ingress interface                             |  |prein| **DUT1:** |br| no VAT command executed |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                              |
+-------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC06: DUT1 routes to DUT2 egress interface                              |  |prein| **DUT1:** |br| no VAT command executed |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                              |
+-------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC07: DUT1 and DUT2 route between TG interfaces                         |  |prein| **DUT1:** |br| no VAT command executed |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                              |
+-------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC08: DUT replies to IPv6 Neighbor Solicitation                         |  |prein| **DUT1:** |br| no VAT command executed |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                              |
+-------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6-ip6base-iaclbase-func
''''''''''''''''''''''''''''''''''

**IPv6 routing with ingress ACL test cases**  Encapsulations: Eth-IPv6 on links TG-DUT1, TG-DUT2, DUT1-DUT2. IPv6 ingress ACL (iACL) tests use 3-node topology TG - DUT1 - DUT2 - TG with one link between the nodes. DUT1 and DUT2 are configured with IPv6 routing and static routes. DUT1 is configured with iACL on link to TG, iACL classification and permit/deny action are configured on a per test case basis. Test ICMPv6 Echo Request packets are sent in one direction by TG on link to DUT1 and received on TG link to DUT2. On receive TG verifies if packets are dropped, or if received verifies packet IPv6 src-addr, dst-addr and MAC addresses.

+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                           | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
+================================================================================================+=========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT with iACL IPv6 src-addr drops matching pkts                                          |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:62::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 3 3ffe:63::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| ip_neighbor_add_del sw_if_index 3 dst 3ffe:63::2 mac fa:16:3e:f6:75:00 |br| ip_add_del_route 3ffe:64::1/64 via 3ffe:63::2  sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| classify_add_del_table mask l3 ip6 src |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 1 match_n 2 match l3 ip6 src 3ffe:61::1 |br| input_acl_set_interface sw_if_index 1 ip6-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                                                                                                                                                                                                                                                                   |
+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT with iACL IPv6 dst-addr drops matching pkts                                          |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:62::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 3 3ffe:63::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| ip_neighbor_add_del sw_if_index 3 dst 3ffe:63::2 mac fa:16:3e:f6:75:00 |br| ip_add_del_route 3ffe:64::1/64 via 3ffe:63::2  sw_if_index 3 resolve-attempts 10 count 1    |br| ip_add_del_route 3ffe:54::1/64 via 3ffe:63::2  sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| classify_add_del_table mask l3 ip6 dst |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 2 match_n 2 match l3 ip6 dst 3ffe:64::1 |br| input_acl_set_interface sw_if_index 1 ip6-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                                                                                                                                                                  |
+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: DUT with iACL IPv6 src-addr and dst-addr drops matching pkts                             |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:62::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 3 3ffe:63::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| ip_neighbor_add_del sw_if_index 3 dst 3ffe:63::2 mac fa:16:3e:f6:75:00 |br| ip_add_del_route 3ffe:64::1/64 via 3ffe:63::2  sw_if_index 3 resolve-attempts 10 count 1    |br| ip_add_del_route 3ffe:54::1/64 via 3ffe:63::2  sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| classify_add_del_table mask l3 ip6 src |br| classify_add_del_table mask l3 ip6 dst |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 1 match_n 2 match l3 ip6 src 3ffe:61::1 |br| classify_add_del_session acl-hit-next deny table-index 1 skip_n 2 match_n 2 match l3 ip6 dst 3ffe:64::1 |br| input_acl_set_interface sw_if_index 1 ip6-table 0 |br| input_acl_set_interface sw_if_index 1 ip6-table 1 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|  |
+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC04: DUT with iACL IPv6 protocol set to TCP drops matching pkts                               |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:62::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 3 3ffe:63::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| ip_neighbor_add_del sw_if_index 3 dst 3ffe:63::2 mac fa:16:3e:f6:75:00 |br| ip_add_del_route 3ffe:64::1/64 via 3ffe:63::2  sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| classify_add_del_table mask hex 0000000000000000000000000000000000000000FF |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 1 match_n 1 match hex 000000000000000000000000000000000000000006 |br| input_acl_set_interface sw_if_index 1 ip6-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                                                                                                                                                                                                      |
+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC05: DUT with iACL IPv6 protocol set to UDP drops matching pkts                               |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:62::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 3 3ffe:63::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| ip_neighbor_add_del sw_if_index 3 dst 3ffe:63::2 mac fa:16:3e:f6:75:00 |br| ip_add_del_route 3ffe:64::1/64 via 3ffe:63::2  sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| classify_add_del_table mask hex 0000000000000000000000000000000000000000FF |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 1 match_n 1 match hex 000000000000000000000000000000000000000011 |br| input_acl_set_interface sw_if_index 1 ip6-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                                                                                                                                                                                                      |
+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC06: DUT with iACL IPv6 TCP src-ports drops matching pkts                                     |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:62::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 3 3ffe:63::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| ip_neighbor_add_del sw_if_index 3 dst 3ffe:63::2 mac fa:16:3e:f6:75:00 |br| ip_add_del_route 3ffe:64::1/64 via 3ffe:63::2  sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| classify_add_del_table mask hex 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FFFF0000 |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 3 match_n 1 match hex 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000500000 |br| input_acl_set_interface sw_if_index 1 ip6-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                                                  |
+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC07: DUT with iACL IPv6 TCP dst-ports drops matching pkts                                     |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:62::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 3 3ffe:63::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| ip_neighbor_add_del sw_if_index 3 dst 3ffe:63::2 mac fa:16:3e:f6:75:00 |br| ip_add_del_route 3ffe:64::1/64 via 3ffe:63::2  sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| classify_add_del_table mask hex 0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FFFF |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 3 match_n 1 match hex 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000050 |br| input_acl_set_interface sw_if_index 1 ip6-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                                                  |
+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC08: DUT with iACL IPv6 TCP src-ports and dst-ports drops matching pkts                       |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:62::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 3 3ffe:63::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| ip_neighbor_add_del sw_if_index 3 dst 3ffe:63::2 mac fa:16:3e:f6:75:00 |br| ip_add_del_route 3ffe:64::1/64 via 3ffe:63::2  sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| classify_add_del_table mask hex 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FFFFFFFF |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 3 match_n 1 match hex 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000500014 |br| input_acl_set_interface sw_if_index 1 ip6-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                                                  |
+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC09: DUT with iACL IPv6 UDP src-ports drops matching pkts                                     |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:62::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 3 3ffe:63::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| ip_neighbor_add_del sw_if_index 3 dst 3ffe:63::2 mac fa:16:3e:f6:75:00 |br| ip_add_del_route 3ffe:64::1/64 via 3ffe:63::2  sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| classify_add_del_table mask hex 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FFFF0000 |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 3 match_n 1 match hex 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000500000 |br| input_acl_set_interface sw_if_index 1 ip6-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                                                  |
+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC10: DUT with iACL IPv6 UDP dst-ports drops matching pkts                                     |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:62::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 3 3ffe:63::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| ip_neighbor_add_del sw_if_index 3 dst 3ffe:63::2 mac fa:16:3e:f6:75:00 |br| ip_add_del_route 3ffe:64::1/64 via 3ffe:63::2  sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| classify_add_del_table mask hex 0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FFFF |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 3 match_n 1 match hex 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000050 |br| input_acl_set_interface sw_if_index 1 ip6-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                                                  |
+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC11: DUT with iACL IPv6 UDP src-ports and dst-ports drops matching pkts                       |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:62::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 3 3ffe:63::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| ip_neighbor_add_del sw_if_index 3 dst 3ffe:63::2 mac fa:16:3e:f6:75:00 |br| ip_add_del_route 3ffe:64::1/64 via 3ffe:63::2  sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| classify_add_del_table mask hex 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FFFFFFFF |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 3 match_n 1 match hex 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000500014 |br| input_acl_set_interface sw_if_index 1 ip6-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                                                  |
+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC12: DUT with iACL MAC src-addr and iACL IPv6 UDP src-ports and dst-ports drops matching pkts |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| classify_add_del_table mask l2 src |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 0 match_n 1 match l2 src fa:16:3e:f2:e7:64 |br| classify_add_del_table mask hex 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FFFFFFFF |br| classify_add_del_session acl-hit-next deny table-index 1 skip_n 3 match_n 1 match hex 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000500014 |br| input_acl_set_interface sw_if_index 1 l2-table 1 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                                                                                                            |
+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6-ip6base-ip6dhcpproxy-func
''''''''''''''''''''''''''''''''''''''

**DHCPv6 proxy test cases**   

 - **[Top] Network Topologies:** TG = DUT with two links between the nodes.  

 - **[Cfg] DUT configuration:** DUT is configured with DHCPv6 proxy.  

 - **[Ver] TG verification:** Test DHCPv6 packets are sent on TG on first link to DUT and received on TG on second link. On receive TG verifies if DHCPv6 packets are valid  

 - **[Ref] Applicable standard specifications:** RFC 3315

+---------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                    | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
+=========================================================+=========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: VPP proxies valid DHCPv6 request to DHCPv6 server |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 3ffe:62::1/64 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_add_del_address sw_if_index 1 3ffe:63::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_add_del_route ff02::1:2/128   local  count 1    |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:63::2 mac fa:16:3e:f2:e7:64 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| dhcp_proxy_config svr 3ffe:63::2 src 3ffe:62::1 |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|  |
+---------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6-ip6base-ip6ecmp-func
'''''''''''''''''''''''''''''''''

**Ipv6 Multipath routing test cases**   

 - **[Top] Network topologies:** TG=DUT 2-node topology with two links between nodes.  

 - **[Cfg] DUT configuration:** On DUT configure interfaces IPv4 adresses, and multipath routing.  

 - **[Ver] TG verification:** Test packets are sent from TG on the first link to DUT. Packet is received on TG on the second link from DUT1.

+-----------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                    | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
+=========================================+======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: IPv6 Equal-cost multipath routing |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:61::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_add_del_address sw_if_index 2 3ffe:62::1/64 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| ip_neighbor_add_del sw_if_index 2 dst 3ffe:62::2 mac 02:00:00:00:00:02 |br| ip_neighbor_add_del sw_if_index 2 dst 3ffe:62::3 mac 02:00:00:00:00:03 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| ip_add_del_route 3ffe:71::1/64 via 3ffe:62::2  sw_if_index 2  count 1  multipath  |br| ip_add_del_route 3ffe:71::1/64 via 3ffe:62::3  sw_if_index 2  count 1  multipath  |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|  |
+-----------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6-ip6base-ip6ra-func
'''''''''''''''''''''''''''''''

**IPv6 Router Advertisement test cases**  RFC4861 Neighbor Discovery. Encapsulations: Eth-IPv6-RA on links TG-DUT1. IPv6 Router Advertisement tests use 3-node topology TG - DUT1 - DUT2 - TG with one link between the nodes. DUT1 and DUT2 are configured with IPv6 routing and static routes. TG verifies received RA packets.

+--------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                           | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                             |
+================================================================================+===============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT transmits RA on IPv6 enabled interface                               |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:62::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_ip6nd_ra_config sw_if_index 1 interval 2 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|  |
+--------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT retransmits RA on IPv6 enabled interface after a set interval        |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:62::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_ip6nd_ra_config sw_if_index 1 interval 2 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|  |
+--------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: DUT responds to Router Solicitation request                              |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:62::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|    |
+--------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC04: DUT responds to Router Solicitation request sent from link local address |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 1 3ffe:62::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br|  |preout|    |
+--------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6-ip6base-ipolicemarkbase-func
'''''''''''''''''''''''''''''''''''''''''

**IPv6 policer test cases**   

 - **[Top] Network topologies:** TG=DUT1 2-node topology with two links between nodes.  

 - **[Cfg] DUT configuration:** On DUT1 configure interfaces IPv6 adresses, and static neighbor record on the second interface.  

 - **[Ver] TG verification:** Test packet is sent from TG on the first link to DUT1. Packet is received on TG on the second link from DUT1.  

 - **[Ref] Applicable standard specifications:** RFC2474, RFC2697, RFC2698.

+-------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                            | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
+=================================================+================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: VPP policer 2R3C Color-aware marks packet |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 3ffe:5f::1/64 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_add_del_address sw_if_index 1 3ffe:60::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:60::2 mac fa:16:3e:f2:e7:64 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| policer_add_del name policer1  cir 100 eir 150 cb 200 eb 300 rate_type pps round_type closest type 2r3c-2698 conform_action transmit exceed_action mark-and-transmit AF22 violate_action drop color-aware |br| classify_add_del_table mask l3 ip6 src |br| classify_add_del_session policer-hit-next 0 exceed-color table-index 0 skip_n 1 match_n 2 match l3 ip6 src 3ffe:5f::2 |br| policer_classify_set_interface sw_if_index 2 ip6-table 0 |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|  |
+-------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: VPP policer 2R3C Color-blind marks packet |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 3ffe:5f::1/64 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_add_del_address sw_if_index 1 3ffe:60::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:60::2 mac fa:16:3e:f2:e7:64 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| policer_add_del name policer1  cir 100 eir 150 cb 200 eb 300 rate_type pps round_type closest type 2r3c-2698 conform_action mark-and-transmit AF22 exceed_action transmit violate_action drop  |br| classify_add_del_table mask l3 ip6 src |br| classify_add_del_session policer-hit-next 0 conform-color table-index 0 skip_n 1 match_n 2 match l3 ip6 src 3ffe:5f::2 |br| policer_classify_set_interface sw_if_index 2 ip6-table 0 |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|            |
+-------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: VPP policer 1R3C Color-aware marks packet |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 3ffe:5f::1/64 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_add_del_address sw_if_index 1 3ffe:60::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:60::2 mac fa:16:3e:f2:e7:64 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| policer_add_del name policer1  cir 1 eir 0 cb 2 eb 300 rate_type pps round_type closest type 1r3c conform_action transmit exceed_action mark-and-transmit AF22 violate_action drop color-aware |br| classify_add_del_table mask l3 ip6 src |br| classify_add_del_session policer-hit-next 0 exceed-color table-index 0 skip_n 1 match_n 2 match l3 ip6 src 3ffe:5f::2 |br| policer_classify_set_interface sw_if_index 2 ip6-table 0 |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|             |
+-------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC04: VPP policer 1R3C Color-blind marks packet |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 3ffe:5f::1/64 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_add_del_address sw_if_index 1 3ffe:60::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 3ffe:60::2 mac fa:16:3e:f2:e7:64 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| policer_add_del name policer1  cir 100 eir 0 cb 200 eb 0 rate_type pps round_type closest type 1r3c conform_action mark-and-transmit AF22 exceed_action transmit violate_action drop  |br| classify_add_del_table mask l3 ip6 src |br| classify_add_del_session policer-hit-next 0 conform-color table-index 0 skip_n 1 match_n 2 match l3 ip6 src 3ffe:5f::2 |br| policer_classify_set_interface sw_if_index 2 ip6-table 0 |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|                     |
+-------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6-ip6basevrf-func
''''''''''''''''''''''''''''

**Vpn routed forwarding - baseline IPv6**  

 - **[Top] Network Topologies:** TG=DUT1=DUT2=TG 3-node topology with two links in between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv6-ICMPv6  

 - **[Cfg] DUT configuration:** Each DUT is configured with two VRF tables; Separation of traffic is tested by IP packets; Neighbors and Routes are set on DUT nodes; IP addresses are set on DUT interfaces.  

 - **[Ver] TG verification:** Test ICMPv6 Echo Request packets are sent by TG on link to DUT1, DUT2 or back to TG; On receipt TG verifies packets for correctness and their IPv6 src-addr, dst-addr, and MAC addresses.  

 - **[Ref] Applicable standard specifications:**

+----------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                         | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
+==============================================================================================+=============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: TG packets routed to DUT ingress interface, VPP configured with two VRFs               |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 4 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 4 vrf 9 ipv6 |br| sw_interface_set_table sw_if_index 3 vrf 99 ipv6 |br| sw_interface_set_table sw_if_index 2 vrf 9 ipv6 |br| sw_interface_set_table sw_if_index 1 vrf 99 ipv6 |br| sw_interface_add_del_address sw_if_index 2 2001:62::3/64 |br| sw_interface_add_del_address sw_if_index 1 2001:62::4/64 |br| sw_interface_add_del_address sw_if_index 4 2002:62::1/64 |br| sw_interface_add_del_address sw_if_index 3 2002:62::2/64 |br| ip_neighbor_add_del sw_if_index 2 dst 2001:62::1 mac fa:16:3e:8d:88:a9 |br| ip_neighbor_add_del sw_if_index 4 dst 2002:62::3 mac fa:16:3e:8b:49:db |br| ip_neighbor_add_del sw_if_index 1 dst 2001:62::2 mac fa:16:3e:f2:e7:64 |br| ip_neighbor_add_del sw_if_index 3 dst 2002:62::4 mac fa:16:3e:cf:db:ca |br| ip_add_del_route 2003:62::1/64 via 2002:62::3 vrf 9 sw_if_index 4 resolve-attempts 10 count 1    |br| ip_add_del_route 2003:62::2/64 via 2002:62::4 vrf 99 sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 4 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 4 vrf 9 ipv6 |br| sw_interface_set_table sw_if_index 3 vrf 99 ipv6 |br| sw_interface_set_table sw_if_index 2 vrf 9 ipv6 |br| sw_interface_set_table sw_if_index 1 vrf 99 ipv6 |br| sw_interface_add_del_address sw_if_index 2 2003:62::3/64 |br| sw_interface_add_del_address sw_if_index 1 2003:62::4/64 |br| sw_interface_add_del_address sw_if_index 4 2002:62::3/64 |br| sw_interface_add_del_address sw_if_index 3 2002:62::4/64 |br| ip_neighbor_add_del sw_if_index 2 dst 2003:62::1 mac fa:16:3e:1f:e5:69 |br| ip_neighbor_add_del sw_if_index 4 dst 2002:62::1 mac fa:16:3e:d0:92:0c |br| ip_neighbor_add_del sw_if_index 1 dst 2003:62::2 mac fa:16:3e:f6:75:00 |br| ip_neighbor_add_del sw_if_index 3 dst 2002:62::2 mac fa:16:3e:a6:a9:91 |br| ip_add_del_route 2001:62::1/64 via 2002:62::1 vrf 9 sw_if_index 4 resolve-attempts 10 count 1    |br| ip_add_del_route 2001:62::2/64 via 2002:62::2 vrf 99 sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|  |
+----------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: TG packets routed to DUT egress interface, VPP configured with two VRFs                |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 4 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 4 vrf 9 ipv6 |br| sw_interface_set_table sw_if_index 3 vrf 99 ipv6 |br| sw_interface_set_table sw_if_index 2 vrf 9 ipv6 |br| sw_interface_set_table sw_if_index 1 vrf 99 ipv6 |br| sw_interface_add_del_address sw_if_index 2 2001:62::3/64 |br| sw_interface_add_del_address sw_if_index 1 2001:62::4/64 |br| sw_interface_add_del_address sw_if_index 4 2002:62::1/64 |br| sw_interface_add_del_address sw_if_index 3 2002:62::2/64 |br| ip_neighbor_add_del sw_if_index 2 dst 2001:62::1 mac fa:16:3e:8d:88:a9 |br| ip_neighbor_add_del sw_if_index 4 dst 2002:62::3 mac fa:16:3e:8b:49:db |br| ip_neighbor_add_del sw_if_index 1 dst 2001:62::2 mac fa:16:3e:f2:e7:64 |br| ip_neighbor_add_del sw_if_index 3 dst 2002:62::4 mac fa:16:3e:cf:db:ca |br| ip_add_del_route 2003:62::1/64 via 2002:62::3 vrf 9 sw_if_index 4 resolve-attempts 10 count 1    |br| ip_add_del_route 2003:62::2/64 via 2002:62::4 vrf 99 sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 4 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 4 vrf 9 ipv6 |br| sw_interface_set_table sw_if_index 3 vrf 99 ipv6 |br| sw_interface_set_table sw_if_index 2 vrf 9 ipv6 |br| sw_interface_set_table sw_if_index 1 vrf 99 ipv6 |br| sw_interface_add_del_address sw_if_index 2 2003:62::3/64 |br| sw_interface_add_del_address sw_if_index 1 2003:62::4/64 |br| sw_interface_add_del_address sw_if_index 4 2002:62::3/64 |br| sw_interface_add_del_address sw_if_index 3 2002:62::4/64 |br| ip_neighbor_add_del sw_if_index 2 dst 2003:62::1 mac fa:16:3e:1f:e5:69 |br| ip_neighbor_add_del sw_if_index 4 dst 2002:62::1 mac fa:16:3e:d0:92:0c |br| ip_neighbor_add_del sw_if_index 1 dst 2003:62::2 mac fa:16:3e:f6:75:00 |br| ip_neighbor_add_del sw_if_index 3 dst 2002:62::2 mac fa:16:3e:a6:a9:91 |br| ip_add_del_route 2001:62::1/64 via 2002:62::1 vrf 9 sw_if_index 4 resolve-attempts 10 count 1    |br| ip_add_del_route 2001:62::2/64 via 2002:62::2 vrf 99 sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|  |
+----------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: TG packets routed to DUT2 ingress interface through DUT1, VPP configured with two VRFs |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 4 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 4 vrf 9 ipv6 |br| sw_interface_set_table sw_if_index 3 vrf 99 ipv6 |br| sw_interface_set_table sw_if_index 2 vrf 9 ipv6 |br| sw_interface_set_table sw_if_index 1 vrf 99 ipv6 |br| sw_interface_add_del_address sw_if_index 2 2001:62::3/64 |br| sw_interface_add_del_address sw_if_index 1 2001:62::4/64 |br| sw_interface_add_del_address sw_if_index 4 2002:62::1/64 |br| sw_interface_add_del_address sw_if_index 3 2002:62::2/64 |br| ip_neighbor_add_del sw_if_index 2 dst 2001:62::1 mac fa:16:3e:8d:88:a9 |br| ip_neighbor_add_del sw_if_index 4 dst 2002:62::3 mac fa:16:3e:8b:49:db |br| ip_neighbor_add_del sw_if_index 1 dst 2001:62::2 mac fa:16:3e:f2:e7:64 |br| ip_neighbor_add_del sw_if_index 3 dst 2002:62::4 mac fa:16:3e:cf:db:ca |br| ip_add_del_route 2003:62::1/64 via 2002:62::3 vrf 9 sw_if_index 4 resolve-attempts 10 count 1    |br| ip_add_del_route 2003:62::2/64 via 2002:62::4 vrf 99 sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 4 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 4 vrf 9 ipv6 |br| sw_interface_set_table sw_if_index 3 vrf 99 ipv6 |br| sw_interface_set_table sw_if_index 2 vrf 9 ipv6 |br| sw_interface_set_table sw_if_index 1 vrf 99 ipv6 |br| sw_interface_add_del_address sw_if_index 2 2003:62::3/64 |br| sw_interface_add_del_address sw_if_index 1 2003:62::4/64 |br| sw_interface_add_del_address sw_if_index 4 2002:62::3/64 |br| sw_interface_add_del_address sw_if_index 3 2002:62::4/64 |br| ip_neighbor_add_del sw_if_index 2 dst 2003:62::1 mac fa:16:3e:1f:e5:69 |br| ip_neighbor_add_del sw_if_index 4 dst 2002:62::1 mac fa:16:3e:d0:92:0c |br| ip_neighbor_add_del sw_if_index 1 dst 2003:62::2 mac fa:16:3e:f6:75:00 |br| ip_neighbor_add_del sw_if_index 3 dst 2002:62::2 mac fa:16:3e:a6:a9:91 |br| ip_add_del_route 2001:62::1/64 via 2002:62::1 vrf 9 sw_if_index 4 resolve-attempts 10 count 1    |br| ip_add_del_route 2001:62::2/64 via 2002:62::2 vrf 99 sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|  |
+----------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC04: TG packets routed to DUT2 egress interface through DUT1, VPP configured with two VRFs  |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 4 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 4 vrf 9 ipv6 |br| sw_interface_set_table sw_if_index 3 vrf 99 ipv6 |br| sw_interface_set_table sw_if_index 2 vrf 9 ipv6 |br| sw_interface_set_table sw_if_index 1 vrf 99 ipv6 |br| sw_interface_add_del_address sw_if_index 2 2001:62::3/64 |br| sw_interface_add_del_address sw_if_index 1 2001:62::4/64 |br| sw_interface_add_del_address sw_if_index 4 2002:62::1/64 |br| sw_interface_add_del_address sw_if_index 3 2002:62::2/64 |br| ip_neighbor_add_del sw_if_index 2 dst 2001:62::1 mac fa:16:3e:8d:88:a9 |br| ip_neighbor_add_del sw_if_index 4 dst 2002:62::3 mac fa:16:3e:8b:49:db |br| ip_neighbor_add_del sw_if_index 1 dst 2001:62::2 mac fa:16:3e:f2:e7:64 |br| ip_neighbor_add_del sw_if_index 3 dst 2002:62::4 mac fa:16:3e:cf:db:ca |br| ip_add_del_route 2003:62::1/64 via 2002:62::3 vrf 9 sw_if_index 4 resolve-attempts 10 count 1    |br| ip_add_del_route 2003:62::2/64 via 2002:62::4 vrf 99 sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 4 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 4 vrf 9 ipv6 |br| sw_interface_set_table sw_if_index 3 vrf 99 ipv6 |br| sw_interface_set_table sw_if_index 2 vrf 9 ipv6 |br| sw_interface_set_table sw_if_index 1 vrf 99 ipv6 |br| sw_interface_add_del_address sw_if_index 2 2003:62::3/64 |br| sw_interface_add_del_address sw_if_index 1 2003:62::4/64 |br| sw_interface_add_del_address sw_if_index 4 2002:62::3/64 |br| sw_interface_add_del_address sw_if_index 3 2002:62::4/64 |br| ip_neighbor_add_del sw_if_index 2 dst 2003:62::1 mac fa:16:3e:1f:e5:69 |br| ip_neighbor_add_del sw_if_index 4 dst 2002:62::1 mac fa:16:3e:d0:92:0c |br| ip_neighbor_add_del sw_if_index 1 dst 2003:62::2 mac fa:16:3e:f6:75:00 |br| ip_neighbor_add_del sw_if_index 3 dst 2002:62::2 mac fa:16:3e:a6:a9:91 |br| ip_add_del_route 2001:62::1/64 via 2002:62::1 vrf 9 sw_if_index 4 resolve-attempts 10 count 1    |br| ip_add_del_route 2001:62::2/64 via 2002:62::2 vrf 99 sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|  |
+----------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC05: TG packets routed to TG through DUT1 and DUT2, VPP configured with two VRFs            |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 4 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 4 vrf 9 ipv6 |br| sw_interface_set_table sw_if_index 3 vrf 99 ipv6 |br| sw_interface_set_table sw_if_index 2 vrf 9 ipv6 |br| sw_interface_set_table sw_if_index 1 vrf 99 ipv6 |br| sw_interface_add_del_address sw_if_index 2 2001:62::3/64 |br| sw_interface_add_del_address sw_if_index 1 2001:62::4/64 |br| sw_interface_add_del_address sw_if_index 4 2002:62::1/64 |br| sw_interface_add_del_address sw_if_index 3 2002:62::2/64 |br| ip_neighbor_add_del sw_if_index 2 dst 2001:62::1 mac fa:16:3e:8d:88:a9 |br| ip_neighbor_add_del sw_if_index 4 dst 2002:62::3 mac fa:16:3e:8b:49:db |br| ip_neighbor_add_del sw_if_index 1 dst 2001:62::2 mac fa:16:3e:f2:e7:64 |br| ip_neighbor_add_del sw_if_index 3 dst 2002:62::4 mac fa:16:3e:cf:db:ca |br| ip_add_del_route 2003:62::1/64 via 2002:62::3 vrf 9 sw_if_index 4 resolve-attempts 10 count 1    |br| ip_add_del_route 2003:62::2/64 via 2002:62::4 vrf 99 sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 4 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 4 vrf 9 ipv6 |br| sw_interface_set_table sw_if_index 3 vrf 99 ipv6 |br| sw_interface_set_table sw_if_index 2 vrf 9 ipv6 |br| sw_interface_set_table sw_if_index 1 vrf 99 ipv6 |br| sw_interface_add_del_address sw_if_index 2 2003:62::3/64 |br| sw_interface_add_del_address sw_if_index 1 2003:62::4/64 |br| sw_interface_add_del_address sw_if_index 4 2002:62::3/64 |br| sw_interface_add_del_address sw_if_index 3 2002:62::4/64 |br| ip_neighbor_add_del sw_if_index 2 dst 2003:62::1 mac fa:16:3e:1f:e5:69 |br| ip_neighbor_add_del sw_if_index 4 dst 2002:62::1 mac fa:16:3e:d0:92:0c |br| ip_neighbor_add_del sw_if_index 1 dst 2003:62::2 mac fa:16:3e:f6:75:00 |br| ip_neighbor_add_del sw_if_index 3 dst 2002:62::2 mac fa:16:3e:a6:a9:91 |br| ip_add_del_route 2001:62::1/64 via 2002:62::1 vrf 9 sw_if_index 4 resolve-attempts 10 count 1    |br| ip_add_del_route 2001:62::2/64 via 2002:62::2 vrf 99 sw_if_index 3 resolve-attempts 10 count 1    |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br|  |preout|  |
+----------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

ip6 tunnels
```````````



lisp
''''



eth2p-ethip6lisp-l2bdbasemaclrn-func
....................................

**l2-lispgpe-ip6 encapsulation test cases**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IP6-ICMPv6-LISPGpe-IP6  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with L2 bridge domains and neighbors. LISPoIPv6 tunnel is configured between DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv6 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv6 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC6830.

+----------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                           | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
+================================================================+===============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: Route IPv6 packet through LISP with Bridge Domain setup. |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::1/64 |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:1::1/64 |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:1::2 mac fa:16:3e:f2:e7:64 |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::2 mac fa:16:3e:cf:db:ca |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0 enable |br| lisp_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 5 bd_index 10 |br| lisp_add_del_local_eid vni 5 eid 08:22:22:22:22:11 locator-set tst_locator |br| lisp_add_del_map_resolver 2001:cdba:2::2 |br| lisp_add_del_remote_mapping add vni 5 eid 08:22:22:22:22:22 seid 08:22:22:22:22:11 rloc 2001:cdba:3::2 |br| lisp_add_del_adjacency add vni 5 reid 08:22:22:22:22:22 leid 08:22:22:22:22:11 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::2/64 |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:2::1/64 |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:2::2 mac fa:16:3e:f6:75:00 |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::1 mac fa:16:3e:a6:a9:91 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0 enable |br| lisp_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 5 bd_index 10 |br| lisp_add_del_local_eid vni 5 eid 08:22:22:22:22:22 locator-set tst_locator |br| lisp_add_del_map_resolver 2001:cdba:1::2 |br| lisp_add_del_remote_mapping add vni 5 eid 08:22:22:22:22:11 seid 08:22:22:22:22:22 rloc 2001:cdba:3::1 |br| lisp_add_del_adjacency add vni 5 reid 08:22:22:22:22:11 leid 08:22:22:22:22:22 |br|  |preout|  |
+----------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6lispgpe-ip4base-func
................................

**LISP static adjacency test cases**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv6-LISP-IPv4-ICMPv4 on DUT1-DUT2, Eth-IPv4-ICMPv4 on TG-DUTn for IPv4 routing over LISPoIPv6 tunnel.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with IPv4 routing and static routes. LISPoIPv6 tunnel is configured between DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC6830.

+----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                 | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+======================================================================+============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv4 bidirectionally over LISPoIPv6 tunnel |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6:0:3::1/64 |br| sw_interface_add_del_address sw_if_index 1 6.0.1.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 6.0.1.2 mac fa:16:3e:f2:e7:64 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_locator locator-set ls1 sw_if_index 3 p 1 w 1 |br| lisp_add_del_local_eid vni 0 eid 6.0.1.0/24 locator-set ls1 |br| lisp_add_del_remote_mapping add vni 0 eid 6.0.2.0/24 seid 6.0.1.0/24 rloc 6:0:3::2 |br| lisp_add_del_adjacency add vni 0 reid 6.0.2.0/24 leid 6.0.1.0/24 |br| lisp_add_del_remote_mapping del vni 0 eid 6.0.2.0/24 seid 6.0.1.0/24 rloc 6:0:3::2 |br| lisp_add_del_adjacency del vni 0 reid 6.0.2.0/24 leid 6.0.1.0/24 |br| ip_neighbor_add_del sw_if_index 3 dst 6:0:3::20 mac fa:16:3e:cf:db:ca |br| lisp_add_del_remote_mapping add vni 0 eid 6.0.2.0/24 seid 6.0.1.0/24 rloc 6:0:3::20 |br| lisp_add_del_adjacency add vni 0 reid 6.0.2.0/24 leid 6.0.1.0/24 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 6:0:3::2/64 |br| sw_interface_add_del_address sw_if_index 1 6.0.2.1/24 |br| ip_neighbor_add_del sw_if_index 1 dst 6.0.2.2 mac fa:16:3e:f6:75:00 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_add_del_locator_set locator-set ls1 |br| lisp_add_del_locator locator-set ls1 sw_if_index 3 p 1 w 1 |br| lisp_add_del_local_eid vni 0 eid 6.0.2.0/24 locator-set ls1 |br| lisp_add_del_remote_mapping add vni 0 eid 6.0.1.0/24 seid 6.0.2.0/24 rloc 6:0:3::1 |br| lisp_add_del_adjacency add vni 0 reid 6.0.1.0/24 leid 6.0.2.0/24 |br| sw_interface_add_del_address sw_if_index 3 del-all |br| sw_interface_add_del_address sw_if_index 3 6:0:3::20/64 |br| ip_neighbor_add_del sw_if_index 3 dst 6:0:3::1 mac fa:16:3e:a6:a9:91 |br|  |preout|  |
+----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6lispgpe-ip6base-func
................................

**ip6-lispgpe-ip6 encapsulation test cases**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv6-LISP-IPv6-ICMPv6 on DUT1-DUT2, Eth-IPv6-ICMPv6 on TG-DUTn for IPv6 routing over LISPoIPv6 tunnel.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with IPv6 routing and static routes. LISPoIPv6 tunnel is configured between DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv6 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv6 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC6830.

+-----------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                          | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+===============================================================================================+===================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv6 bidirectionally over LISP GPE tunnel using physical interfaces |  |prein| **DUT1:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:1::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:1::2 mac fa:16:3e:f2:e7:64 |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::2 mac fa:16:3e:cf:db:ca |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 2001:cdba:1::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 2001:cdba:2::0/64 seid 2001:cdba:1::0/64 rloc 2001:cdba:3::2 |br| lisp_add_del_adjacency add vni 0 reid 2001:cdba:2::0/64 leid 2001:cdba:1::0/64 |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::2/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:2::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:2::2 mac fa:16:3e:f6:75:00 |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::1 mac fa:16:3e:a6:a9:91 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 0 vrf 0 |br| lisp_add_del_local_eid vni 0 eid 2001:cdba:2::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 0 eid 2001:cdba:1::0/64 seid 2001:cdba:2::0/64 rloc 2001:cdba:3::1 |br| lisp_add_del_adjacency add vni 0 reid 2001:cdba:1::0/64 leid 2001:cdba:2::0/64 |br|  |preout|  |
+-----------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6lispgpe-ip6basevrf-func
...................................

**ip6-lispgpe-ip6 encapsulation test cases**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv6-LISP-IPv6-ICMPv6 on DUT1-DUT2, Eth-IPv6-ICMPv6 on TG-DUTn for IPv6 routing over LISPoIPv6 tunnel.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with IPv6 routing and static routes. LISPoIPv6 tunnel is configured between DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv6 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv6 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC6830.

+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                             | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
+==================================================================================================================+=============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 route IPv6 bidirectionally over LISP GPE tunnel using physical interfaces and VRF is enabled |  |prein| **DUT1:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 1 ipv6 |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::1/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:1::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:1::2 mac fa:16:3e:f2:e7:64 |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::2 mac fa:16:3e:cf:db:ca |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 1 vrf 1 |br| lisp_add_del_local_eid vni 1 eid 2001:cdba:1::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 1 eid 2001:cdba:2::0/64 seid 2001:cdba:1::0/64 rloc 2001:cdba:3::2 |br| lisp_add_del_adjacency add vni 1 reid 2001:cdba:2::0/64 leid 2001:cdba:1::0/64 |br|  |br| **DUT2:** |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_table sw_if_index 1 vrf 1 ipv6 |br| sw_interface_add_del_address sw_if_index 3 2001:cdba:3::2/64 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_add_del_address sw_if_index 1 2001:cdba:2::1/64 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| ip_neighbor_add_del sw_if_index 1 dst 2001:cdba:2::2 mac fa:16:3e:f6:75:00 |br| ip_neighbor_add_del sw_if_index 3 dst 2001:cdba:3::1 mac fa:16:3e:a6:a9:91 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| lisp_enable_disable enable |br| lisp_gpe_enable_disable enable |br| lisp_add_del_locator_set locator-set tst_locator |br| lisp_add_del_locator locator-set tst_locator sw_if_index 3 p 1 w 1 |br| lisp_eid_table_add_del_map vni 1 vrf 1 |br| lisp_add_del_local_eid vni 1 eid 2001:cdba:2::0/64 locator-set tst_locator |br| lisp_add_del_remote_mapping add vni 1 eid 2001:cdba:1::0/64 seid 2001:cdba:2::0/64 rloc 2001:cdba:3::1 |br| lisp_add_del_adjacency add vni 1 reid 2001:cdba:1::0/64 leid 2001:cdba:2::0/64 |br|  |preout|  |
+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

l2bd
````



eth2p-dot1ad--dot1q-l2bdbasemaclrn-vlantrans21-func
'''''''''''''''''''''''''''''''''''''''''''''''''''

**L2BD with VLAN tag rewrite test cases - transalte-2-1**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet encapsulations:** Eth-dot1ad-IPv4-ICMPv4 or Eth-dot1ad-IPv6-ICMPv6 on TG-DUT1, Eth-dot1q-IPv4-ICMPv4 or Eth-dot1q-IPv6-ICMPv6 on DUT1-DUT2, Eth-IPv4-ICMPv4 or Eth-IPv6-ICMPv6 on TG-DUT2 for L2 switching of IPv4/IPv6.  

 - **[Cfg] DUT configuration:** DUT1 is configured with bridge domain (L2BD) switching combined with MAC learning enabled and added VLAN sub-interface with VLAN tag rewrite translate-2-1 method of interface towards TG and interface towards DUT2. DUT2 is configured with L2 bridge domain (L2BD) switching between VLAN sub-interface with VLAN tag rewrite pop-1 method of interface towards DUT1 and interface towards TG.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent from TG on link to DUT1 and received in TG on link form DUT2; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** IEEE 802.1q, IEEE 802.1ad.

+------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                           | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
+================================================================================================+========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 with L2BD and VLAN translate-2-1 (DUT1) switch ICMPv4 between two TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_subif sw_if_index 1 sub_id 10 outer_vlan_id 110 inner_vlan_id 210 two_tags dot1ad |br| exec show interfaces |br| l2_interface_vlan_tag_rewrite sw_if_index 5 translate-2-1  tag1 120  |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_l2_bridge sw_if_index 3 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 1 shg 0 enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vlan_subif sw_if_index 3 vlan 120 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| l2_interface_vlan_tag_rewrite sw_if_index 5 pop-1    |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 1 shg 0 enable |br|  |preout|  |
+------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: DUT1 and DUT2 with L2BD and VLAN translate-2-1 (DUT1) switch ICMPv6 between two TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_subif sw_if_index 1 sub_id 10 outer_vlan_id 110 inner_vlan_id 210 two_tags dot1ad |br| exec show interfaces |br| l2_interface_vlan_tag_rewrite sw_if_index 5 translate-2-1  tag1 120  |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_l2_bridge sw_if_index 3 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 1 shg 0 enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vlan_subif sw_if_index 3 vlan 120 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| l2_interface_vlan_tag_rewrite sw_if_index 5 pop-1    |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 1 shg 0 enable |br|  |preout|  |
+------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-dot1ad-l2bdbasemaclrn-vlantrans22-func
''''''''''''''''''''''''''''''''''''''''''''

**L2BD with VLAN tag rewrite test cases - translate-2-2**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet encapsulations:** Eth-dot1ad-IPv4-ICMPv4 or Eth-dot1ad-IPv6-ICMPv6 on TG-DUT1 and DUT1-DUT2, Eth-IPv4-ICMPv4 or Eth-IPv6-ICMPv6 on TG-DUT2 for L2 switching of IPv4/IPv6.  

 - **[Cfg] DUT configuration:** DUT1 is configured with bridge domain (L2BD) switching combined with MAC learning enabled and added VLAN sub-interface with VLAN tag rewrite translate-2-2 method of interface towards TG and interface towards DUT2. DUT2 is configured with L2 bridge domain (L2BD) switching between VLAN sub-interface with VLAN tag rewrite pop-2 method of interface towards DUT1 and interface towards TG.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent from TG on link to DUT1 and received in TG on link form DUT2; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** IEEE 802.1q, IEEE 802.1ad.

+-----------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                    | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
+=========================================================================================+=========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 with L2BD and VLAN translate-2-2 switch ICMPv4 between two TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_subif sw_if_index 1 sub_id 10 outer_vlan_id 110 inner_vlan_id 210 two_tags dot1ad |br| exec show interfaces |br| l2_interface_vlan_tag_rewrite sw_if_index 5 translate-2-2 push_dot1q 0 tag1 120 tag2 220 |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_l2_bridge sw_if_index 3 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 1 shg 0 enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_subif sw_if_index 3 sub_id 10 outer_vlan_id 120 inner_vlan_id 220 two_tags dot1ad |br| exec show interfaces |br| l2_interface_vlan_tag_rewrite sw_if_index 5 pop-2    |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 1 shg 0 enable |br|  |preout|  |
+-----------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC05: DUT1 and DUT2 with L2BD and VLAN translate-2-2 switch ICMPv6 between two TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_subif sw_if_index 1 sub_id 10 outer_vlan_id 110 inner_vlan_id 210 two_tags dot1ad |br| exec show interfaces |br| l2_interface_vlan_tag_rewrite sw_if_index 5 translate-2-2 push_dot1q 0 tag1 120 tag2 220 |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_l2_bridge sw_if_index 3 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 1 shg 0 enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_subif sw_if_index 3 sub_id 10 outer_vlan_id 120 inner_vlan_id 220 two_tags dot1ad |br| exec show interfaces |br| l2_interface_vlan_tag_rewrite sw_if_index 5 pop-2    |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 1 shg 0 enable |br|  |preout|  |
+-----------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-dot1q--dot1ad-l2bdbasemaclrn-vlantrans12-func
'''''''''''''''''''''''''''''''''''''''''''''''''''

**L2BD with VLAN tag rewrite test cases - translate-1-2**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet encapsulations:** Eth-dot1q-IPv4-ICMPv4 or Eth-dot1q-IPv6-ICMPv6 on TG-DUT1, Eth-dot1ad-IPv4-ICMPv4 or Eth-dot1ad-IPv6-ICMPv6 on DUT1-DUT2, Eth-IPv4-ICMPv4 or Eth-IPv6-ICMPv6 on TG-DUT2 for L2 switching of IPv4/IPv6.  

 - **[Cfg] DUT configuration:** DUT1 is configured with bridge domain (L2BD) switching combined with MAC learning enabled and added VLAN sub-interface with VLAN tag rewrite translate-1-2 method of interface towards TG and interface towards DUT2. DUT2 is configured with L2 bridge domain (L2BD) switching between VLAN sub-interface with VLAN tag rewrite pop-2 method of interface towards DUT1 and interface towards TG.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent from TG on link to DUT1 and received in TG on link form DUT2; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** IEEE 802.1q, IEEE 802.1ad.

+------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                           | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+================================================================================================+============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 with L2BD and VLAN translate-1-2 (DUT1) switch ICMPv4 between two TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vlan_subif sw_if_index 1 vlan 110 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| l2_interface_vlan_tag_rewrite sw_if_index 5 translate-1-2 push_dot1q 0 tag1 120 tag2 210 |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_l2_bridge sw_if_index 3 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 1 shg 0 enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_subif sw_if_index 3 sub_id 10 outer_vlan_id 120 inner_vlan_id 210 two_tags dot1ad |br| exec show interfaces |br| l2_interface_vlan_tag_rewrite sw_if_index 5 pop-2    |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 1 shg 0 enable |br|  |preout|  |
+------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC05: DUT1 and DUT2 with L2BD and VLAN translate-1-2 (DUT1) switch ICMPv6 between two TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vlan_subif sw_if_index 1 vlan 110 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| l2_interface_vlan_tag_rewrite sw_if_index 5 translate-1-2 push_dot1q 0 tag1 120 tag2 220 |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_l2_bridge sw_if_index 3 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 1 shg 0 enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_subif sw_if_index 3 sub_id 10 outer_vlan_id 120 inner_vlan_id 220 two_tags dot1ad |br| exec show interfaces |br| l2_interface_vlan_tag_rewrite sw_if_index 5 pop-2    |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 1 shg 0 enable |br|  |preout|  |
+------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-dot1q-l2bdbasemaclrn-vlantrans11-func
'''''''''''''''''''''''''''''''''''''''''''

**L2BD with VLAN tag rewrite test cases - translate-1-1**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet encapsulations:** Eth-dot1q-IPv4-ICMPv4 or Eth-dot1q-IPv6-ICMPv6 on TG-DUT1 and DUT1-DUT2, Eth-IPv4-ICMPv4 or Eth-IPv6-ICMPv6 on TG-DUT2 for L2 switching of IPv4/IPv6.  

 - **[Cfg] DUT configuration:** DUT1 is configured with bridge domain (L2BD) switching combined with MAC learning enabled and added VLAN sub-interface with VLAN tag rewrite translate-1-1 method of interface towards TG and interface towards DUT2. DUT2 is configured with L2 bridge domain (L2BD) switching between VLAN sub-interface with VLAN tag rewrite pop-1 method of interface towards DUT1 and interface towards TG.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent from TG on link to DUT1 and received in TG on link form DUT2; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** IEEE 802.1q, IEEE 802.1ad.

+------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                           | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+================================================================================================+===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 with L2BD and VLAN translate-1-1 (DUT1) switch ICMPv4 between two TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vlan_subif sw_if_index 1 vlan 110 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| l2_interface_vlan_tag_rewrite sw_if_index 5 translate-1-1  tag1 120  |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_l2_bridge sw_if_index 3 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 1 shg 0 enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vlan_subif sw_if_index 3 vlan 120 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| l2_interface_vlan_tag_rewrite sw_if_index 5 pop-1    |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 1 shg 0 enable |br|  |preout|  |
+------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: DUT1 and DUT2 with L2BD and VLAN translate-1-1 (DUT1) switch ICMPv6 between two TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vlan_subif sw_if_index 1 vlan 110 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| l2_interface_vlan_tag_rewrite sw_if_index 5 translate-1-1  tag1 120  |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_l2_bridge sw_if_index 3 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 1 shg 0 enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vlan_subif sw_if_index 3 vlan 120 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| l2_interface_vlan_tag_rewrite sw_if_index 5 pop-1    |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 1 shg 0 enable |br|  |preout|  |
+------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-eth-l2bdbasemaclrn-func
'''''''''''''''''''''''''''''

**L2 bridge-domain test cases**   

 - **[Top] Network Topologies:** TG=DUT1 2-node topology with two links between nodes; TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-ICMPv4 for L2 switching of IPv4; Eth-IPv6-ICMPv6 for L2 switching of IPv6 use. Both apply to all links.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with L2 bridge-domain (L2BD) switching combined with MAC learning enabled.  

 - **[Ver] TG verification:** Test ICMPv4 (or ICMPv6) Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv4 (IPv6) src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:**

+--------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                     | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
+==========================================================================+=================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT reports active interfaces                                      |  |prein| **DUT1:** |br| no VAT command executed |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+--------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT with L2BD (MAC learning) switch ICMPv4 between two TG links    |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_l2_bridge sw_if_index 2 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 1 shg 0 enable |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+--------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: DUT1 and DUT2 with L2BD (MAC learning) switch between two TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_l2_bridge sw_if_index 3 bd_id 1 shg 0 enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| bridge_domain_add_del bd_id 2 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 2 shg 0 enable |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_l2_bridge sw_if_index 3 bd_id 2 shg 0 enable |br|  |preout|  |
+--------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-eth-l2bdbasemacstc-func
'''''''''''''''''''''''''''''

**L2 bridge-domain test cases**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-ICMPv4 for L2 switching of IPv4; Eth-IPv6-ICMPv6 for L2 switching of IPv6 use. Both apply to all links.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with L2 bridge-domain (L2BD) switching combined with static MACs.  

 - **[Ver] TG verification:** Test ICMPv4 (or ICMPv6) Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv4 (IPv6) src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:**

+-------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                    | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
+=========================================================================+=============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 with L2BD (static MACs) switch between two TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 0 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_l2_bridge sw_if_index 3 bd_id 1 shg 0 enable |br| l2fib_add_del mac fa:16:3e:f2:e7:64 bd_id 1 sw_if_index 1 |br| l2fib_add_del mac fa:16:3e:f6:75:00 bd_id 1 sw_if_index 3 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| bridge_domain_add_del bd_id 2 flood 1 uu-flood 1 forward 1 learn 0 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 2 shg 0 enable |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_l2_bridge sw_if_index 3 bd_id 2 shg 0 enable |br| l2fib_add_del mac fa:16:3e:f2:e7:64 bd_id 2 sw_if_index 3 |br| l2fib_add_del mac fa:16:3e:f6:75:00 bd_id 2 sw_if_index 1 |br|  |preout|  |
+-------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth4p-eth-l2bdbasemaclrn-l2shg-func
'''''''''''''''''''''''''''''''''''

**L2 bridge-domain test cases**   

 - **[Top] Network Topologies:** TG=DUT1=DUT2=TG 3-node circular topology with double parallel links.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-ICMPv4 for L2 switching of IPv4; Eth-IPv6-ICMPv6 for L2 switching of IPv6 use. Both apply to all links.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with L2 bridge-domain (L2BD) switching combined with MAC learning enabled and Split Horizon Groups (SHG).  

 - **[Ver] TG verification:** Test ICMPv4 (or ICMPv6) Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv4 (IPv6) src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:**

+--------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                           | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+================================================================================+===================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 with L2BD (MAC learn) and SHG switch between four TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_l2_bridge sw_if_index 2 bd_id 1 shg 3 enable |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 1 shg 3 enable |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_l2_bridge sw_if_index 3 bd_id 1 shg 0 enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| bridge_domain_add_del bd_id 2 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_l2_bridge sw_if_index 2 bd_id 2 shg 4 enable |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 2 shg 4 enable |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_l2_bridge sw_if_index 3 bd_id 2 shg 0 enable |br|  |preout|  |
+--------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

l2xc
````



eth2p-dot1ad--dot1q-l2xcbase-vlantrans21-func
'''''''''''''''''''''''''''''''''''''''''''''

**L2XC with VLAN tag rewrite test cases - translate-2-1**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet encapsulations:** Eth-dot1ad-IPv4-ICMPv4 or Eth-dot1ad-IPv6-ICMPv6 on TG-DUT1, Eth-dot1q-IPv4-ICMPv4 or Eth-dot1aq-IPv6-ICMPv6 on DUT1-DUT2, Eth-IPv4-ICMPv4 on TG-DUT2 for L2 switching of IPv4/IPv6.  

 - **[Cfg] DUT configuration:** DUT1 is configured with L2 cross-connect (L2XC) switching between VLAN sub-interface with VLAN tag rewrite translate-2-1 method of interface towards TG and interface towards DUT2. DUT2 is configured configured with L2 cross-connect (L2XC) switching between VLAN sub-interface with VLAN tag rewrite pop-1 method of interface towards DUT1 and interface towards TG.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent from TG on link to DUT1 and received in TG on link form DUT2; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** IEEE 802.1q, IEEE 802.1ad.

+------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                           | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
+================================================================================================+======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 with L2XC and VLAN translate-2-1 (DUT1) switch ICMPv4 between two TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_subif sw_if_index 1 sub_id 10 outer_vlan_id 110 inner_vlan_id 210 two_tags dot1ad |br| exec show interfaces |br| l2_interface_vlan_tag_rewrite sw_if_index 5 translate-2-1  tag1 120  |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 3 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vlan_subif sw_if_index 3 vlan 120 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| l2_interface_vlan_tag_rewrite sw_if_index 5 pop-1    |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 1 |br|  |preout|  |
+------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: DUT1 and DUT2 with L2XC and VLAN translate-2-1 (DUT1) switch ICMPv6 between two TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_subif sw_if_index 1 sub_id 10 outer_vlan_id 110 inner_vlan_id 210 two_tags dot1ad |br| exec show interfaces |br| l2_interface_vlan_tag_rewrite sw_if_index 5 translate-2-1  tag1 120  |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 3 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vlan_subif sw_if_index 3 vlan 120 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| l2_interface_vlan_tag_rewrite sw_if_index 5 pop-1    |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 1 |br|  |preout|  |
+------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-dot1ad-l2xcbase-func
''''''''''''''''''''''''''

**L2 cross-connect with QinQ test cases**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet encapsulations:** Eth-dot1ad-IPv4-ICMPv4 on DUT1-DUT2, Eth-IPv4-ICMPv4 on TG-DUTn for L2 switching of IPv4.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with L2 cross-connect (L2XC) switching with 802.1ad QinQ VLAN tag push and pop.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** IEEE 802.1ad.

+----------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                   | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+========================================================================================+===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 with L2XC and two VLAN push-pop switch ICMPv4 between two TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_subif sw_if_index 3 sub_id 10 outer_vlan_id 100 inner_vlan_id 200 two_tags |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| l2_interface_vlan_tag_rewrite sw_if_index 5 pop-2    |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 1 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_subif sw_if_index 3 sub_id 10 outer_vlan_id 100 inner_vlan_id 200 two_tags |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| l2_interface_vlan_tag_rewrite sw_if_index 5 pop-2    |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 1 |br|  |preout|  |
+----------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-dot1ad-l2xcbase-vlantrans22-func
''''''''''''''''''''''''''''''''''''''

**L2XC with VLAN tag rewrite test cases - translate-2-2**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet encapsulations:** Eth-dot1ad-IPv4-ICMPv4 or Eth-dot1ad-IPv6-ICMPv6 on TG-DUT1 and DUT1-DUT2, Eth-IPv4-ICMPv4 or Eth-IPv6-ICMPv6 on TG-DUT2 for L2 switching of IPv4/IPv6.  

 - **[Cfg] DUT configuration:** DUT1 is configured with L2 cross-connect (L2XC) switching between VLAN sub-interface with VLAN tag rewrite translate-2-2 method of interface towards TG and interface towards DUT2. DUT2 is configured configured with L2 cross-connect (L2XC) switching between VLAN sub-interface with VLAN tag rewrite pop-2 method of interface towards DUT1 and interface towards TG.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent from TG on link to DUT1 and received in TG on link form DUT2; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** IEEE 802.1q, IEEE 802.1ad.

+-----------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                    | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+=========================================================================================+=======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 with L2XC and VLAN translate-2-2 switch ICMPv4 between two TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_subif sw_if_index 1 sub_id 10 outer_vlan_id 110 inner_vlan_id 210 two_tags dot1ad |br| exec show interfaces |br| l2_interface_vlan_tag_rewrite sw_if_index 5 translate-2-2 push_dot1q 0 tag1 120 tag2 220 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 3 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_subif sw_if_index 3 sub_id 10 outer_vlan_id 120 inner_vlan_id 220 two_tags dot1ad |br| exec show interfaces |br| l2_interface_vlan_tag_rewrite sw_if_index 5 pop-2    |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 1 |br|  |preout|  |
+-----------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC05: DUT1 and DUT2 with L2XC and VLAN translate-2-2 switch ICMPv6 between two TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_subif sw_if_index 1 sub_id 10 outer_vlan_id 110 inner_vlan_id 210 two_tags dot1ad |br| exec show interfaces |br| l2_interface_vlan_tag_rewrite sw_if_index 5 translate-2-2 push_dot1q 0 tag1 120 tag2 220 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 3 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_subif sw_if_index 3 sub_id 10 outer_vlan_id 120 inner_vlan_id 220 two_tags dot1ad |br| exec show interfaces |br| l2_interface_vlan_tag_rewrite sw_if_index 5 pop-2    |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 1 |br|  |preout|  |
+-----------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-dot1q--dot1ad-l2xcbase-vlantrans12-func
'''''''''''''''''''''''''''''''''''''''''''''

**L2XC with VLAN tag rewrite test cases - translate-1-2**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet encapsulations:** Eth-dot1q-IPv4-ICMPv4 or Eth-dot1q-IPv6-ICMPv6 on TG-DUT1, Eth-dot1ad-IPv4-ICMPv4 or Eth-dot1ad-IPv6-ICMPv6 on DUT1-DUT2, Eth-IPv4-ICMPv4 or Eth-IPv6-ICMPv6 on TG-DUT2 for L2 switching of IPv4/IPv6.  

 - **[Cfg] DUT configuration:** DUT1 is configured with L2 cross-connect (L2XC) switching between VLAN sub-interface with VLAN tag rewrite translate-1-2 method of interface towards TG and interface towards DUT2. DUT2 is configured configured with L2 cross-connect (L2XC) switching between VLAN sub-interface with VLAN tag rewrite pop-2 method of interface towards DUT1 and interface towards TG.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent from TG on link to DUT1 and received in TG on link form DUT2; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** IEEE 802.1q, IEEE 802.1ad.

+------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                           | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
+================================================================================================+==========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 with L2XC and VLAN translate-1-2 (DUT1) switch ICMPv4 between two TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vlan_subif sw_if_index 1 vlan 110 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| l2_interface_vlan_tag_rewrite sw_if_index 5 translate-1-2 push_dot1q 0 tag1 120 tag2 210 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 3 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_subif sw_if_index 3 sub_id 10 outer_vlan_id 120 inner_vlan_id 210 two_tags dot1ad |br| exec show interfaces |br| l2_interface_vlan_tag_rewrite sw_if_index 5 pop-2    |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 1 |br|  |preout|  |
+------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC05: DUT1 and DUT2 with L2XC and VLAN translate-1-2 (DUT1) switch ICMPv6 between two TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vlan_subif sw_if_index 1 vlan 110 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| l2_interface_vlan_tag_rewrite sw_if_index 5 translate-1-2 push_dot1q 0 tag1 120 tag2 220 |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 3 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_subif sw_if_index 3 sub_id 10 outer_vlan_id 120 inner_vlan_id 220 two_tags dot1ad |br| exec show interfaces |br| l2_interface_vlan_tag_rewrite sw_if_index 5 pop-2    |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 1 |br|  |preout|  |
+------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-dot1q-l2xcbase-vlantrans11-func
'''''''''''''''''''''''''''''''''''''

**L2XC with VLAN tag rewrite test cases - translate-1-1**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet encapsulations:** Eth-dot1q-IPv4-ICMPv4 or Eth-dot1q-IPv6-ICMPv6 on TG-DUT1 and DUT1-DUT2, Eth-IPv4-ICMPv4 or Eth-IPv4-ICMPv4 on TG-DUT2 for L2 switching of IPv4/IPv6.  

 - **[Cfg] DUT configuration:** DUT1 is configured with L2 cross-connect (L2XC) switching between VLAN sub-interface with VLAN tag rewrite translate-1-1 method of interface towards TG and interface towards DUT2. DUT2 is configured configured with L2 cross-connect (L2XC) switching between VLAN sub-interface with VLAN tag rewrite pop-1 method of interface towards DUT1 and interface towards TG.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent from TG on link to DUT1 and received in TG on link form DUT2; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** IEEE 802.1q, IEEE 802.1ad.

+------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                           | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
+================================================================================================+=========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 with L2XC and VLAN translate-1-1 (DUT1) switch ICMPv4 between two TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vlan_subif sw_if_index 1 vlan 110 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| l2_interface_vlan_tag_rewrite sw_if_index 5 translate-1-1  tag1 120  |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 3 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vlan_subif sw_if_index 3 vlan 120 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| l2_interface_vlan_tag_rewrite sw_if_index 5 pop-1    |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 1 |br|  |preout|  |
+------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: DUT1 and DUT2 with L2XC and VLAN translate-1-1 (DUT1) switch ICMPv6 between two TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vlan_subif sw_if_index 1 vlan 110 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| l2_interface_vlan_tag_rewrite sw_if_index 5 translate-1-1  tag1 120  |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 3 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vlan_subif sw_if_index 3 vlan 120 |br| exec show interfaces |br| sw_interface_set_flags sw_if_index 5 admin-up |br| l2_interface_vlan_tag_rewrite sw_if_index 5 pop-1    |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 1 |br|  |preout|  |
+------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-eth-l2xcbase-func
'''''''''''''''''''''''

**L2 cross-connect test cases**   

 - **[Top] Network Topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-ICMPv4 for L2 switching of IPv4; Eth-IPv6-ICMPv6 for L2 switching of IPv6 use. Both apply to all links.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with L2 cross-connect (L2XC) switching.  

 - **[Ver] TG verification:** Test ICMPv4 (or ICMPv6) Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv4 (IPv6) src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:**

+------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                             | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
+==================================================================+=============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT1 and DUT2 with L2XC switch ICMPv4 between two TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_dump |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| sw_interface_dump |br|  |preout|  |
+------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT1 and DUT2 with L2XC switch ICMPv6 between two TG links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_dump |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| sw_interface_dump |br|  |preout|  |
+------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-eth-l2xcbase-iaclbase-func
''''''''''''''''''''''''''''''''

**Ingress ACL test cases**   

 - **[Top] Network Topologies:** TG - DUT1 - DUT2 - TG with one link between the nodes.  

 - **[Cfg] DUT configuration:** DUT2 is configured with L2 Cross connect. DUT1 is configured with iACL classification on link to TG,  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent in one direction by TG on link to DUT1 and received on TG link to DUT2. On receive TG verifies if packets are dropped.

+-------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                              | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+===================================================================+===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT with iACL MAC src-addr drops matching pkts              |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| classify_add_del_table mask l2 src |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 0 match_n 1 match l2 src fa:16:3e:f2:e7:64 |br| input_acl_set_interface sw_if_index 1 l2-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br|  |preout|                                                                                                                                                                                                                |
+-------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT with iACL MAC dst-addr drops matching pkts              |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| classify_add_del_table mask l2 dst |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 0 match_n 1 match l2 dst fa:16:3e:f6:75:00 |br| input_acl_set_interface sw_if_index 1 l2-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br|  |preout|                                                                                                                                                                                                                |
+-------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC03: DUT with iACL MAC src-addr and dst-addr drops matching pkts |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| classify_add_del_table mask l2 src |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 0 match_n 1 match l2 src fa:16:3e:f2:e7:64 |br| classify_add_del_table mask l2 dst |br| classify_add_del_session acl-hit-next deny table-index 1 skip_n 0 match_n 1 match l2 dst fa:16:3e:f2:e7:64 |br| input_acl_set_interface sw_if_index 1 l2-table 0 |br| input_acl_set_interface sw_if_index 1 l2-table 1 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br|  |preout|  |
+-------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC04: DUT with iACL EtherType drops matching pkts                 |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br| classify_add_del_table mask hex 000000000000000000000000ffff |br| classify_add_del_session acl-hit-next deny table-index 0 skip_n 0 match_n 1 match hex 0000000000000000000000000800 |br| input_acl_set_interface sw_if_index 1 l2-table 0 |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 3 tx_sw_if_index 1 |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 3 |br|  |preout|                                                                                                                                                                              |
+-------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

vm vhost
````````



l2bd
''''



eth2p-dot1q-l2bdbasemaclrn-eth-2vhost-1vm-func
..............................................

**L2 bridge domain with VLAN tag over VM test cases**   

 - **[Top] Network Topologies:** TG=DUT 2-node circular topology with double links between nodes.  

 - **[Enc] Packet encapsulations:** Eth-dot1q-IPv4-ICMPv4 or Eth-dot1q-IPv6-ICMPv6 on TG=DUT and on DUT=VM.  

 - **[Cfg] DUT configuration:** DUT is configured with two bridge domains (L2BD) with MAC learning enabled; each one with added VLAN sub-interface towards TG and vhost-user interface to local VM. Configure linux bridge on VM to pass traffic between both vhost-user interfaces.  

 - **[Ver] TG verification:** Make TG send ICMPv4/ICMPv6 Echo Req between two of its interfaces to be switched by DUT via VM; verify packets are switched between these TG interfaces; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr, MAC addresses and VLAN tag.  

 - **[Ref] Applicable standard specifications:** IEEE 802.1q.

+--------------------------------------------------------+-------------------------------------------------------------------+
| Name                                                   | VPP API Test (VAT) Commands History - Commands Used Per Test Case |
+========================================================+===================================================================+
| TC01: eth2p-dot1q-l2bdbasemaclrn-eth-2vhost-1vm - ipv4 |  |prein|  |preout|                                                |
+--------------------------------------------------------+-------------------------------------------------------------------+
| TC01: eth2p-dot1q-l2bdbasemaclrn-eth-2vhost-1vm - ipv6 |  |prein|  |preout|                                                |
+--------------------------------------------------------+-------------------------------------------------------------------+

eth2p-eth-l2bdbasemaclrn-eth-2vhost-1vm-func
............................................

**L2 bridge-domain test cases**   

 - **[Top] Network Topologies:** TG=DUT=VM 3-node topology with VM and double parallel links.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-ICMPv4 for L2 switching of IPv4; Eth-IPv6-ICMPv6 for L2 switching of IPv6 use. Both apply to all links.  

 - **[Cfg] DUT configuration:** DUT1 is configured with two L2 bridge-domains (L2BD) switching combined with MAC learning enabled.  

 - **[Ver] TG verification:** Test ICMPv4 (or ICMPv6) Echo Request packets are sent in both directions by TG on links to DUT1 via VM; on receive TG verifies packets for correctness and their IPv4 (IPv6) src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:**

+------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                         | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
+==============================================================================+===============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT with two L2BDs (MAC learn) switches ICMPv4 between TG and VM links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_l2_bridge sw_if_index 2 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 1 shg 0 enable |br| bridge_domain_add_del bd_id 2 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 2 shg 0 enable |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 2 shg 0 enable |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT with two L2BDs (MAC learn) switches ICMPv6 between TG and VM links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_l2_bridge sw_if_index 2 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 1 shg 0 enable |br| bridge_domain_add_del bd_id 2 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 2 shg 0 enable |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 2 shg 0 enable |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-eth-l2bdbasemacstc-eth-2vhost-1vm-func
............................................

**L2 bridge-domain test cases**   

 - **[Top] Network Topologies:** TG=DUT=VM 3-node topology with VM and double parallel links.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-ICMPv4 for L2 switching of IPv4; Eth-IPv6-ICMPv6 for L2 switching of IPv6 use. Both apply to all links.  

 - **[Cfg] DUT configuration:** DUT1 is configured with two L2 bridge-domains (L2BD) switching combined with static MACs.  

 - **[Ver] TG verification:** Test ICMPv4 (or ICMPv6) Echo Request packets are sent in both directions by TG on links to DUT1 via VM; on receive TG verifies packets for correctness and their IPv4 (IPv6) src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:**

+--------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                           | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+================================================================================+===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT with two L2BDs (static MACs) switches ICMPv4 between TG and VM links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 0 arp-term 0 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_l2_bridge sw_if_index 2 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 1 shg 0 enable |br| l2fib_add_del mac fa:16:3e:8d:88:a9 bd_id 1 sw_if_index 2 |br| l2fib_add_del mac fa:16:3e:f2:e7:64 bd_id 1 sw_if_index 5 |br| bridge_domain_add_del bd_id 2 flood 1 uu-flood 1 forward 1 learn 0 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 2 shg 0 enable |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 2 shg 0 enable |br| l2fib_add_del mac fa:16:3e:f2:e7:64 bd_id 2 sw_if_index 1 |br| l2fib_add_del mac fa:16:3e:8d:88:a9 bd_id 2 sw_if_index 6 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+--------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT with two L2BDs (static MACs) switches ICMPv6 between TG and VM links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| bridge_domain_add_del bd_id 1 flood 1 uu-flood 1 forward 1 learn 0 arp-term 0 |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_l2_bridge sw_if_index 2 bd_id 1 shg 0 enable |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 1 shg 0 enable |br| l2fib_add_del mac fa:16:3e:8d:88:a9 bd_id 1 sw_if_index 2 |br| l2fib_add_del mac fa:16:3e:f2:e7:64 bd_id 1 sw_if_index 5 |br| bridge_domain_add_del bd_id 2 flood 1 uu-flood 1 forward 1 learn 0 arp-term 0 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 2 shg 0 enable |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 2 shg 0 enable |br| l2fib_add_del mac fa:16:3e:f2:e7:64 bd_id 2 sw_if_index 1 |br| l2fib_add_del mac fa:16:3e:8d:88:a9 bd_id 2 sw_if_index 6 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+--------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4-l2bdbase-vhost-client-reconnect-2vm-func
.....................................................

**Vhost-User Interface Traffic Tests**  

 - **[Top] Network Topologies:** TG=DUT1 2-node topology with two links between nodes.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-VXLAN-ETH-IP on TG-DUT link. ETH-IP on VirtualEthernet-VM interface.  

 - **[Cfg] DUT configuration:** On DUT is running 2 VM with 2 vhost-user interface on each VM. DUT is configured with VXLAN and vhost-user interfaces in bridge-domain (L2BD).  

 - **[Cfg] VM configuration:** VM has both vhost-user interfaces added into Linux Bridge.  

 - **[Ver] TG verification:** VXLAN packet is send to DUT where is decapsulated and send bridged to vhost-user inteface. VM forwards frame to its second interface and VPP encapsulates it to another VXLAN tunnel. Packets are sent and received by TG on link to DUT.

+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                       | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+============================================================================+============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: Qemu reconnects to VPPs vhost-user when Qemu is killed and restarted |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 192.168.0.2/24 |br| ip_neighbor_add_del sw_if_index 2 dst 192.168.0.1 mac fa:16:3e:8d:88:a9 |br| vxlan_add_del_tunnel src 192.168.0.2 dst 192.168.0.1 vni 101 |br| vxlan_add_del_tunnel src 192.168.0.2 dst 192.168.0.1 vni 102 |br| vxlan_add_del_tunnel src 192.168.0.2 dst 192.168.0.1 vni 103 |br| vxlan_add_del_tunnel src 192.168.0.2 dst 192.168.0.1 vni 104 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_flags sw_if_index 7 admin-up |br| sw_interface_set_flags sw_if_index 8 admin-up |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| create_vhost_user_if socket /tmp/sock3 |br| create_vhost_user_if socket /tmp/sock4 |br| sw_interface_set_flags sw_if_index 9 admin-up |br| sw_interface_set_flags sw_if_index 10 admin-up |br| sw_interface_set_flags sw_if_index 11 admin-up |br| sw_interface_set_flags sw_if_index 12 admin-up |br| bridge_domain_add_del bd_id 101 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 101 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 9 bd_id 101 shg 0  enable |br| bridge_domain_add_del bd_id 102 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 102 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 10 bd_id 102 shg 0  enable |br| bridge_domain_add_del bd_id 103 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 7 bd_id 103 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 11 bd_id 103 shg 0  enable |br| bridge_domain_add_del bd_id 104 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 8 bd_id 104 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 12 bd_id 104 shg 0  enable |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: VPP reconnects to Qemu vhost-user when Restart VPP and reconfigured  |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 192.168.0.2/24 |br| ip_neighbor_add_del sw_if_index 2 dst 192.168.0.1 mac fa:16:3e:8d:88:a9 |br| vxlan_add_del_tunnel src 192.168.0.2 dst 192.168.0.1 vni 101 |br| vxlan_add_del_tunnel src 192.168.0.2 dst 192.168.0.1 vni 102 |br| vxlan_add_del_tunnel src 192.168.0.2 dst 192.168.0.1 vni 103 |br| vxlan_add_del_tunnel src 192.168.0.2 dst 192.168.0.1 vni 104 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_flags sw_if_index 7 admin-up |br| sw_interface_set_flags sw_if_index 8 admin-up |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| create_vhost_user_if socket /tmp/sock3 |br| create_vhost_user_if socket /tmp/sock4 |br| sw_interface_set_flags sw_if_index 9 admin-up |br| sw_interface_set_flags sw_if_index 10 admin-up |br| sw_interface_set_flags sw_if_index 11 admin-up |br| sw_interface_set_flags sw_if_index 12 admin-up |br| bridge_domain_add_del bd_id 101 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 101 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 9 bd_id 101 shg 0  enable |br| bridge_domain_add_del bd_id 102 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 102 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 10 bd_id 102 shg 0  enable |br| bridge_domain_add_del bd_id 103 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 7 bd_id 103 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 11 bd_id 103 shg 0  enable |br| bridge_domain_add_del bd_id 104 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 8 bd_id 104 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 12 bd_id 104 shg 0  enable |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| sw_interface_add_del_address sw_if_index 2 192.168.0.2/24 |br| ip_neighbor_add_del sw_if_index 2 dst 192.168.0.1 mac fa:16:3e:8d:88:a9 |br| vxlan_add_del_tunnel src 192.168.0.2 dst 192.168.0.1 vni 101 |br| vxlan_add_del_tunnel src 192.168.0.2 dst 192.168.0.1 vni 102 |br| vxlan_add_del_tunnel src 192.168.0.2 dst 192.168.0.1 vni 103 |br| vxlan_add_del_tunnel src 192.168.0.2 dst 192.168.0.1 vni 104 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_flags sw_if_index 7 admin-up |br| sw_interface_set_flags sw_if_index 8 admin-up |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| create_vhost_user_if socket /tmp/sock3 |br| create_vhost_user_if socket /tmp/sock4 |br| sw_interface_set_flags sw_if_index 9 admin-up |br| sw_interface_set_flags sw_if_index 10 admin-up |br| sw_interface_set_flags sw_if_index 11 admin-up |br| sw_interface_set_flags sw_if_index 12 admin-up |br| bridge_domain_add_del bd_id 101 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 101 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 9 bd_id 101 shg 0  enable |br| bridge_domain_add_del bd_id 102 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 102 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 10 bd_id 102 shg 0  enable |br| bridge_domain_add_del bd_id 103 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 7 bd_id 103 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 11 bd_id 103 shg 0  enable |br| bridge_domain_add_del bd_id 104 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 8 bd_id 104 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 12 bd_id 104 shg 0  enable |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip4vxlan-l2bdbasemaclrn-eth-2vhost-1vm-func
....................................................

**L2BD with VM combined with VXLAN test cases - IPv4**   

 - **[Top] Network topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet encapsulations:** Eth-IPv4-VXLAN-Eth-IPv4-ICMPv4 on DUT1-DUT2, Eth-IPv4-ICMPv4 on TG-DUTn for L2 switching of IPv4.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with L2 bridge-domain (L2BD) switching combined with MAC learning enabled; VXLAN tunnels are configured between L2BDs on DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv4 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv4 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC7348.

+-----------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
+=====================================================================================================+=================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01:DUT1 and DUT2 with two L2BDs and VXLANoIPv4 tunnel switch ICMPv4 between TG links and VM links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_add_del_address sw_if_index 3 172.16.0.1/24 |br| vxlan_add_del_tunnel src 172.16.0.1 dst 172.16.0.2 vni 23 |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 10 shg 0  enable |br| bridge_domain_add_del bd_id 20 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 7 bd_id 20 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 20 shg 0  enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_add_del_address sw_if_index 3 172.16.0.2/24 |br| vxlan_add_del_tunnel src 172.16.0.2 dst 172.16.0.1 vni 23 |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 10 shg 0  enable |br| bridge_domain_add_del bd_id 20 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 7 bd_id 20 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 20 shg 0  enable |br|  |preout|  |
+-----------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

eth2p-ethip6vxlan-l2bdbasemaclrn-eth-2vhost-1vm-func
....................................................

**L2BD with VM combined with VXLAN test cases - IPv6**   

 - **[Top] Network topologies:** TG-DUT1-DUT2-TG 3-node circular topology with single links between nodes.  

 - **[Enc] Packet encapsulations:** Eth-IPv6-VXLAN-Eth-IPv6-ICMPv6 on DUT1-DUT2, Eth-IPv6-ICMPv6 on TG-DUTn for L2 switching of IPv6.  

 - **[Cfg] DUT configuration:** DUT1 and DUT2 are configured with L2 bridge-domain (L2BD) switching combined with MAC learning enabled; VXLAN tunnels are configured between L2BDs on DUT1 and DUT2.  

 - **[Ver] TG verification:** Test ICMPv6 Echo Request packets are sent in both directions by TG on links to DUT1 and DUT2; on receive TG verifies packets for correctness and their IPv6 src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:** RFC7348.

+-----------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                                                | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
+=====================================================================================================+=========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01:DUT1 and DUT2 with two L2BDs and VXLANoIPv6 tunnel switch ICMPv6 between TG links and VM links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_add_del_address sw_if_index 3 3ffe:64::1/64 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| vxlan_add_del_tunnel src 3ffe:64::1 dst 3ffe:64::2 vni 23 |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 10 shg 0  enable |br| bridge_domain_add_del bd_id 20 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 7 bd_id 20 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 20 shg 0  enable |br|  |br| **DUT2:** |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 3 admin-up |br| sw_interface_dump |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_add_del_address sw_if_index 3 3ffe:64::2/64 |br| sw_interface_ip6nd_ra_config sw_if_index 4 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 2 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 3 surpress |br| sw_interface_ip6nd_ra_config sw_if_index 1 surpress |br| vxlan_add_del_tunnel src 3ffe:64::2 dst 3ffe:64::1 vni 23 |br| bridge_domain_add_del bd_id 10 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 1 bd_id 10 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 5 bd_id 10 shg 0  enable |br| bridge_domain_add_del bd_id 20 flood 1 uu-flood 1 forward 1 learn 1 arp-term 0 |br| sw_interface_set_l2_bridge sw_if_index 7 bd_id 20 shg 0  enable |br| sw_interface_set_l2_bridge sw_if_index 6 bd_id 20 shg 0  enable |br|  |preout|  |
+-----------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

l2xc
''''



eth2p-eth-l2xcbase-eth-2vhost-1vm-func
......................................

**L2 cross-connect test cases**   

 - **[Top] Network Topologies:** TG=DUT=VM 3-node topology with VM and double parallel links.  

 - **[Enc] Packet Encapsulations:** Eth-IPv4-ICMPv4 for L2 switching of IPv4; Eth-IPv6-ICMPv6 for L2 switching of IPv6 use. Both apply to all links.  

 - **[Cfg] DUT configuration:** DUT1 is configured with L2 cross-connect (L2XC) switching.  

 - **[Ver] TG verification:** Test ICMPv4 (or ICMPv6) Echo Request packets are sent in both directions by TG on links to DUT1 via VM; on receive TG verifies packets for correctness and their IPv4 (IPv6) src-addr, dst-addr and MAC addresses.  

 - **[Ref] Applicable standard specifications:**

+------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                                                   | VPP API Test (VAT) Commands History - Commands Used Per Test Case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
+========================================================================+=============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| TC01: DUT with two L2XCs switches ICMPv4 between TG and local VM links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 2 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 2 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 6 |br| sw_interface_set_l2_xconnect rx_sw_if_index 6 tx_sw_if_index 1 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TC02: DUT with two L2XCs switches ICMPv6 between TG and local VM links |  |prein| **DUT1:** |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_dump |br| create_vhost_user_if socket /tmp/sock1 |br| create_vhost_user_if socket /tmp/sock2 |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_flags sw_if_index 2 admin-up |br| sw_interface_set_flags sw_if_index 5 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 2 tx_sw_if_index 5 |br| sw_interface_set_l2_xconnect rx_sw_if_index 5 tx_sw_if_index 2 |br| sw_interface_set_flags sw_if_index 1 admin-up |br| sw_interface_set_flags sw_if_index 6 admin-up |br| sw_interface_set_l2_xconnect rx_sw_if_index 1 tx_sw_if_index 6 |br| sw_interface_set_l2_xconnect rx_sw_if_index 6 tx_sw_if_index 1 |br|  |br| **DUT2:** |br| no VAT command executed |br|  |preout|  |
+------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

