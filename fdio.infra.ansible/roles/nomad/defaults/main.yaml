---
# file: roles/nomad/defaults/main.yaml

# Inst - Nomad Map.
nomad_architecture_map:
  amd64: "amd64"
  x86_64: "amd64"
  armv7l: "arm"
  aarch64: "arm64"
  32-bit: "386"
  64-bit: "amd64"
nomad_architecture: "{{ nomad_architecture_map[ansible_architecture] }}"

# Inst - Download Nomad.
# Used only for Debian/Ubuntu.
nomad_apt_release_channel: "main"
nomad_apt_repository: "deb [arch={{ nomad_architecture }}] https://apt.releases.hashicorp.com {{ ansible_distribution_release }} {{ nomad_apt_release_channel }}"
nomad_apt_repository_state: present
nomad_apt_ignore_key_error: true
nomad_apt_gpg_key: "https://apt.releases.hashicorp.com/gpg"
nomad_apt_gpg_key_state: present
nomad_package: "nomad"
nomad_package_state: present
nomad_package_version: "1.0.4"

# Inst - System paths.
nomad_config_dir: "/etc/nomad.d"
nomad_data_dir: "/var/nomad"
nomad_ssl_dir: "/etc/nomad.d/ssl"

# Conf - Service.
nomad_node_role: "both"
nomad_restart_handler_state: "restarted"

# Conf - User and group.
nomad_group: "nomad"
nomad_user: "nomad"

# Conf - base.hcl
nomad_bind_addr: "0.0.0.0"
nomad_datacenter: "dc1"
nomad_disable_update_check: true
nomad_enable_debug: false
nomad_log_level: "INFO"
nomad_name: "{{ inventory_hostname }}"
nomad_region: "global"
nomad_syslog_enable: true

# Conf - tls.hcl
nomad_ca_file: "{{ nomad_ssl_dir }}/ca.pem"
nomad_cert_file: "{{ nomad_ssl_dir }}/nomad.pem"
nomad_http: false
nomad_key_file: "{{ nomad_ssl_dir }}/nomad-key.pem"
nomad_rpc: false

# Conf - client.hcl
nomad_certificates:
  - src: "{{ vault_nomad_ca_file }}"
    dest: "{{ nomad_ca_file }}"
  - src: "{{ vault_nomad_cert_file }}"
    dest: "{{ nomad_cert_file }}"
  - src: "{{ vault_nomad_key_file }}"
    dest: "{{ nomad_key_file }}"
nomad_node_class: ""
nomad_no_host_uuid: true
nomad_options: {}
nomad_servers: []
nomad_volumes: []

# Conf - server.hcl
nomad_bootstrap_expect: 2
nomad_encrypt: ""
nomad_retry_join: true

# Conf - telemetry.hcl
nomad_disable_hostname: false
nomad_collection_interval: 60s
nomad_use_node_name: false
nomad_publish_allocation_metrics: true
nomad_publish_node_metrics: true
nomad_telemetry_provider_parameters:
  prometheus_metrics: true

# Conf - custom.hcl
# empty
